import{W as a,g as s,a6 as e,j as t,c as l,w as u,f as o,o as n,a as i,b as c,q as r,t as p,v as d,l as f,C as m,m as v,a4 as _,Q as g,a7 as h,H as y,e as b}from"./index-CAhh9jg-.js";import{_ as w}from"./uni-icons.DApveqxl.js";import{r as j}from"./uni-app.es.CI_TJZj7.js";import{a as x,w as z,g as k}from"./config.D_tpLRWx.js";import{_ as C}from"./_plugin-vue_export-helper.BCo6x5W8.js";const I=C({__name:"username",setup(C){a({title:"修改用户名"});const I=s(x.userInfo.username||""),V=s(!1),T=e((()=>I.value.length>=2&&I.value!==x.userInfo.username));async function q(){if(T.value)try{V.value=!0;const a=await f({url:z+"/with-state/update-profile",method:"POST",header:{Authorization:m("token")},data:{username:I.value}});"success"===a.data.status?(v({title:"更新成功",icon:"success"}),await k(),setTimeout((()=>_()),1500)):v({title:a.data.msg||"更新失败",icon:"none"})}catch(a){v({title:"请求失败，请稍后重试",icon:"none"})}finally{V.value=!1}}return(a,s)=>{const e=g,f=h,m=j(t("uni-icons"),w),v=o,_=y,x=b;return n(),l(v,{class:"password-container"},{default:u((()=>[i(v,{class:"form-wrapper"},{default:u((()=>[i(v,{class:"input-group"},{default:u((()=>[i(v,{class:"input-item"},{default:u((()=>[i(e,{class:"input",type:"text",placeholder:" ",modelValue:I.value,"onUpdate:modelValue":s[0]||(s[0]=a=>I.value=a),maxlength:"20"},null,8,["modelValue"]),i(f,{class:"floating-label"},{default:u((()=>[c("用户名")])),_:1}),i(m,{class:"input-icon",type:"person",size:"18",color:"#999"})])),_:1})])),_:1}),i(_,{class:r(["submit-btn",{active:T.value}]),onClick:q,disabled:!T.value},{default:u((()=>[c(p(V.value?"提交中...":"更新用户名")+" ",1),V.value?(n(),l(v,{key:0,class:"loading"})):d("",!0)])),_:1},8,["class","disabled"])])),_:1}),i(v,{class:"security-tips"},{default:u((()=>[i(m,{type:"info",size:"16",color:"#666"}),i(x,null,{default:u((()=>[c("用户名2-20个字符，支持中英文、数字和下划线")])),_:1})])),_:1})])),_:1})}}},[["__scopeId","data-v-960efc4b"]]);export{I as default};
