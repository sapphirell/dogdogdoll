import{o as a,c as e,w as l,a as s,b as t,t as o,d as n,F as i,r as c,n as u,i as d,e as r,f as _,S as f,u as v,g as p,h as g,j as m,s as h,k as b,l as y,m as k,p as w,q as x,v as C,x as z,y as F,z as j,A as D,B as S,C as $,D as B,E as A,G as I,H as T}from"./index-B55GPRQF.js";import{_ as H}from"./goods-search.DumlFeXD.js";import{o as E,a as G,b as L,r as q}from"./uni-app.es.CzHle-z4.js";import{_ as J}from"./uni-transition.CvFnBj2q.js";import{_ as M}from"./common-search.OBIzXxZ7.js";import{_ as O}from"./_plugin-vue_export-helper.BCo6x5W8.js";import{_ as P}from"./uni-icons.B2Wm8RW1.js";import{_ as Y}from"./2.CiKqf5t9.js";import{w as Z,g as K,a as N}from"./config.BIUptOrH.js";import"./search.CsIL0f2m.js";import"./cancel.CnEdunnH.js";const Q=O({__name:"index-brand",props:["brand","key"],setup(v){const p=v;function g(){u({url:"/pages/brand/brand?brand_id="+p.brand.id})}return(p,m)=>{const h=d,b=r,y=_,k=f;return a(),e(y,{class:"brand-card",key:v.key},{default:l((()=>[s(y,{class:"brand-header",onClick:g},{default:l((()=>[v.brand.logo_image?(a(),e(h,{key:0,class:"brand-logo",src:v.brand.logo_image,mode:"aspectFit"},null,8,["src"])):(a(),e(y,{key:1,class:"brand-logo",style:{background:"linear-gradient(180deg, #d8c1b3 0%, #d3f5ff 100%)","align-items":"center"}},{default:l((()=>[s(b,{style:{color:"rgb(255, 255, 255)","font-size":"100rpx",display:"block","text-align":"center"}},{default:l((()=>[t("?")])),_:1})])),_:1})),s(y,{class:"brand-meta"},{default:l((()=>[s(y,{class:"title-row"},{default:l((()=>[s(b,{class:"brand-title"},{default:l((()=>[t(o(v.brand.brand_name),1)])),_:1}),s(b,{class:"brand-tag"},{default:l((()=>[t(o(v.brand.country_name)+"·"+o(v.brand.type),1)])),_:1}),s(b,{class:"goods-count"},{default:l((()=>[t("收录"+o(v.brand.total_goods)+"款",1)])),_:1})])),_:1}),s(b,{class:"brand-desc"},{default:l((()=>[t(o(v.brand.description),1)])),_:1})])),_:1})])),_:1}),s(k,{class:"goods-scroll","scroll-x":"","show-scrollbar":!1},{default:l((()=>[s(y,{class:"goods-list"},{default:l((()=>[(a(!0),n(i,null,c(v.brand.goods,((n,i)=>(a(),e(y,{class:"goods-item",key:n.id,onClick:a=>{return e=n.id,void u({url:"/pages/goods/goods?goods_id="+e});var e}},{default:l((()=>[s(h,{class:"goods-image",src:n.goods_images&&n.goods_images[0],mode:"aspectFill"},null,8,["src"]),s(b,{class:"goods-name"},{default:l((()=>[t(o(n.name),1)])),_:2},1024)])),_:2},1032,["onClick"])))),128))])),_:1})])),_:1})])),_:1})}}},[["__scopeId","data-v-2057667e"]]),R=O({__name:"index",setup(f){v((a=>({"5dffb71e":ka.value})));let O=p([]),R=p({}),U=p("");const V=p([{label:"中国娃社",value:1},{label:"个人作者",value:2},{label:"外国娃社",value:3}]),W=p(1);p(0);const X=g();p(0);const aa=p(1),ea=p(10),la=p(!0),sa=p(!1);let ta=p([]);const oa=p(1),na=p(10),ia=p(!0),ca=p(!1);let ua=p([]);const da=p(1),ra=p(10),_a=p(!0),fa=p(!1);let va=p([]);const pa=p(1),ga=p(10),ma=p(!0),ha=p(!1),ba=p("news"),ya=a=>{ba.value=a};m((()=>0));const ka=m((()=>`${X.statusBarHeight||0}px`));E((async()=>{try{await wa(),h()}catch(a){h(),b({title:"刷新失败",icon:"none"})}}));const wa=async()=>{const a={brands:()=>{aa.value=1,O.value=[],la.value=!0,Fa(!0)},news:()=>{oa.value=1,ta.value=[],ia.value=!0,Ca(!0)},hot:()=>{da.value=1,ua.value=[],_a.value=!0,za(!0)},second:()=>{pa.value=1,va.value=[],ma.value=!0,ja(!0)}};await a[ba.value](),xa()};const xa=()=>{y({url:Z+"/articles",data:{page:1,page_size:10,status:1},success:a=>{"success"===a.data.status&&(R.value=a.data.data.list)},fail:a=>{console.error("获取Banner失败:",a),R.value={}}})};const Ca=async(a=!1)=>{a&&(oa.value=1),ia.value&&!ca.value&&(ca.value=!0,x(),y({url:Z+"/sale-news",data:{page:oa.value,pageSize:na.value},success:a=>{const e=a.data.data.news_list;0!==e.length?(ta.value=[...ta.value,...e],ia.value=a.data.data.news_list.length===na.value,oa.value++):ia.value=!1},fail:a=>{console.log(a),b({title:"加载失败",icon:"none"})},complete:()=>{ca.value=!1,C()}}))};const za=async(a=!1)=>{a&&(da.value=1),_a.value&&!fa.value&&(fa.value=!0,x(),y({url:Z+"/hot-collocation",data:{page:da.value,pageSize:ra.value},success:a=>{const e=a.data.data.collocation_relation_list;0!==e.length?(ua.value=[...ua.value,...e.map((a=>({...a})))],_a.value=ua.value.length<a.data.data.total,da.value++):_a.value=!1},fail:a=>{console.log(a),b({title:"加载失败",icon:"none"})},complete:()=>{fa.value=!1,C()}}))};const Fa=async(a=!1)=>{if(a&&(aa.value=1,O.value=[],la.value=!0,U.value=""),!la.value||sa.value)return;sa.value=!0,x();const e={pageSize:ea.value};U.value?e.cursor=U.value:W.value&&(e.searchType=W.value),y({url:Z+"/brands-info-list",data:e,success:a=>{if("success"!==a.data.status)return void b({title:"加载失败: "+a.data.message,icon:"none"});const e=a.data.data,l=e.data;console.log("newData:",l),U.value=e.next_cursor||"",0!==l.length?(O.value=[...O.value,...l],la.value=e.has_more):la.value=!1},fail:a=>{console.log(a),b({title:"网络请求失败",icon:"none"})},complete:()=>{sa.value=!1,C()}})},ja=async(a=!1)=>{a&&(pa.value=1),ma.value&&!ha.value&&(ha.value=!0,x(),y({url:Z+"/treehole-submissions",data:{page:pa.value,pageSize:ga.value},success:a=>{const e=a.data.data.submission_list.map((a=>({...a,images:a.images||[]})));0!==e.length?(va.value=[...va.value,...e],ma.value=va.value.length<a.data.data.total,pa.value++):ma.value=!1},fail:a=>{b({title:"加载失败",icon:"none"})},complete:()=>{ha.value=!1,C()}}))};function Da(){N.isLogin?u({url:"/pages/treehole_publish/treehole_publish"}):D({title:"提示",content:"需要登录后才能发布树洞",success:a=>{a.confirm&&u({url:"/pages/login/login"})}})}const Sa=a=>{const e=new Date(1e3*a);return`${e.getFullYear()}-${e.getMonth()+1}-${e.getDate()}`};return G((()=>{K(),Fa(),Ca(),za(),ja(),xa()})),L((()=>{"brands"===ba.value&&la.value?Fa():"news"===ba.value&&ia.value?Ca():"second"===ba.value&&ma.value&&ja()})),(f,v)=>{const p=_,g=d,m=r,h=q(k("goods-search"),H),x=S,C=$,D=q(k("uni-transition"),J),E=q(k("common-search"),M),G=q(k("index-brand"),Q),L=q(k("uni-icons"),P);return a(),n(i,null,[w("meta",{name:"theme-color",content:"#fff"}),s(p,null,{default:l((()=>[s(p,{class:"body"},{default:l((()=>[s(p,{class:"index_header"},{default:l((()=>[s(p,{class:"header-placeholders"}),s(p,null,{default:l((()=>[s(g,{src:Y,style:{width:"130rpx",height:"130rpx",display:"inline-block","vertical-align":"top"},mode:"aspectFill"}),s(p,{style:{display:"inline-block"}},{default:l((()=>[s(m,{class:"font-alimamashuhei logo",style:{color:"#4cbbd0",width:"250rpx","padding-top":"10rpx","vertical-align":"top",position:"relative"}},{default:l((()=>[t("娃圈狗狗助手")])),_:1})])),_:1})])),_:1}),s(p,{style:{margin:"40rpx 0rpx 0rpx 0rpx",padding:"5px 10px 0px 10px","border-radius":"20px 20px 0 0"}},{default:l((()=>[s(p,{class:"index_page_article"},{default:l((()=>[s(p,{class:z(["swich_box",{active:"news"===ba.value}]),onClick:v[0]||(v[0]=a=>ya("news"))},{default:l((()=>[s(m,{class:"font-cute"},{default:l((()=>[t("娃圈图透")])),_:1})])),_:1},8,["class"]),s(p,{class:z(["swich_box",{active:"brands"===ba.value}]),onClick:v[1]||(v[1]=a=>ya("brands"))},{default:l((()=>[s(m,{class:"font-cute"},{default:l((()=>[t("娃物图鉴")])),_:1})])),_:1},8,["class"]),s(p,{class:z(["swich_box",{active:"hot"===ba.value}]),onClick:v[2]||(v[2]=a=>ya("hot"))},{default:l((()=>[s(m,{class:"font-cute"},{default:l((()=>[t("热门搭配")])),_:1})])),_:1},8,["class"]),s(p,{class:z(["swich_box",{active:"second"===ba.value}]),onClick:v[3]||(v[3]=a=>ya("second"))},{default:l((()=>[s(m,{class:"font-cute"},{default:l((()=>[t("树洞投稿")])),_:1})])),_:1},8,["class"])])),_:1})])),_:1})])),_:1}),s(p,{class:"body_container"},{default:l((()=>[s(p,{style:{height:"40rpx"}}),s(D,{"mode-class":["fade"],show:"news"===ba.value},{default:l((()=>["news"===ba.value?(a(),e(p,{key:0,class:"body_list news-box"},{default:l((()=>[s(p,{style:{"border-radius":"10px",border:"1px solid rgb(238 238 238)",overflow:"hidden"}},{default:l((()=>[s(h,{width:"720rpx",hiddenIcon:!1}),w("div",{style:{clear:"both"}})])),_:1}),s(p,{style:{position:"relative",height:"250rpx","margin-bottom":"20rpx"}},{default:l((()=>[s(C,{interval:3e3,duration:200,class:"banner_swiper","indicator-active-color":"#4cbbd0","indicator-color":"rgba(255,255,255,0.5)"},{default:l((()=>[(a(!0),n(i,null,c(F(R),(t=>(a(),e(x,{key:t.id,class:"banner_swiper_item"},{default:l((()=>[s(p,{class:"swiper-item"},{default:l((()=>[s(g,{src:t.banner,mode:"aspectFill",style:{width:"100%",height:"250rpx"},onClick:a=>(a=>{u({url:`/pages/article_detail/article_detail?id=${a.id}`})})(t)},null,8,["src","onClick"])])),_:2},1024)])),_:2},1024)))),128)),0===F(R).length?(a(),e(x,{key:0},{default:l((()=>[s(p,{class:"empty-banner"},{default:l((()=>[s(g,{src:"/static/default-banner.jpg",mode:"aspectFill",style:{width:"100%",height:"250rpx"}})])),_:1})])),_:1})):j("",!0)])),_:1})])),_:1}),(a(!0),n(i,null,c(F(ta),(d=>(a(),e(p,{key:d.id,class:"news-item",onClick:a=>function(a){u({url:"/pages/sale_news/sale_news?id="+a.id+"&brand_id="+a.brand_id})}(d)},{default:l((()=>[s(p,{class:"news-images"},{default:l((()=>[d.image_list.length>0?(a(),e(C,{key:0,class:"image-swiper",autoplay:!0,circular:!0},{default:l((()=>[(a(!0),n(i,null,c(d.image_list,((t,o)=>(a(),e(x,{key:o},{default:l((()=>[s(g,{src:t,mode:"aspectFill",class:"swiper-image"},null,8,["src"])])),_:2},1024)))),128))])),_:2},1024)):j("",!0)])),_:2},1024),s(p,{class:"news-content"},{default:l((()=>[s(m,{class:"news-title"},{default:l((()=>[t(o(d.title),1)])),_:2},1024),s(m,{class:"news-desc"},{default:l((()=>[t(o(d.content),1)])),_:2},1024),s(p,{class:"news-footer"},{default:l((()=>[s(m,{class:"brand-tag"},{default:l((()=>[t(o(d.brand_name),1)])),_:2},1024),s(m,{class:"news-time"},{default:l((()=>[t(o(Sa(d.created_at)),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1032,["onClick"])))),128)),s(p,{class:"loading-more"},{default:l((()=>[ca.value?(a(),e(m,{key:0},{default:l((()=>[t("加载中...")])),_:1})):j("",!0),ia.value?j("",!0):(a(),e(m,{key:1},{default:l((()=>[t("没有更多了~")])),_:1}))])),_:1})])),_:1})):j("",!0)])),_:1},8,["show"]),s(D,{"mode-class":["fade"],show:"brands"===ba.value},{default:l((()=>["brands"===ba.value?(a(),e(p,{key:0,class:"body_list brand_box",style:{position:"relative"}},{default:l((()=>[s(p,{style:{width:"700rpx"}},{default:l((()=>[s(E,{style:{width:"100%"},width:"720rpx"})])),_:1}),s(p,{class:"filter-tabs"},{default:l((()=>[(a(!0),n(i,null,c(V.value,((s,n)=>(a(),e(p,{key:n,class:z(["tab-item",{active:W.value===s.value}]),onClick:a=>{return e=s.value,W.value===e?W.value=null:W.value=e,aa.value=1,la.value=!0,O.value=[],U.value="",void Fa();var e}},{default:l((()=>[t(o(s.label),1)])),_:2},1032,["class","onClick"])))),128))])),_:1}),s(p,{class:"brand_type_description",style:{display:"block",width:"100%"}},{default:l((()=>[1==W.value?(a(),e(m,{key:0},{default:l((()=>[t("中国公司制作的BJD在打磨、分模线等工艺的处理上比较优秀，价格也比外社低很多。")])),_:1})):j("",!0),2==W.value?(a(),e(m,{key:1},{default:l((()=>[t("个人作者在贩售娃物前基本都是圈内玩家，在设计方面花的心思很多。")])),_:1})):j("",!0),3==W.value?(a(),e(m,{key:2},{default:l((()=>[t("国外娃社起步较早，风格设计也比较多样化。")])),_:1})):j("",!0)])),_:1}),(a(!0),n(i,null,c(F(O),((t,o)=>(a(),e(p,{key:t.id},{default:l((()=>[s(G,{brand:t},null,8,["brand"])])),_:2},1024)))),128)),s(p,{class:"loading-more"},{default:l((()=>[sa.value?(a(),e(m,{key:0},{default:l((()=>[t("加载中...")])),_:1})):j("",!0),la.value?j("",!0):(a(),e(m,{key:1},{default:l((()=>[t("没有更多数据了")])),_:1}))])),_:1})])),_:1})):j("",!0)])),_:1},8,["show"]),s(D,{"mode-class":["fade"],show:"hot"===ba.value},{default:l((()=>["hot"===ba.value?(a(),e(p,{key:0,class:"body_list hot-box"},{default:l((()=>[(a(!0),n(i,null,c(F(ua),(d=>(a(),e(p,{key:d.collocation_id,class:"hot-item",onClick:a=>function(a){u({url:`/pages/collocation_share/collocation_share?collocation_id=${a.collocation_id}&origin=${a.origin}`})}(d)},{default:l((()=>[s(p,{class:"images-box"},{default:l((()=>[d.image_urls.length>0?(a(),e(C,{key:0,class:"image-swiper",autoplay:!0,circular:!0},{default:l((()=>[(a(!0),n(i,null,c(d.image_urls,((t,o)=>(a(),e(x,{key:o},{default:l((()=>[s(g,{src:t,mode:"aspectFill",class:"swiper-image"},null,8,["src"])])),_:2},1024)))),128))])),_:2},1024)):j("",!0)])),_:2},1024),s(p,{class:"content-box"},{default:l((()=>[s(m,{class:"title"},{default:l((()=>[t(o(d.title),1)])),_:2},1024),s(m,{class:"desc"},{default:l((()=>[t(o(d.content),1)])),_:2},1024),s(p,{class:"tags-box"},{default:l((()=>[(a(!0),n(i,null,c(d.relation_list,((n,i)=>(a(),e(p,{key:i,class:"tag-item"},{default:l((()=>[s(m,{class:"tag-text"},{default:l((()=>[t(o(n.relation_goods_name),1)])),_:2},1024),s(m,{class:"brand-text"},{default:l((()=>[t(o(n.relation_brand_name),1)])),_:2},1024)])),_:2},1024)))),128))])),_:2},1024),s(p,{class:"footer"},{default:l((()=>[s(p,{class:"user-info"},{default:l((()=>[s(g,{src:d.avatar,class:"avatar",mode:"aspectFill"},null,8,["src"]),s(m,{class:"time"},{default:l((()=>[t(" 发布"+o(1==d.origin?"搭配":"展示柜")+"于 "+o(Sa(d.created_at)),1)])),_:2},1024)])),_:2},1024),s(p,{class:"like-box"},{default:l((()=>[s(L,{type:"heart",size:"18",color:"#ff4d4f"}),s(m,{class:"like-count"},{default:l((()=>[t(o(d.like_count),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1032,["onClick"])))),128)),s(p,{class:"loading-more"},{default:l((()=>[fa.value?(a(),e(m,{key:0},{default:l((()=>[t("加载中...")])),_:1})):j("",!0),_a.value?j("",!0):(a(),e(m,{key:1},{default:l((()=>[t("没有更多了~")])),_:1}))])),_:1})])),_:1})):j("",!0)])),_:1},8,["show"]),s(D,{"mode-class":["fade"],show:"second"===ba.value},{default:l((()=>["second"===ba.value?(a(),e(p,{key:0,class:"body_list treehole-box"},{default:l((()=>[s(p,{class:"publish-btn",onClick:Da},{default:l((()=>[s(L,{type:"plusempty",size:"30",color:"#fff"})])),_:1}),(a(!0),n(i,null,c(F(va),(d=>(a(),e(p,{key:d.id,class:"treehole-item",onClick:a=>function(a){u({url:"/pages/treehole_detail/treehole_detail?id="+a.id})}(d)},{default:l((()=>[s(p,{class:"user-info",onClick:B((a=>function(a){1!=a.is_anonymous&&u({url:"/pages/user_page/user_page?uid="+a.uid})}(d)),["stop"])},{default:l((()=>[""!==d.avatar?(a(),e(g,{key:0,src:d.avatar,class:"avatar",mode:"aspectFill"},null,8,["src"])):(a(),e(g,{key:1,src:"/assets/noname-CTwn5AZS.png",class:"avatar",mode:"scaleToFill"})),s(m,{class:"username"},{default:l((()=>[t(o(d.is_anonymous?"匿名用户":d.author_name),1)])),_:2},1024),s(m,{class:"time"},{default:l((()=>[t(o(Sa(d.created_at)),1)])),_:2},1024),s(m,{class:"cid"},{default:l((()=>[t("【"+o(d.id)+"】",1)])),_:2},1024)])),_:2},1032,["onClick"]),s(m,{class:"content"},{default:l((()=>[t(o(d.content),1)])),_:2},1024),d.images.length>0?(a(),e(p,{key:0,class:"image-grid"},{default:l((()=>[s(C,{class:"image-swiper",autoplay:!0,circular:!0,"indicator-dots":""},{default:l((()=>[(a(!0),n(i,null,c(d.images,((t,o)=>(a(),e(x,{key:o},{default:l((()=>[s(g,{src:t,mode:"aspectFill",class:"swiper-image",onClick:B((a=>{return e=d.images,void I({current:o,urls:e});var e}),["stop"])},null,8,["src","onClick"])])),_:2},1024)))),128))])),_:2},1024)])),_:2},1024)):j("",!0),s(p,{class:"action-bar"},{default:l((()=>[s(p,{class:"action-item",onClick:a=>function(a){if(!N.isLogin)return void b({title:"请先登录",icon:"none"});let e=T("token");e?y({url:Z+(a.has_liked?"/with-state/unlike":"/with-state/add-like"),method:"POST",header:{Authorization:e},data:{id:a.id,type:5},success:e=>{"success"===e.data.status?(a.has_liked=!a.has_liked,a.like_count+=a.has_liked?1:-1):uni.showD}}):b({title:"请先登录",icon:"none"})}(d)},{default:l((()=>[s(L,{type:d.has_liked?"hand-up-filled":"hand-up",size:"18",color:d.has_liked?"#ff4d4f":"#666"},null,8,["type","color"]),s(m,{class:"count"},{default:l((()=>[t(o(d.like_count||0),1)])),_:2},1024)])),_:2},1032,["onClick"]),s(p,{class:"action-item"},{default:l((()=>[s(L,{type:"chat",size:"18",color:"#666"}),s(m,{class:"count"},{default:l((()=>[t(o(d.comment_count||0),1)])),_:2},1024)])),_:2},1024),s(p,{class:"action-item",onClick:B((a=>function(a){let e="http://m.dogdogdoll.com/#/pages/treehole_detail/treehole_detail?id="+a.id;A({data:e,success:function(){b({title:"复制链接成功",icon:"none"})}})}(d)),["stop"])},{default:l((()=>[s(L,{type:"redo",size:"18",color:"#666"}),s(m,{class:"count"},{default:l((()=>[t("分享")])),_:1})])),_:2},1032,["onClick"])])),_:2},1024)])),_:2},1032,["onClick"])))),128)),s(p,{class:"loading-more"},{default:l((()=>[ha.value?(a(),e(m,{key:0},{default:l((()=>[t("加载中...")])),_:1})):j("",!0),ma.value?j("",!0):(a(),e(m,{key:1},{default:l((()=>[t("没有更多了~")])),_:1}))])),_:1})])),_:1})):j("",!0)])),_:1},8,["show"])])),_:1})])),_:1})])),_:1})],64)}}},[["__scopeId","data-v-ae8db647"]]);export{R as default};
