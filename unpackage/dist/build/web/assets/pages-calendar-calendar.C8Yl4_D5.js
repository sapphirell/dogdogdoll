import{r as e,l as a,z as s,A as l,a as t,c as o,w as c,q as d,b as n,d as r,a1 as u,v as i,x as _,F as f,C as g,e as p,t as m,g as y,S as h,f as k,i as v,D as b,p as w,n as S}from"./index-I3aG4WZL.js";import{_ as j}from"./view-logs.C4HVuFxK.js";import{_ as C,o as x,r as $}from"./_plugin-vue_export-helper.DF4WgY5m.js";import{_ as D}from"./common-search.CQlKpRi4.js";import{_ as O}from"./loading-toast.B-pFXU1z.js";import{_ as F}from"./common-page.muX2OwPu.js";import{w as M}from"./config.BjeWXQ7P.js";import"./search.CsIL0f2m.js";import"./cancel.CnEdunnH.js";const z=C({__name:"calendar",setup(C){const z=e(["全部","整体","单头","单体","娃衣","眼珠","娃鞋","手型","脚型","袜子","配饰"]);let H=e("全部"),T=e({}),E=e({});const G=new Date,Y=`${G.getFullYear()}-${String(G.getMonth()+1).padStart(2,"0")}-${String(G.getDate()).padStart(2,"0")}`,q=e(null),A=a(),B=A.screenWidth/7;let I=e(0);e(A.statusBarHeight);let J=e(Y),L=e({}),P=e(!0);function V(){P.value=!0,d({url:M+"/goods-news",method:"GET",timeout:5e3,success:e=>{console.log(e.data.data),T.value=e.data.data,E.value=K("全部");for(let[a,s]of Object.entries(E.value))a===Y&&(L.value=s)},fail:e=>{console.log(e),l({title:"网络请求失败",icon:"none"})},complete:()=>{I.value=7*B-5,console.log("left:"+I.value),P.value=!1}})}function W(e){return e===Y}function K(e){const a={};return Object.entries(T.value).forEach((([s,l])=>{const t={...l};t.goods&&(t.goods="全部"===e?t.goods:t.goods.filter((a=>a.type===e)),0===t.goods.length&&(t.goods=null)),a[s]=t})),a}function N(e){const a=new Date(1e3*e);a.getFullYear();return`${(a.getMonth()+1).toString().padStart(2,"0")}-${a.getDate().toString().padStart(2,"0")} ${a.getHours().toString().padStart(2,"0")}:${a.getMinutes().toString().padStart(2,"0")}`}return V(),x((async()=>{try{V(),s()}catch(e){s(),l({title:"刷新失败",icon:"none"})}})),(e,a)=>{const s=$(t("view-logs"),j),l=$(t("common-search"),D),C=y,x=h,T=k,G=v,Y=$(t("loading-toast"),O),A=$(t("common-page"),F);return n(),o(A,{head_color:"rgb(185 195 253)"},{default:c((()=>[r(s),r(C,{class:"header-container"},{default:c((()=>[r(C,{class:"search-container",style:u("")},{default:c((()=>[r(l,{width:"560rpx"})])),_:1},8,["style"]),r(C,{class:"category-container"},{default:c((()=>[r(x,{"scroll-x":"true",class:"category-scroll","show-scrollbar":!1},{default:c((()=>[(n(!0),i(f,null,_(z.value,((e,a)=>(n(),o(C,{class:b(["category-item",{active:g(H)===e}]),key:a,onClick:a=>(e=>{H.value=e;const a=K(e);E.value={...a};const s=Object.entries(a).find((([e,a])=>a.goods));s?(J.value=s[0],L.value=s[1]):L.value={goods:null}})(e)},{default:c((()=>[p(m(e),1)])),_:2},1032,["class","onClick"])))),128))])),_:1})])),_:1})])),_:1}),r(C,{class:"date-picker-container"},{default:c((()=>[r(x,{class:"date-scroll","scroll-x":"true",ref_key:"scrollView",ref:q,"scroll-left":g(I),"show-scrollbar":!1},{default:c((()=>[(n(!0),i(f,null,_(g(E),((e,a)=>(n(),o(C,{key:e.id,class:"date-item",onClick:s=>function(e,a){console.log(a),J.value=e,L.value=a}(a,e)},{default:c((()=>[e.goods_number>0?(n(),o(C,{key:0,class:"date-badge"},{default:c((()=>[p(m(e.goods_number),1)])),_:2},1024)):w("",!0),r(C,{class:b(["weekday",{weekend:"周日"===e.weekday||"周六"===e.weekday}])},{default:c((()=>[p(m(e.weekday),1)])),_:2},1032,["class"]),r(C,{class:b(["day-number",{selected:g(J)===a}])},{default:c((()=>[p(m(W(a)?"今天":e.day_number),1)])),_:2},1032,["class"])])),_:2},1032,["onClick"])))),128))])),_:1},8,["scroll-left"])])),_:1}),r(C,{class:"goods-container"},{default:c((()=>[r(C,{class:"date-title"},{default:c((()=>[r(T,{class:"highlight"},{default:c((()=>[p(m(g(J))+" 日",1)])),_:1}),r(T,null,{default:c((()=>[p(" 星期"+m(g(L).weekday)+"上新",1)])),_:1})])),_:1}),null==g(L).goods?(n(),o(C,{key:0,class:"empty-tip"},{default:c((()=>[r(G,{src:"/static/empty-box.png",class:"empty-icon"}),r(T,null,{default:c((()=>[p("这天没有上新呢...")])),_:1})])),_:1})):(n(),o(C,{key:1},{default:c((()=>[(n(!0),i(f,null,_(g(L).goods,(e=>(n(),o(C,{key:e.id,class:"goods-card",onClick:a=>{return s=e.id,l=e.goods_id,d({url:M+"/sale-record-click?id="+s,method:"POST",header:{"Content-Type":"application/json"},success:()=>{console.log("点击记录成功")},fail:e=>{console.error("点击记录失败:",e)}}),void S({url:"/pages/goods/goods?goods_id="+l});var s,l}},{default:c((()=>[r(C,{class:"goods-image-container"},{default:c((()=>[r(G,{src:e.goods_image,mode:"aspectFill",class:"goods-image"},null,8,["src"]),r(C,{class:"goods-tags"},{default:c((()=>[r(T,{class:"tag sale-type"},{default:c((()=>[p(m(e.sale_type),1)])),_:2},1024),1==e.is_first_sale_day?(n(),o(T,{key:0,class:"tag first-day"},{default:c((()=>[p("首日")])),_:1})):w("",!0)])),_:2},1024)])),_:2},1024),r(C,{class:"goods-info"},{default:c((()=>[r(C,null,{default:c((()=>[r(T,{class:"brand-name"},{default:c((()=>[p(m(e.brand_name),1)])),_:2},1024),r(T,{class:"goods-name"},{default:c((()=>[p(m(e.goods_name),1)])),_:2},1024)])),_:2},1024),r(C,{class:"goods-details"},{default:c((()=>[r(T,null,{default:c((()=>[p(m(e.size)+" · "+m(e.size_detail)+" · "+m(e.type),1)])),_:2},1024)])),_:2},1024),r(C,{class:"time-info"},{default:c((()=>[r(T,null,{default:c((()=>[p("开定 "+m(N(e.sub_time)),1)])),_:2},1024),e.sub_time_end?(n(),o(T,{key:0},{default:c((()=>[p("截止 "+m(N(e.sub_time_end)),1)])),_:2},1024)):w("",!0)])),_:2},1024),r(C,{class:"price-info"},{default:c((()=>["限量现货"!=e.sale_type&&"不限量现货"!=e.sale_type?(n(),o(C,{key:0},{default:c((()=>[r(C,{class:"price-group"},{default:c((()=>[r(T,{class:"price-label"},{default:c((()=>[p("定金")])),_:1}),r(T,{class:"deposit-price"},{default:c((()=>[p(m(e.sub_amount),1)])),_:2},1024),r(T,{class:"currency"},{default:c((()=>[p("("+m(e.currency)+")",1)])),_:2},1024)])),_:2},1024),r(C,{class:"price-group"},{default:c((()=>[r(T,{class:"price-label"},{default:c((()=>[p("尾款")])),_:1}),r(T,{class:"final-price"},{default:c((()=>[p(m(e.fin_amount),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)):(n(),o(C,{key:1},{default:c((()=>[r(C,{class:"price-group"},{default:c((()=>[r(T,{class:"price-label"},{default:c((()=>[p("全款")])),_:1}),r(T,{class:"full-price"},{default:c((()=>[p(m(e.sub_amount+e.fin_amount),1)])),_:2},1024),r(T,{class:"currency"},{default:c((()=>[p("("+m(e.currency)+")",1)])),_:2},1024)])),_:2},1024)])),_:2},1024))])),_:2},1024)])),_:2},1024)])),_:2},1032,["onClick"])))),128))])),_:1}))])),_:1}),r(Y,{show:g(P)},null,8,["show"])])),_:1})}}},[["__scopeId","data-v-90c67351"]]);export{z as default};
