import{h as e,E as a,_ as t,c as l,w as s,l as i,m as c,g as o,o as n,a as u,b as r,t as d,e as m,r as _,F as p,v as g,i as v,f,q as h}from"./index-u2rUIk8T.js";import{b as $,a as k}from"./uni-app.es.DpDa-E5E.js";import{w}from"./config.DgkxgtZ3.js";import{_ as y}from"./_plugin-vue_export-helper.BCo6x5W8.js";const b=y({__name:"user_page",props:["uid"],setup(y){const b=e(0),S=e(["搭配","娃柜","点评"]),C=y,F=e({avatar:"",user_name:"加载中..."}),x=e([]),j=e([]),z=e([]),D=e([{page:1,pageSize:10,total:0,loading:!1,finished:!1},{page:1,pageSize:10,total:0,loading:!1,finished:!1},{page:1,pageSize:10,total:0,loading:!1,finished:!1}]);a(b,(e=>{D.value[e];0===[x,j,z][e].value.length&&L()}));const L=async()=>{const e=D.value[b.value];if(!e.loading&&!e.finished){e.loading=!0;try{let a,t;switch(b.value){case 0:a=`/user-info/collection?user_id=${C.uid}&page=${e.page}`,t="List";break;case 1:a=`/user-info/show-case?user_id=${C.uid}&page=${e.page}`,t="List";break;case 2:a=`/user-info/posts?user_id=${C.uid}&page=${e.page}`,t="comment_list"}console.log(`${w}${a}`);const l=await i({url:`${w}${a}`});if("success"===l.data.status){const a=l.data.data,s=a[t].map((e=>{var a,t,l;switch(b.value){case 0:return{id:e.id,cover:(null==(a=e.image_urls)?void 0:a.split(",")[0])||"",images:(null==(t=e.image_urls)?void 0:t.split(","))||[],title:e.title,time:e.created_at};case 1:return{id:e.id,cover:(null==(l=e.image_urls)?void 0:l.split(",")[0])||"",title:e.name,desc:e.description,time:e.created_at};case 2:return{id:e.id,product_thumb:e.target_image,product_name:e.target_name,content:e.comment,create_time:T(e.created_at)}}})),i=[x,j,z][b.value];i.value=[...i.value,...s],e.total=a.total,e.finished=i.value.length>=a.total,e.page++}}catch(a){console.log(a),c({title:"数据加载失败",icon:"none"})}finally{e.loading=!1}}},T=e=>{const a=new Date(1e3*e);return`${a.getFullYear()}-${(a.getMonth()+1).toString().padStart(2,"0")}-${a.getDate().toString().padStart(2,"0")}`};return t({title:"用户主页"}),$((()=>{(async()=>{try{const e=await i({url:`${w}/user-info?uid=${C.uid}`});"success"===e.data.status&&(F.value=e.data.data)}catch(e){c({title:"用户信息加载失败",icon:"none"})}})(),L()})),k((()=>{L()})),(e,a)=>{const t=v,i=f,c=o;return n(),l(c,{class:"page-container"},{default:s((()=>[u(c,{class:"header_container"},{default:s((()=>[u(c,{class:"header"},{default:s((()=>[u(t,{class:"avatar",src:F.value.avatar,mode:"aspectFill"},null,8,["src"]),u(i,{class:"username"},{default:s((()=>[r(d(F.value.user_name),1)])),_:1})])),_:1}),u(c,{class:"tabs"},{default:s((()=>[(n(!0),m(p,null,_(S.value,((e,a)=>(n(),l(c,{key:a,class:h(["tab-item font-alimamashuhei",{active:b.value===a}]),onClick:e=>b.value=a},{default:s((()=>[r(d(e),1)])),_:2},1032,["class","onClick"])))),128))])),_:1})])),_:1}),u(c,{class:"content"},{default:s((()=>[0===b.value?(n(),l(c,{key:0,class:"collocation-list"},{default:s((()=>[(n(!0),m(p,null,_(x.value,((a,o)=>(n(),l(c,{key:o,class:"collocation-item item-image-container",onClick:t=>e.navigateTo(`/pages/collocation_share/collocation_share?collocation_id=${a.id}`)},{default:s((()=>[u(t,{class:"item-image",src:a.cover,mode:"aspectFill"},null,8,["src"]),u(i,{class:"item-title"},{default:s((()=>[r(d(a.title),1)])),_:2},1024)])),_:2},1032,["onClick"])))),128))])),_:1})):g("",!0),1===b.value?(n(),l(c,{key:1,class:"doll-list"},{default:s((()=>[(n(!0),m(p,null,_(j.value,((a,o)=>(n(),l(c,{key:o,class:"doll-item item-image-container",onClick:t=>e.navigateTo(`/pages/user_doll/user_doll?id=${a.id}`)},{default:s((()=>[u(t,{class:"item-image",src:a.cover,mode:"aspectFill"},null,8,["src"]),u(i,{class:"item-title"},{default:s((()=>[r(d(a.title),1)])),_:2},1024),u(i,{class:"item-price"},{default:s((()=>[r("¥"+d(a.price),1)])),_:2},1024)])),_:2},1032,["onClick"])))),128))])),_:1})):g("",!0),2===b.value?(n(),l(c,{key:2,class:"review-list"},{default:s((()=>[(n(!0),m(p,null,_(z.value,((e,a)=>(n(),l(c,{key:a,class:"review-item"},{default:s((()=>[u(t,{class:"product-thumb",src:e.product_thumb,mode:"aspectFill"},null,8,["src"]),u(c,{class:"review-content"},{default:s((()=>[u(i,{class:"product-name"},{default:s((()=>[r(d(e.product_name),1)])),_:2},1024),u(i,{class:"review-text"},{default:s((()=>[r(d(e.content),1)])),_:2},1024),u(i,{class:"review-time"},{default:s((()=>[r(d(e.create_time),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)))),128))])),_:1})):g("",!0)])),_:1})])),_:1})}}},[["__scopeId","data-v-d012ddf0"]]);export{b as default};
