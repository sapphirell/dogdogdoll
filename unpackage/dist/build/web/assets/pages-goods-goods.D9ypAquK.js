import{h as e,g as t,U as l,s as a,j as o,u as s,c as i,w as n,v as d,l as c,m as u,p as r,C as _,f as g,o as p,a as f,b as m,t as x,V as y,d as h,r as b,F as v,W as k,X as w,N as C,Y as S,n as z,e as j,i as $,y as T,S as F,H as I,Z as L,q as A,_ as D,B,D as M}from"./index-CfMR_IzQ.js";import{_ as V}from"./uni-icons.sjYK3Gk_.js";import{b as E,c as G,r as O}from"./uni-app.es.5AkhYBbN.js";import{_ as P}from"./right2.s_X9TKoF.js";import{b as W,w as q,a as H,d as U}from"./config.BX5UpUDr.js";import{_ as Y}from"./_plugin-vue_export-helper.BCo6x5W8.js";const K=Y({__name:"goods",props:["goods_id"],setup(Y){const K=Y,N=e(),R=t(0),X=t(!1);E((()=>{})),G((()=>{}));const Z=l((()=>{var e;let t=(null==(e=N.safeAreaInsets)?void 0:e.bottom)||10;R.value>0&&(t+=R.value);let l=`${t}px`;return console.log("footer:"+l),l}));let J=t({}),Q=t({}),ee=t(1),te=t(1),le=t(""),ae=t(!1),oe=t(!1),se=t({});const ie=t(400),ne=t([]);function de(){X.value=!0}function ce(){X.value=!1}const ue=()=>{X.value=!1,S()};function re(e){console.log(e.detail.current),te.value=e.detail.current+1}function _e(){c({url:q+"/goods?id="+K.goods_id,method:"GET",timeout:5e3,success:e=>{console.log(e.data.data),J.value=e.data.data},fail:e=>{console.log(e),u({title:"网络请求失败",icon:"none"})},complete:()=>{r()}})}function ge(e){if(e<1e3)return e.toString();return`${Math.floor(e/1e3)}k+`}function pe(e){const t=new Date(1e3*e),l=t.getFullYear(),a=(t.getMonth()+1).toString().padStart(2,"0"),o=t.getDate().toString().padStart(2,"0"),s=t.getHours().toString().padStart(2,"0"),i=t.getMinutes().toString().padStart(2,"0");return t.getSeconds().toString().padStart(2,"0"),`${l}-${a}-${o} ${s}:${i}`}function fe(){c({url:q+"/goods-comment?goods_id="+K.goods_id+"&page="+ee.value,method:"GET",timeout:5e3,success:e=>{console.log(e.data.data),Q.value.page_index=e.data.data.page_index,Q.value.total=e.data.data.total,Q.value.comment_list=Q.value.comment_list?Q.value.comment_list.concat(e.data.data.comment_list):e.data.data.comment_list,null!=e.data.data.comment_list&&(e.data.data.comment_list.length>0&&(ee.value+=1),0==e.data.data.comment_list.length&&ee.value>1&&u({title:"没有更多数据了",icon:"none"}))},fail:e=>{console.log(e),u({title:"网络请求失败",icon:"none"})}})}function me(){let e=_("token");if(!H.isLogin)return void u({title:"请先登录",icon:"none"});if(""==le.value)return void u({title:"请输入评论内容",icon:"none"});let t=U(),l={content:le.value,target_id:parseInt(K.goods_id),type:2,origin:t};se.value.id&&(l.reply_id=se.value.id,l.reply_for=se.value.comment,l.reply_user_id=se.value.user_id),console.log(l),c({url:q+"/with-state/add-comment",method:"POST",header:{Authorization:e},data:l,success:e=>(console.log(e.data),"success"==e.data.status?(u({title:"评论成功",icon:"success"}),le.value="",ee.value=1,Q.value={},void fe()):void u({title:e.data.msg,icon:"none"})),fail:e=>{console.log(e),u({title:"网络请求失败",icon:"none"})}})}function xe(){let e=_("token");""!=e&&c({url:q+"/with-state/hasLike?id="+K.goods_id+"&type=1",method:"POST",header:{Authorization:e},success:e=>{console.log(e.data),"success"==e.data.status?e.data.data.id>0?ae.value=!0:ae.value=!1:u({title:e.data.msg,icon:"none"})},fail:e=>{console.log(e),u({title:"网络请求失败",icon:"none"})}})}function ye(){z({url:"/pages/collocation/collocation?goods_id="+K.goods_id+"&brand_id="+J.value.brand_id+"&goods_name="+J.value.name+"&brand_name="+J.value.brand_name+"&type="+J.value.type})}function he(e){if(!e)return"";return e.split(",")[0].trim()}return a({title:"加载中"}),_e(),fe(),c({url:q+"/goods-collocation?goods_id="+K.goods_id,method:"GET",timeout:5e3,success:e=>{console.log(e.data.data),oe.value=e.data.data},fail:e=>{console.log(e),u({title:"网络请求失败",icon:"none"})}}),W().then((e=>{console.log(e),xe()})),(e,t)=>{const l=O(o("uni-icons"),V),a=j,r=g,S=$,E=M,G=T,W=F,U=I,Y=L;return s(J).name?(p(),i(r,{key:0},{default:n((()=>[f(r,null,{default:n((()=>[f(r,{style:{position:"relative"}},{default:n((()=>[f(r,{class:"heart",onClick:t[0]||(t[0]=e=>function(){let e=_("token");if(!H.isLogin)return void u({title:"请先登录",icon:"none"});let t={id:parseInt(K.goods_id),type:1},l=ae.value?"/with-state/unlike":"/with-state/add-like";c({url:q+l,method:"POST",header:{Authorization:e},data:t,success:e=>(console.log(e.data),"success"==e.data.status?(u({title:"操作成功",icon:"success"}),ae.value=!ae.value,xe(),void _e()):void u({title:e.data.msg,icon:"none"})),fail:e=>{console.log(e),u({title:"网络请求失败",icon:"none"})}})}())},{default:n((()=>[s(ae)?(p(),i(l,{key:1,type:"heart-filled",size:"28",color:"#ff4d4f"})):(p(),i(l,{key:0,type:"heart",size:"28",color:"#ff4d4f"})),f(a,{class:"num",style:{color:"#ff4d4f"}},{default:n((()=>[m(x(ge(s(J).goods_like_count)),1)])),_:1})])),_:1}),f(G,{interval:3e3,duration:200,onChange:re,class:"banner_swiper",style:y([{"max-height":"800px"},{height:ie.value+"px"}])},{default:n((()=>[(p(!0),h(v,null,b(s(J).goods_images,((e,t)=>(p(),i(E,{key:t,class:"banner_swiper_item"},{default:n((()=>[f(r,{class:"swiper-item"},{default:n((()=>[f(S,{src:e,mode:"widthFix",style:{width:"100%",display:"block"},class:A("swiper-image-"+t),onClick:e=>{B({current:J.value.goods_images.index,urls:J.value.goods_images})},onLoad:e=>function(e){console.log("图片加载完成",e);const t=D();setTimeout((()=>{t.select(`.swiper-image-${e}`).boundingClientRect((t=>{try{if(!t)return void console.warn("未找到图片元素");console.log(t),ne.value[e]=t.height;const l=ne.value.filter((e=>e>0));if(0===l.length)return;ie.value=Math.max(...l)}catch(l){console.error("高度计算异常:",l)}})).exec()}),20)}(t)},null,8,["src","class","onClick","onLoad"])])),_:2},1024)])),_:2},1024)))),128))])),_:1},8,["style"]),f(r,{class:"swiper-index-box"},{default:n((()=>[f(a,{class:"font-alimamashuhei"},{default:n((()=>[m(x(s(te))+" / "+x(s(J).goods_images.length),1)])),_:1})])),_:1})])),_:1})])),_:1}),f(r,{class:"msg_body"},{default:n((()=>[f(r,{class:"msg_block"},{default:n((()=>[f(a,{class:"lable_text"},{default:n((()=>[m("名称")])),_:1}),f(a,{class:"msg_text"},{default:n((()=>[m(x(s(J).name),1)])),_:1})])),_:1}),f(r,{class:"msg_block"},{default:n((()=>[f(a,{class:"lable_text"},{default:n((()=>[m("类型")])),_:1}),f(a,{class:"msg_text"},{default:n((()=>[m(x(s(J).type),1)])),_:1})])),_:1}),f(r,{class:"msg_block"},{default:n((()=>[f(a,{class:"lable_text"},{default:n((()=>[m("初贩定价")])),_:1}),s(J).total_amount?(p(),i(a,{key:0,class:"msg_text"},{default:n((()=>[m(x(s(J).total_amount+" "+s(J).currency),1)])),_:1})):s(J).goods_sales&&s(J).goods_sales.length>0?(p(),i(a,{key:1,class:"msg_text"},{default:n((()=>[m(x(s(J).goods_sales[0].sub_amount+s(J).goods_sales[0].fin_amount)+" "+x(s(J).goods_sales[0].currency),1)])),_:1})):(p(),i(a,{key:2},{default:n((()=>[m("未知")])),_:1}))])),_:1}),f(r,{class:"msg_block"},{default:n((()=>[f(a,{class:"lable_text"},{default:n((()=>[m("初贩时间")])),_:1}),f(a,{class:"msg_text"},{default:n((()=>[m(x(s(J).sub_time1>0?pe(s(J).sub_time1):"未知"),1)])),_:1})])),_:1}),f(r,{class:"msg_block"},{default:n((()=>[f(a,{class:"lable_text"},{default:n((()=>[m("尺寸")])),_:1}),f(a,{class:"msg_text"},{default:n((()=>[m(x(s(J).size)+" / "+x(s(J).size_detail),1)])),_:1})])),_:1}),"单体"===s(J).type||"整体"===s(J).type||"单头"===s(J).type?(p(),i(r,{key:0,class:"msg_block"},{default:n((()=>[f(a,{class:"lable_text"},{default:n((()=>[m("可选体型")])),_:1}),f(a,{class:"msg_text"},{default:n((()=>[m(x(s(J).body_size||"未知"),1)])),_:1})])),_:1})):d("",!0),f(r,{class:"msg_block"},{default:n((()=>[f(a,{class:"lable_text"},{default:n((()=>[m("可选颜色")])),_:1}),f(a,{class:"msg_text"},{default:n((()=>[m(x(s(J).skin),1)])),_:1})])),_:1}),f(r,{class:"msg_block"},{default:n((()=>[f(a,{class:"lable_text"},{default:n((()=>[m("贩售情报")])),_:1}),null==s(J).goods_sales?(p(),i(a,{key:0},{default:n((()=>[m("暂无收录贩售详细信息")])),_:1})):d("",!0),f(r,{class:"msg_text"},{default:n((()=>[(p(!0),h(v,null,b(s(J).goods_sales,(e=>(p(),i(a,{key:e.id,style:{width:"100%",display:"block","margin-bottom":"10px"}},{default:n((()=>[m(x(pe(e.sub_time))+", "+x(e.sale_type)+", 总价: "+x(e.sub_amount+e.fin_amount)+" ("+x(e.currency)+") ",1)])),_:2},1024)))),128))])),_:1})])),_:1}),f(r,{class:"msg_block"},{default:n((()=>[f(a,{class:"lable_text"},{default:n((()=>[m("制作方")])),_:1}),f(a,{class:"msg_text",style:{color:"#55aae5"},onClick:t[1]||(t[1]=e=>{return t=s(J).brand_id,void z({url:"/pages/brand/brand?brand_id="+t});var t})},{default:n((()=>[m(x(s(J).brand_name),1)])),_:1})])),_:1}),f(r,{class:"msg_block"},{default:n((()=>[f(a,{class:"lable_text"},{default:n((()=>[m("备注")])),_:1}),f(a,{class:"msg_text"},{default:n((()=>[m(x(s(J).desc_content),1)])),_:1})])),_:1})])),_:1}),f(r,{style:{padding:"40rpx"}},{default:n((()=>[f(r,{style:{display:"flex",margin:"30px 5px 10px 5px"}},{default:n((()=>[f(a,{style:{color:"rgb(100, 198, 220)","font-weight":"bold",display:"block",width:"calc(100% - 130rpx)"}},{default:n((()=>[m("搭配参考")])),_:1}),f(r,{style:{display:"flex"}},{default:n((()=>[f(a,{style:{width:"110rpx",display:"inline-block",color:"#888"}},{default:n((()=>[m("查看更多")])),_:1}),f(S,{src:P,style:{width:"30rpx",height:"30rpx",display:"inline-block",position:"relative",top:"3rpx"}})])),_:1})])),_:1}),f(W,{"scroll-x":"true",class:"collocationBox","ll-with-animation":"true","show-scrollbar":!1},{default:n((()=>[s(oe)&&s(oe).collocation_relation_list.length>0?(p(!0),h(v,{key:0},b(s(oe).collocation_relation_list,(e=>(p(),i(r,{key:e.collocation_id,style:{},class:"collocationItem square",onClick:t=>{return l=e.collocation_id,a=e.relation_origin,void z({url:"/pages/collocation_share/collocation_share?collocation_id="+l+"&origin="+a});var l,a}},{default:n((()=>[f(S,{src:he(e.image_urls),mode:"aspectFill",style:{width:"100%",height:"100%"}},null,8,["src"])])),_:2},1032,["onClick"])))),128)):d("",!0)])),_:1}),f(r,{onClick:ye,style:{border:"1px solid #eaeaea",display:"flex",margin:"20rpx auto","border-radius":"15rpx",width:"400rpx"}},{default:n((()=>[f(S,{src:"/assets/paper_plane-DW2p-K8L.png",style:{width:"45rpx",height:"45rpx",margin:"18rpx"}}),f(a,{style:{color:"rgb(184 184 184)",margin:"12px auto"}},{default:n((()=>[m("上传搭配参考帮助他人")])),_:1})])),_:1})])),_:1}),f(r,{style:{padding:"20px"}},{default:n((()=>[f(a,{style:{color:"rgb(100, 198, 220)","font-weight":"bold",isplay:"block",margin:"30px 5px",display:"block"}},{default:n((()=>[m("评论区 ("+x(s(Q).total||0)+")",1)])),_:1}),f(r,null,{default:n((()=>[s(Q).comment_list?(p(),i(r,{key:0},{default:n((()=>[(p(!0),h(v,null,b(s(Q).comment_list,((e,t)=>(p(),i(r,{class:"comment_item",key:e.id,style:{"margin-bottom":"20px"}},{default:n((()=>[f(r,{style:{float:"left",width:"80px",padding:"0px 10px 10px 0px"},onClick:t=>{return l=e.uid,void z({url:"/pages/user_page/user_page?uid="+l});var l}},{default:n((()=>[f(S,{style:{width:"50px",height:"50px","border-radius":"100%",display:"block",margin:"10px"},src:e.avatar,mode:"aspectFill"},null,8,["src"]),f(a,{style:{display:"block","white-space":"nowrap",overflow:"hidden","text-overflow":"ellipsis"}},{default:n((()=>[m(x(e.username),1)])),_:2},1024)])),_:2},1032,["onClick"]),f(r,{style:{float:"left",padding:"15px 15px 30px 15px",background:"rgb(245 245 245)",width:"calc(100vw - 170px)","min-height":"60px","border-radius":"15px",position:"relative",top:"2px"}},{default:n((()=>[f(a,{style:{width:"100%","white-space":"normal","word-break":"break-all"}},{default:n((()=>[m(x(e.comment),1)])),_:2},1024),f(a,{style:{color:"#888","font-size":"12px",position:"absolute",bottom:"3px",left:"15px"}},{default:n((()=>[m(x(pe(e.created_at))+" floor#"+x(e.floor),1)])),_:2},1024),f(a,{style:y([{fontSize:"12px",position:"absolute",bottom:"3px",right:"15px",fontWeight:"1000"},s(se).id===e.id?{color:"#fd6669"}:{color:"#888"}]),onClick:t=>function(e){se.value.id!=e.id?se.value=e:se.value={}}(e)},{default:n((()=>[m(" 引用此回复 ")])),_:2},1032,["style","onClick"])])),_:2},1024),f(r,{style:{clear:"both"}})])),_:2},1024)))),128)),f(U,{class:"load_more",onClick:fe},{default:n((()=>[m("加载更多")])),_:1})])),_:1})):d("",!0)])),_:1})])),_:1}),f(r,{style:{height:"80px"}}),k(f(r,{class:"mask",onClick:ue},null,512),[[w,X.value]]),f(r,{class:"bottom_tab",style:y({paddingBottom:Z.value})},{default:n((()=>[s(se).id?(p(),i(a,{key:0,class:"replyInfo",style:{}},{default:n((()=>[m(x("@"+s(se).username),1)])),_:1})):d("",!0),f(Y,{class:"comment_input",modelValue:s(le),"onUpdate:modelValue":t[2]||(t[2]=e=>C(le)?le.value=e:le=e),style:{},onClick:de,onFocus:de,onBlur:ce,"adjust-position":!1},null,8,["modelValue"]),f(U,{style:{"flex-shrink":"0",width:"90px"},onClick:me},{default:n((()=>[m("写评论")])),_:1})])),_:1},8,["style"])])),_:1})):d("",!0)}}},[["__scopeId","data-v-a44ec30d"]]);export{K as default};
