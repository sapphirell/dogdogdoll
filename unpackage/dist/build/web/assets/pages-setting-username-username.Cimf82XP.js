import{a2 as a,r as s,m as e,a as t,c as l,w as u,g as o,b as n,d as i,e as r,C as c,t as d,u as p,v as f,j as m,A as v,ab as _,M as h,X as b,h as g,f as y}from"./index-6ojkiy1R.js";import{_ as w}from"./uni-icons.C75VRGWb.js";import{r as j}from"./uni-app.es.BMFd5FAr.js";import{b as x,w as k,a as z}from"./config.Bhvn_Gfs.js";import{_ as A}from"./_plugin-vue_export-helper.BCo6x5W8.js";const I=A({__name:"username",setup(A){a({title:"修改用户名"});const I=s(x.userInfo.username||""),V=s(!1),C=e((()=>I.value.length>=2&&I.value!==x.userInfo.username));async function T(){if(C.value)try{V.value=!0;const a=await f({url:k+"/with-state/update-profile",method:"POST",header:{Authorization:m("token")},data:{username:I.value}});"success"===a.data.status?(v({title:"更新成功",icon:"success"}),await z(),setTimeout((()=>_()),1500)):v({title:a.data.msg||"更新失败",icon:"none"})}catch(a){v({title:"请求失败，请稍后重试",icon:"none"})}finally{V.value=!1}}return(a,s)=>{const e=h,f=b,m=j(t("uni-icons"),w),v=o,_=g,x=y;return n(),l(v,{class:"password-container"},{default:u((()=>[i(v,{class:"form-wrapper"},{default:u((()=>[i(v,{class:"input-group"},{default:u((()=>[i(v,{class:"input-item"},{default:u((()=>[i(e,{class:"input",type:"text",placeholder:" ",modelValue:I.value,"onUpdate:modelValue":s[0]||(s[0]=a=>I.value=a),maxlength:"20"},null,8,["modelValue"]),i(f,{class:"floating-label"},{default:u((()=>[r("用户名")])),_:1}),i(m,{class:"input-icon",type:"person",size:"18",color:"#999"})])),_:1})])),_:1}),i(_,{class:c(["submit-btn",{active:C.value}]),onClick:T,disabled:!C.value},{default:u((()=>[r(d(V.value?"提交中...":"更新用户名")+" ",1),V.value?(n(),l(v,{key:0,class:"loading"})):p("",!0)])),_:1},8,["class","disabled"])])),_:1}),i(v,{class:"security-tips"},{default:u((()=>[i(m,{type:"info",size:"16",color:"#666"}),i(x,null,{default:u((()=>[r("用户名2-20个字符，支持中英文、数字和下划线")])),_:1})])),_:1})])),_:1})}}},[["__scopeId","data-v-960efc4b"]]);export{I as default};
