import{r as e,l as a,z as s,A as l,a as t,c as o,w as c,q as d,b as n,d as r,a0 as u,v as i,x as _,F as f,C as g,e as p,t as m,g as y,S as h,f as k,i as v,D as b,p as w,n as S}from"./index-BFzTDSoz.js";import{w as j,_ as x}from"./view-logs.yEAac7W9.js";import{_ as C,o as $,r as D}from"./_plugin-vue_export-helper.CXFOpRdI.js";import{_ as F}from"./common-search.BzljtTyU.js";import{_ as O}from"./loading-toast.Ct1e0P5S.js";import{_ as z}from"./common-page.Dhg03y__.js";import"./search.CsIL0f2m.js";import"./cancel.CnEdunnH.js";const E=C({__name:"calendar",setup(C){const E=e(["全部","整体","单头","单体","娃衣","眼珠","娃鞋","手型","脚型","袜子","配饰"]);let H=e("全部"),M=e({}),T=e({});const A=new Date,B=`${A.getFullYear()}-${String(A.getMonth()+1).padStart(2,"0")}-${String(A.getDate()).padStart(2,"0")}`,G=e(null),I=a(),Y=I.screenWidth/7;let q=e(0);e(I.statusBarHeight);let J=e(B),P=e({}),V=e(!0);function W(){V.value=!0,d({url:j+"/goods-news",method:"GET",timeout:5e3,success:e=>{console.log(e.data.data),M.value=e.data.data,T.value=L("全部");for(let[a,s]of Object.entries(T.value))a===B&&(P.value=s)},fail:e=>{console.log(e),l({title:"网络请求失败",icon:"none"})},complete:()=>{q.value=7*Y-5,console.log("left:"+q.value),V.value=!1}})}function K(e){return e===B}function L(e){const a={};return Object.entries(M.value).forEach((([s,l])=>{const t={...l};t.goods&&(t.goods="全部"===e?t.goods:t.goods.filter((a=>a.type===e)),0===t.goods.length&&(t.goods=null)),a[s]=t})),a}function N(e){const a=new Date(1e3*e);a.getFullYear();return`${(a.getMonth()+1).toString().padStart(2,"0")}-${a.getDate().toString().padStart(2,"0")} ${a.getHours().toString().padStart(2,"0")}:${a.getMinutes().toString().padStart(2,"0")}`}return W(),$((async()=>{try{W(),s()}catch(e){s(),l({title:"刷新失败",icon:"none"})}})),(e,a)=>{const s=D(t("view-logs"),x),l=D(t("common-search"),F),C=y,$=h,M=k,A=v,B=D(t("loading-toast"),O),I=D(t("common-page"),z);return n(),o(I,{head_color:"rgb(185 195 253)"},{default:c((()=>[r(s),r(C,{class:"header-container"},{default:c((()=>[r(C,{class:"search-container",style:u("")},{default:c((()=>[r(l,{width:"560rpx"})])),_:1},8,["style"]),r(C,{class:"category-container"},{default:c((()=>[r($,{"scroll-x":"true",class:"category-scroll","show-scrollbar":!1},{default:c((()=>[(n(!0),i(f,null,_(E.value,((e,a)=>(n(),o(C,{class:b(["category-item",{active:g(H)===e}]),key:a,onClick:a=>(e=>{H.value=e;const a=L(e);T.value={...a};const s=Object.entries(a).find((([e,a])=>a.goods));s?(J.value=s[0],P.value=s[1]):P.value={goods:null}})(e)},{default:c((()=>[p(m(e),1)])),_:2},1032,["class","onClick"])))),128))])),_:1})])),_:1})])),_:1}),r(C,{class:"date-picker-container"},{default:c((()=>[r($,{class:"date-scroll","scroll-x":"true",ref_key:"scrollView",ref:G,"scroll-left":g(q),"show-scrollbar":!1},{default:c((()=>[(n(!0),i(f,null,_(g(T),((e,a)=>(n(),o(C,{key:e.id,class:"date-item",onClick:s=>function(e,a){console.log(a),J.value=e,P.value=a}(a,e)},{default:c((()=>[e.goods_number>0?(n(),o(C,{key:0,class:"date-badge"},{default:c((()=>[p(m(e.goods_number),1)])),_:2},1024)):w("",!0),r(C,{class:b(["weekday",{weekend:"周日"===e.weekday||"周六"===e.weekday}])},{default:c((()=>[p(m(e.weekday),1)])),_:2},1032,["class"]),r(C,{class:b(["day-number",{selected:g(J)===a}])},{default:c((()=>[p(m(K(a)?"今天":e.day_number),1)])),_:2},1032,["class"])])),_:2},1032,["onClick"])))),128))])),_:1},8,["scroll-left"])])),_:1}),r(C,{class:"goods-container"},{default:c((()=>[r(C,{class:"date-title"},{default:c((()=>[r(M,{class:"highlight"},{default:c((()=>[p(m(g(J))+" 日",1)])),_:1}),r(M,null,{default:c((()=>[p(" 星期"+m(g(P).weekday)+"上新",1)])),_:1})])),_:1}),null==g(P).goods?(n(),o(C,{key:0,class:"empty-tip"},{default:c((()=>[r(A,{src:"/static/empty-box.png",class:"empty-icon"}),r(M,null,{default:c((()=>[p("这天没有上新呢...")])),_:1})])),_:1})):(n(),o(C,{key:1},{default:c((()=>[(n(!0),i(f,null,_(g(P).goods,(e=>(n(),o(C,{key:e.id,class:"goods-card",onClick:a=>{return s=e.id,l=e.goods_id,d({url:j+"/sale-record-click?id="+s,method:"POST",header:{"Content-Type":"application/json"},success:()=>{console.log("点击记录成功")},fail:e=>{console.error("点击记录失败:",e)}}),void S({url:"/pages/goods/goods?goods_id="+l});var s,l}},{default:c((()=>[r(C,{class:"goods-image-container"},{default:c((()=>[r(A,{src:e.goods_image,mode:"aspectFill",class:"goods-image"},null,8,["src"]),r(C,{class:"goods-tags"},{default:c((()=>[r(M,{class:"tag sale-type"},{default:c((()=>[p(m(e.sale_type),1)])),_:2},1024),1==e.is_first_sale_day?(n(),o(M,{key:0,class:"tag first-day"},{default:c((()=>[p("首日")])),_:1})):w("",!0)])),_:2},1024)])),_:2},1024),r(C,{class:"goods-info"},{default:c((()=>[r(C,null,{default:c((()=>[r(M,{class:"brand-name"},{default:c((()=>[p(m(e.brand_name),1)])),_:2},1024),r(M,{class:"goods-name"},{default:c((()=>[p(m(e.goods_name),1)])),_:2},1024)])),_:2},1024),r(C,{class:"goods-details"},{default:c((()=>[r(M,null,{default:c((()=>[p(m(e.size)+" · "+m(e.size_detail)+" · "+m(e.type),1)])),_:2},1024)])),_:2},1024),r(C,{class:"time-info"},{default:c((()=>[r(M,null,{default:c((()=>[p("开定 "+m(N(e.sub_time)),1)])),_:2},1024),e.sub_time_end?(n(),o(M,{key:0},{default:c((()=>[p("截止 "+m(N(e.sub_time_end)),1)])),_:2},1024)):w("",!0)])),_:2},1024),r(C,{class:"price-info"},{default:c((()=>["限量现货"!=e.sale_type&&"不限量现货"!=e.sale_type?(n(),o(C,{key:0},{default:c((()=>[r(C,{class:"price-group"},{default:c((()=>[r(M,{class:"price-label"},{default:c((()=>[p("定金")])),_:1}),r(M,{class:"deposit-price"},{default:c((()=>[p(m(e.sub_amount),1)])),_:2},1024),r(M,{class:"currency"},{default:c((()=>[p("("+m(e.currency)+")",1)])),_:2},1024)])),_:2},1024),r(C,{class:"price-group"},{default:c((()=>[r(M,{class:"price-label"},{default:c((()=>[p("尾款")])),_:1}),r(M,{class:"final-price"},{default:c((()=>[p(m(e.fin_amount),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)):(n(),o(C,{key:1},{default:c((()=>[r(C,{class:"price-group"},{default:c((()=>[r(M,{class:"price-label"},{default:c((()=>[p("全款")])),_:1}),r(M,{class:"full-price"},{default:c((()=>[p(m(e.sub_amount+e.fin_amount),1)])),_:2},1024),r(M,{class:"currency"},{default:c((()=>[p("("+m(e.currency)+")",1)])),_:2},1024)])),_:2},1024)])),_:2},1024))])),_:2},1024)])),_:2},1024)])),_:2},1032,["onClick"])))),128))])),_:1}))])),_:1}),r(B,{show:g(V)},null,8,["show"])])),_:1})}}},[["__scopeId","data-v-90c67351"]]);export{E as default};
