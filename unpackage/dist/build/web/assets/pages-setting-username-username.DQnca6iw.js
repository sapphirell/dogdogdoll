import{a3 as a,r as s,k as e,a as t,v as l,d as o,w as u,F as n,g as i,b as r,e as c,D as d,t as p,c as f,p as m,q as v,j as _,A as g,ab as b,N as h,X as w,h as y,f as j}from"./index-I3aG4WZL.js";import{_ as x}from"./view-logs.C4HVuFxK.js";import{_ as k,r as z}from"./_plugin-vue_export-helper.DF4WgY5m.js";import{_ as I}from"./uni-icons.BQtdpjJ2.js";import{b as V,w as A,a as C}from"./config.BjeWXQ7P.js";const D=k({__name:"username",setup(k){a({title:"修改用户名"});const D=s(V.userInfo.username||""),T=s(!1),q=e((()=>D.value.length>=2&&D.value!==V.userInfo.username));async function E(){if(q.value)try{T.value=!0;const a=await v({url:A+"/with-state/update-profile",method:"POST",header:{Authorization:_("token")},data:{username:D.value}});"success"===a.data.status?(g({title:"更新成功",icon:"success"}),await C(),setTimeout((()=>b()),1500)):g({title:a.data.msg||"更新失败",icon:"none"})}catch(a){g({title:"请求失败，请稍后重试",icon:"none"})}finally{T.value=!1}}return(a,s)=>{const e=z(t("view-logs"),x),v=h,_=w,g=z(t("uni-icons"),I),b=i,k=y,V=j;return r(),l(n,null,[o(e),o(b,{class:"password-container"},{default:u((()=>[o(b,{class:"form-wrapper"},{default:u((()=>[o(b,{class:"input-group"},{default:u((()=>[o(b,{class:"input-item"},{default:u((()=>[o(v,{class:"input",type:"text",placeholder:" ",modelValue:D.value,"onUpdate:modelValue":s[0]||(s[0]=a=>D.value=a),maxlength:"20"},null,8,["modelValue"]),o(_,{class:"floating-label"},{default:u((()=>[c("用户名")])),_:1}),o(g,{class:"input-icon",type:"person",size:"18",color:"#999"})])),_:1})])),_:1}),o(k,{class:d(["submit-btn",{active:q.value}]),onClick:E,disabled:!q.value},{default:u((()=>[c(p(T.value?"提交中...":"更新用户名")+" ",1),T.value?(r(),f(b,{key:0,class:"loading"})):m("",!0)])),_:1},8,["class","disabled"])])),_:1}),o(b,{class:"security-tips"},{default:u((()=>[o(g,{type:"info",size:"16",color:"#666"}),o(V,null,{default:u((()=>[c("用户名2-20个字符，支持中英文、数字和下划线")])),_:1})])),_:1})])),_:1})],64)}}},[["__scopeId","data-v-bf9b8671"]]);export{D as default};
