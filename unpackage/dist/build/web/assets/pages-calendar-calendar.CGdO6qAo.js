import{r as e,p as a,z as s,A as l,a as t,c as o,w as c,v as d,b as n,d as r,a0 as u,k as i,l as f,F as _,D as g,e as p,t as m,g as y,S as k,f as h,i as b,C as v,u as w,n as S}from"./index-6ojkiy1R.js";import{_ as j}from"./common-search.DQepwF8H.js";import{o as C,r as x}from"./uni-app.es.BMFd5FAr.js";import{_ as $}from"./loading-toast.DerU_Gz0.js";import{_ as D}from"./common-page.fI1NTZim.js";import{w as F}from"./config.Bhvn_Gfs.js";import{_ as O}from"./_plugin-vue_export-helper.BCo6x5W8.js";import"./search.CsIL0f2m.js";import"./cancel.CnEdunnH.js";const z=O({__name:"calendar",setup(O){const z=e(["全部","整体","单头","单体","娃衣","眼珠","娃鞋","手型","脚型","袜子","配饰"]);let E=e("全部"),H=e({}),M=e({});const T=new Date,B=`${T.getFullYear()}-${String(T.getMonth()+1).padStart(2,"0")}-${String(T.getDate()).padStart(2,"0")}`,G=e(null),I=a(),Y=I.screenWidth/7;let A=e(0);e(I.statusBarHeight);let J=e(B),K=e({}),P=e(!0);function V(){P.value=!0,d({url:F+"/goods-news",method:"GET",timeout:5e3,success:e=>{console.log(e.data.data),H.value=e.data.data,M.value=q("全部");for(let[a,s]of Object.entries(M.value))a===B&&(K.value=s)},fail:e=>{console.log(e),l({title:"网络请求失败",icon:"none"})},complete:()=>{A.value=7*Y-5,console.log("left:"+A.value),P.value=!1}})}function W(e){return e===B}function q(e){const a={};return Object.entries(H.value).forEach((([s,l])=>{const t={...l};t.goods&&(t.goods="全部"===e?t.goods:t.goods.filter((a=>a.type===e)),0===t.goods.length&&(t.goods=null)),a[s]=t})),a}function L(e){const a=new Date(1e3*e);a.getFullYear();return`${(a.getMonth()+1).toString().padStart(2,"0")}-${a.getDate().toString().padStart(2,"0")} ${a.getHours().toString().padStart(2,"0")}:${a.getMinutes().toString().padStart(2,"0")}`}return V(),C((async()=>{try{V(),s()}catch(e){s(),l({title:"刷新失败",icon:"none"})}})),(e,a)=>{const s=x(t("common-search"),j),l=y,C=k,O=h,H=b,T=x(t("loading-toast"),$),B=x(t("common-page"),D);return n(),o(B,{head_color:"rgb(185 195 253)"},{default:c((()=>[r(l,{class:"header-container"},{default:c((()=>[r(l,{class:"search-container",style:u("")},{default:c((()=>[r(s,{width:"560rpx"})])),_:1},8,["style"]),r(l,{class:"category-container"},{default:c((()=>[r(C,{"scroll-x":"true",class:"category-scroll","show-scrollbar":!1},{default:c((()=>[(n(!0),i(_,null,f(z.value,((e,a)=>(n(),o(l,{class:v(["category-item",{active:g(E)===e}]),key:a,onClick:a=>(e=>{E.value=e;const a=q(e);M.value={...a};const s=Object.entries(a).find((([e,a])=>a.goods));s?(J.value=s[0],K.value=s[1]):K.value={goods:null}})(e)},{default:c((()=>[p(m(e),1)])),_:2},1032,["class","onClick"])))),128))])),_:1})])),_:1})])),_:1}),r(l,{class:"date-picker-container"},{default:c((()=>[r(C,{class:"date-scroll","scroll-x":"true",ref_key:"scrollView",ref:G,"scroll-left":g(A),"show-scrollbar":!1},{default:c((()=>[(n(!0),i(_,null,f(g(M),((e,a)=>(n(),o(l,{key:e.id,class:"date-item",onClick:s=>function(e,a){console.log(a),J.value=e,K.value=a}(a,e)},{default:c((()=>[e.goods_number>0?(n(),o(l,{key:0,class:"date-badge"},{default:c((()=>[p(m(e.goods_number),1)])),_:2},1024)):w("",!0),r(l,{class:v(["weekday",{weekend:"周日"===e.weekday||"周六"===e.weekday}])},{default:c((()=>[p(m(e.weekday),1)])),_:2},1032,["class"]),r(l,{class:v(["day-number",{selected:g(J)===a}])},{default:c((()=>[p(m(W(a)?"今天":e.day_number),1)])),_:2},1032,["class"])])),_:2},1032,["onClick"])))),128))])),_:1},8,["scroll-left"])])),_:1}),r(l,{class:"goods-container"},{default:c((()=>[r(l,{class:"date-title"},{default:c((()=>[r(O,{class:"highlight"},{default:c((()=>[p(m(g(J))+" 日",1)])),_:1}),r(O,null,{default:c((()=>[p(" 星期"+m(g(K).weekday)+"上新",1)])),_:1})])),_:1}),null==g(K).goods?(n(),o(l,{key:0,class:"empty-tip"},{default:c((()=>[r(H,{src:"/static/empty-box.png",class:"empty-icon"}),r(O,null,{default:c((()=>[p("这天没有上新呢...")])),_:1})])),_:1})):(n(),o(l,{key:1},{default:c((()=>[(n(!0),i(_,null,f(g(K).goods,(e=>(n(),o(l,{key:e.id,class:"goods-card",onClick:a=>{return s=e.id,l=e.goods_id,d({url:F+"/sale-record-click?id="+s,method:"POST",header:{"Content-Type":"application/json"},success:()=>{console.log("点击记录成功")},fail:e=>{console.error("点击记录失败:",e)}}),void S({url:"/pages/goods/goods?goods_id="+l});var s,l}},{default:c((()=>[r(l,{class:"goods-image-container"},{default:c((()=>[r(H,{src:e.goods_image,mode:"aspectFill",class:"goods-image"},null,8,["src"]),r(l,{class:"goods-tags"},{default:c((()=>[r(O,{class:"tag sale-type"},{default:c((()=>[p(m(e.sale_type),1)])),_:2},1024),1==e.is_first_sale_day?(n(),o(O,{key:0,class:"tag first-day"},{default:c((()=>[p("首日")])),_:1})):w("",!0)])),_:2},1024)])),_:2},1024),r(l,{class:"goods-info"},{default:c((()=>[r(l,null,{default:c((()=>[r(O,{class:"brand-name"},{default:c((()=>[p(m(e.brand_name),1)])),_:2},1024),r(O,{class:"goods-name"},{default:c((()=>[p(m(e.goods_name),1)])),_:2},1024)])),_:2},1024),r(l,{class:"goods-details"},{default:c((()=>[r(O,null,{default:c((()=>[p(m(e.size)+" · "+m(e.size_detail)+" · "+m(e.type),1)])),_:2},1024)])),_:2},1024),r(l,{class:"time-info"},{default:c((()=>[r(O,null,{default:c((()=>[p("开定 "+m(L(e.sub_time)),1)])),_:2},1024),e.sub_time_end?(n(),o(O,{key:0},{default:c((()=>[p("截止 "+m(L(e.sub_time_end)),1)])),_:2},1024)):w("",!0)])),_:2},1024),r(l,{class:"price-info"},{default:c((()=>["限量现货"!=e.sale_type&&"不限量现货"!=e.sale_type?(n(),o(l,{key:0},{default:c((()=>[r(l,{class:"price-group"},{default:c((()=>[r(O,{class:"price-label"},{default:c((()=>[p("定金")])),_:1}),r(O,{class:"deposit-price"},{default:c((()=>[p(m(e.sub_amount),1)])),_:2},1024),r(O,{class:"currency"},{default:c((()=>[p("("+m(e.currency)+")",1)])),_:2},1024)])),_:2},1024),r(l,{class:"price-group"},{default:c((()=>[r(O,{class:"price-label"},{default:c((()=>[p("尾款")])),_:1}),r(O,{class:"final-price"},{default:c((()=>[p(m(e.fin_amount),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)):(n(),o(l,{key:1},{default:c((()=>[r(l,{class:"price-group"},{default:c((()=>[r(O,{class:"price-label"},{default:c((()=>[p("全款")])),_:1}),r(O,{class:"full-price"},{default:c((()=>[p(m(e.sub_amount+e.fin_amount),1)])),_:2},1024),r(O,{class:"currency"},{default:c((()=>[p("("+m(e.currency)+")",1)])),_:2},1024)])),_:2},1024)])),_:2},1024))])),_:2},1024)])),_:2},1024)])),_:2},1032,["onClick"])))),128))])),_:1}))])),_:1}),r(T,{show:g(P)},null,8,["show"])])),_:1})}}},[["__scopeId","data-v-48d0500a"]]);export{z as default};
