import{h as a,g as e,$ as t,c as l,w as s,C as o,l as c,f as u,o as n,a as i,b as d,t as r,u as m,N as p,v as f,m as _,a9 as h,e as v,E as g,Q as k,i as b,H as y}from"./index-CfMR_IzQ.js";import{_ as w}from"./info-circle.U4M77mlp.js";import{b as x,w as C,i as V}from"./config.BX5UpUDr.js";import{c as j,g as T,u as A}from"./image.C6s062kk.js";import{_ as I}from"./_plugin-vue_export-helper.BCo6x5W8.js";const z=I({__name:"account_book_form",props:["account_book_id"],setup(I){const z=I,E=!!z.account_book_id,F=a();e(F.statusBarHeight);let O=e(""),H=e("");e(1);const P=e(0),S=e(["请选择","娃衣","娃头","眼珠","假发","娃鞋","其它"]);e({});const U=e("");function B(a){P.value=a.detail.value}function D(){j().then((a=>{T().then((e=>{console.log(e),A(a,e.token,e.path).then((a=>{200!=a.statusCode&&_({title:"上传失败",icon:"none"}),console.log(V+e.path),U.value=V+e.path,_({title:"上传成功",icon:"success"})}))}))}))}function G(){E?function(){let a={name:O.value,price:parseInt(H.value,10),type:S.value[P.value],image_url:U.value,id:parseInt(z.account_book_id,10)};c({url:C+"/with-state/update-account-book",method:"POST",header:{Authorization:o("token")},data:a,success:a=>{console.log(a.data),"success"==a.data.status?(_({title:"提交成功",icon:"success"}),setTimeout((()=>{h()}),500)):_({title:a.data.msg,icon:"none"})}})}():function(){let a={name:O.value,price:parseInt(H.value,10),type:S.value[P.value],image_url:U.value};console.log(a),c({url:C+"/with-state/add-account-book",method:"POST",header:{Authorization:o("token")},data:a,success:a=>{console.log(a.data),"success"==a.data.status?(_({title:"提交成功",icon:"success"}),setTimeout((()=>{h()}),500)):_({title:a.data.msg,icon:"none"})}})}()}return x().then((a=>{E?(!function(a){let e=o("token");c({url:C+"/with-state/account-book-detail",method:"GET",header:{Authorization:e},data:{id:a},success:a=>{console.log(a.data.data),O.value=a.data.data.name,H.value=a.data.data.price,P.value=S.value.indexOf(a.data.data.type),U.value=a.data.data.image_url},fail:a=>{console.log(a)}})}(z.account_book_id),t({title:"编辑账本"})):t({title:"新增账本"})})),(a,e)=>{const t=v,o=u,c=g,_=k,h=b,x=y;return n(),l(o,{class:"container"},{default:s((()=>[i(o,{class:"form-card"},{default:s((()=>[i(o,{class:"form-item"},{default:s((()=>[i(t,{class:"form-label"},{default:s((()=>[d("分类")])),_:1}),i(c,{mode:"selector",class:"form-input",value:P.value,range:S.value,onChange:B},{default:s((()=>[i(o,{class:"picker-content"},{default:s((()=>[d(r(S.value[P.value]||"请选择分类"),1)])),_:1})])),_:1},8,["value","range"])])),_:1}),i(o,{class:"form-item"},{default:s((()=>[i(t,{class:"form-label"},{default:s((()=>[d("名称")])),_:1}),i(_,{class:"form-input",type:"text",placeholder:"请输入名称","placeholder-class":"placeholder-style",modelValue:m(O),"onUpdate:modelValue":e[0]||(e[0]=a=>p(O)?O.value=a:O=a)},null,8,["modelValue"])])),_:1}),i(o,{class:"form-item"},{default:s((()=>[i(t,{class:"form-label"},{default:s((()=>[d("价值")])),_:1}),i(_,{class:"form-input",type:"digit",placeholder:"请输入价值","placeholder-class":"placeholder-style",modelValue:m(H),"onUpdate:modelValue":e[1]||(e[1]=a=>p(H)?H.value=a:H=a)},null,8,["modelValue"])])),_:1}),i(o,{class:"form-item"},{default:s((()=>[i(t,{class:"form-label"},{default:s((()=>[d("物品图片")])),_:1}),i(o,{class:"upload-wrapper"},{default:s((()=>[U.value?(n(),l(o,{key:0,class:"preview-image"},{default:s((()=>[i(h,{mode:"aspectFill",src:U.value,class:"image-preview"},null,8,["src"]),i(t,{class:"image-tip"},{default:s((()=>[d("点击更换图片")])),_:1})])),_:1})):(n(),l(x,{key:1,class:"upload-button",onClick:D},{default:s((()=>[i(t,{class:"iconfont icon-camera"}),d(" 选择图片 ")])),_:1}))])),_:1})])),_:1}),i(o,{style:{overflow:"hidden"}},{default:s((()=>[i(h,{src:w,mode:"aspectFill",style:{width:"28rpx",height:"28rpx","margin-right":"10rpx",position:"relative",top:"3rpx"}}),i(t,{style:{color:"#888"}},{default:s((()=>[d("仅用于记录您所购买过的物品，其他人不会看到")])),_:1})])),_:1}),i(o,{class:"button-group"},{default:s((()=>[m(E)?(n(),l(x,{key:0,class:"delete-button",onClick:a.handleDelete},{default:s((()=>[d(" 删除账本 ")])),_:1},8,["onClick"])):f("",!0),i(x,{class:"submit-button",onClick:G},{default:s((()=>[d(" 提交"+r(m(E)?"修改":"新增"),1)])),_:1})])),_:1})])),_:1})])),_:1})}}},[["__scopeId","data-v-3c343996"]]);export{z as default};
