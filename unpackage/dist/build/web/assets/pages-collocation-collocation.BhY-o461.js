import{k as e,a4 as a,a5 as l,o,e as t,d as s,t as n,a as i,w as d,a6 as c,F as u,r as A,a7 as r,T as m,a8 as p,c as g,j as v,b as _,B as f,J as C,g as h,U as k,Q as b,m as B,p as x,q as I,u as w,A as y,i as F,N as Q,O as G,C as E,P as J,f as q}from"./index-D8OtiTi9.js";import{_ as L}from"./_plugin-vue_export-helper.BCo6x5W8.js";import{r as j}from"./uni-app.es.JSb8JX9v.js";import{_ as S,a as O}from"./common-search.DfGi0eV2.js";import{_ as W}from"./right2.s_X9TKoF.js";import{w as D,i as P}from"./config.BPuNpLTQ.js";import{c as T,g as K,u as M}from"./image.I4lmB4WI.js";const U=L({__name:"common-name-picker",props:{dataList:{type:Array,default:()=>[]},placeholder:{type:String,default:"请选择"}},emits:["select"],setup(p,{emit:g}){const v=g,_=e(!1),f=e(""),C=e(null),h=()=>{_.value=!_.value},k=e=>{C.value&&!C.value.contains(e.target)&&(_.value=!1)};return a((()=>{document.addEventListener("click",k)})),l((()=>{document.removeEventListener("click",k)})),(e,a)=>(o(),t("div",{class:"select-container",ref_key:"containerRef",ref:C},[s("div",{class:"select-input",onClick:h},n(f.value||p.placeholder),1),i(m,{name:"slide-fade"},{default:d((()=>[c(s("ul",{class:"select-options"},[(o(!0),t(u,null,A(p.dataList,((e,a)=>(o(),t("li",{key:a,class:"option-item",onClick:a=>(e=>{f.value=e,_.value=!1,v("select",e)})(e)},n(e),9,["onClick"])))),128))],512),[[r,_.value]])])),_:1})],512))}},[["__scopeId","data-v-487f230a"]]),R=L({__name:"custom-picker",props:{dataList:{type:Array,required:!0},margin:{type:String,default:"0"}},emits:["select"],setup(a,{emit:l}){const s=a,c=l,r=e(""),k=e(!1),b=p((()=>s.dataList.filter((e=>e.name.toLowerCase().includes(r.value.toLowerCase()))))),B=()=>{c("select",0,r.value)},x=()=>{k.value=!k.value};return(e,l)=>{const s=C,p=h;return o(),g(p,{class:"custom-select"},{default:d((()=>[i(s,{modelValue:r.value,"onUpdate:modelValue":l[0]||(l[0]=e=>r.value=e),onClick:x,onInput:B,placeholder:"请选择或输入",class:"select-input",style:v({margin:a.margin})},null,8,["modelValue","style"]),i(m,{name:"slide-fade"},{default:d((()=>[k.value?(o(),g(p,{key:0,class:"dropdown"},{default:d((()=>[(o(!0),t(u,null,A(b.value,(e=>(o(),g(p,{key:e.id,onClick:a=>(e=>{r.value=e.name,k.value=!1,c("select",e.id,e.name)})(e),class:"dropdown-item"},{default:d((()=>[_(n(e.name),1)])),_:2},1032,["onClick"])))),128))])),_:1})):f("",!0)])),_:1})])),_:1})}}},[["__scopeId","data-v-66df5e26"]]),V=L({__name:"common-modal",props:{visible:Boolean},emits:["update:visible"],setup(e,{emit:a}){const l=e,t=a,s=()=>{console.log(l.visible),t("update:visible",!1)};return(a,l)=>{const t=h;return o(),g(m,{name:"modal-fade"},{default:d((()=>[e.visible?(o(),g(t,{key:0,class:"modal-mask",onClick:s,catchtouchmove:!0},{default:d((()=>[i(t,{class:"modal-container",onClick:l[0]||(l[0]=k((()=>{}),["stop"]))},{default:d((()=>[i(t,{class:"modal-content"},{default:d((()=>[b(a.$slots,"default",{},void 0,!0)])),_:3})])),_:3})])),_:3})):f("",!0)])),_:3})}}},[["__scopeId","data-v-cba1fff9"]]),N=L({__name:"collocation",props:["goods_id","goods_name","brand_id","brand_name","type"],setup(a){const l=a,s=e([]),c=e([]),r=e([]),m=e(!1),p=e(""),v=e(0),f=e(""),k=e(0),b=e("");function L(e){return new Promise(((a,l)=>{x({url:D+"/goods?id="+e,method:"GET",timeout:5e3,success:e=>{console.log(e.data.data),a(e.data)},fail:e=>{console.log(e),I({title:"网络请求失败",icon:"none"}),l(e)},complete:()=>{w()}})}))}const N=e([]);l.goods_id&&l.goods_name&&l.brand_id&&l.brand_name&&l.type&&L(l.goods_id).then((e=>{let a={brand_id:parseInt(l.brand_id,10),goods_id:parseInt(l.goods_id,10),brand_name:l.brand_name,goods_name:l.goods_name,goods_image:e.data.goods_images[0],type:l.type};console.log(a),N.value.push(a)}));const Z=e(""),X=e("");function Y(e){J({current:s.value[e],urls:s.value})}function z(){const e=y("token");if(!e)return void I({title:"请先登录",icon:"none"});if(!Z.value.trim()||!X.value.trim())return void I({title:"标题和正文不能为空",icon:"none"});if(0===s.value.length)return void I({title:"请至少上传一张图片",icon:"none"});const a={title:Z.value,content:X.value,image_url_list:s.value,relation_data_list:N.value.map((e=>({goods_id:e.goods_id,goods_name:e.goods_name,brand_id:e.brand_id,brand_name:e.brand_name,type:e.type})))};console.log(a),x({url:D+"/with-state/add-collocation",method:"POST",data:a,header:{"Content-Type":"application/json",Authorization:e},timeout:5e3,success:e=>{200===e.data.code?(I({title:"提交成功"}),Z.value="",X.value="",s.value=[],N.value=[]):I({title:e.data.msg||"提交失败",icon:"none"})},fail:e=>{console.log(e),I({title:"网络请求失败",icon:"none"})}})}function H(e,a){console.log("收到品牌ID:",e),console.log("收到品牌Name:",a),v.value=parseInt(e,10),p.value=a,x({url:D+"/goods-name-list?id="+e,method:"GET",timeout:5e3,success:e=>{console.log(e.data.data),c.value=e.data.data,console.log(c.value)},fail:e=>{console.log(e),I({title:"网络请求失败",icon:"none"})}})}function $(e,a){console.log("选中的 id:",e),console.log("选中的 name:",a),k.value=parseInt(e,10),f.value=a}function ee(e){console.log("选中的值:",e),b.value=e,m.value=!0}function ae(){""!=p.value?""!=f.value?L(v.value).then((e=>{let a={brand_id:v.value,goods_id:k.value,brand_name:p.value,goods_name:f.value,goods_image:e.data.goods_images[0],type:b.value};N.value.push(a),m.value=!1,v.value=0,p.value="",k.value=0,f.value="",b.value=""})):I({title:"请选择或填写商品名称",icon:"none"}):I({title:"请选择或填写品牌名称",icon:"none"})}return x({url:D+"/goods-types",method:"GET",timeout:5e3,success:e=>{console.log(e.data.data),r.value=e.data.data},fail:e=>{console.log(e),I({title:"网络请求失败",icon:"none"})}}),(e,a)=>{const l=F,p=h,v=Q,f=C,k=G,b=j(B("common-name-picker"),U),x=q,w=j(B("common-search"),S),y=j(B("custom-picker"),R),J=E,L=j(B("common-modal"),V);return o(),g(p,null,{default:d((()=>[i(v,{"scroll-x":"true",class:"upload_box","ll-with-animation":"true","show-scrollbar":!1},{default:d((()=>[(o(!0),t(u,null,A(s.value,((e,a)=>(o(),g(p,{class:"upload_item",key:a},{default:d((()=>[i(l,{src:e,class:"uploaded_image",onClick:Y,mode:"aspectFill"},null,8,["src"]),i(l,{src:O,class:"close_icon",onClick:e=>function(e){s.value.splice(e,1)}(a)},null,8,["onClick"])])),_:2},1024)))),128)),i(p,{class:"uploadImageBox",style:{background:"#f8f8f8"}},{default:d((()=>[i(l,{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAADDPmHLAAAAAXNSR0IArs4c6QAABIZJREFUeF7tnT2LU0EUhs+JgoWwjR8odouVYKVWWgiCqOA/EPxAxcJmm2RmdUFBd24k2IiNIquFv0DFRlZB7bSy1VIUBX/BNSMXd5cYY+aSuLu59zxp79ecM2/mPO+ZhKvCx3QG1HT0BC8IwLgIEAACMJ4B4+GzAiAA4xkwHj4rAAKwl4FOp7Mnz/PzInJURDap6qKqPmk2m0+tZcPcChBCuCYiM6o61T/ZMcbr3vviuJmPKQFkWXZIRF4Pm11VPdBqtd5ZUYApAYQQ7qjq5WGTG2N87L0/hQBqmIF2u/08xngsEdoP59yWGoY/MCRTK0CWZS9F5HBqcp1zZvJiJtBi0hHA39JHAAOWA1aA1BpZ0eOsAKwAMECfBigBlICKrucjDJsSQAmgBFAC6AP0agAGgAFGKKYVvQQGgAFgABgABoABEiWMVnBFa3xq2DAADAADwAAwAAwAA6xkgEYQjaAUOtXnOBAIBAKBQCAQCAQCgUDgMA3QCawP9/0RCRAIBAKBQCAQCAQCgUAgEPg7A7SCaQXXFPkHhIULwAXgAnABuABcAC4AF4ALwAX8UwPsBdTUGOACcAG4AFwALgAXgAvABeACcAG4ADaDBmsAG4gNNLNLaibQQtP0AegD0AcYtQ8QQphW1bOqeiTGuFtEti3d60OFKsa0iGwuMd4qxbR3KZ7vqvqx2+0u5nm+MDc396lEnOV+EZRlWVNE2mVuyDkTk4GWc+5WajRJBggh7FNVM69QSSWsSsdjjPu99++HjTkpgCzL7onIhSoFzlhXMnDfOXdxXAF8EZEdJLWSGfjqnNs5rgC+9QBfJbNgeNDfnXPbxxJACOGhqp42nMTKhh5jfOS9PzOWAObn5w82Go03lc2C4YF3u91Ds7Ozb8cSQHFxCOGGql4xnMvKhR5jvOm9v5oaeNIFLN+gsIMicq5oBIlI0Qja0HPzz6kHTcjxrcW7gkuMpSrx7OqJ5aeIfBSRFzHGhZT9W76utABKJG3iT2Ev4O8pQgADZMt28MR/l0cbICsAKwC7gX0aoARQAkZbTqt4FSWAEkAJoATwx5BeDcAAMEAVq/loY4YBYAAYAAaAAWCARAWhFTxaiZ34q2AAGAAGgAFgABgABljJAI0gGkETz27/bYBAIBAIBAKBQCAQCAQCgcM0QCfwv2HXZN0ICAQCgUAgEAgEAoFAIBAI/J0BWsG0gieL1FdzNLgAXAAuABeAC8AF4AJwAbgAXMA/NcBewGqi+DreGxeAC8AF4AJwAbgAXAAuABeAC8AFsBk0WAPYwHW0aqv5aGwgNhAbiA3EBmIDsYE2bWAI4ZmqnkjMf/I1K6vJKWt9b2s/CbstIjOJJD9wzp1f64lYr+eZEkC73S7eevpiWLIbjcbJZrP5dL0mZK2fa0oARXJDCNeKVUBVp/qTHWO87r0vjpv5mBNAMbOdTmdPnueXROS4iGwUkVeqerfVapl7Q6pJAZj5epcIFAGUSFKdT0EAdZ7dErEhgBJJqvMpCKDOs1siNgRQIkl1PgUB1Hl2S8SGAEokqc6n/AJ5Xg2fcRh8dAAAAABJRU5ErkJggg==",class:"upload_img",onClick:a[0]||(a[0]=a=>(e.index,console.log("openSelect"),void T().then((e=>{K().then((a=>{console.log(a),M(e,a.token,a.path).then((e=>{200!=e.statusCode&&I({title:"上传失败",icon:"none"}),console.log(P+a.path),s.value.push(P+a.path),I({title:"上传成功",icon:"success"})}))}))})))),style:{width:"50px",height:"50px",margin:"25px"}})])),_:1})])),_:1}),i(f,{modelValue:Z.value,"onUpdate:modelValue":a[1]||(a[1]=e=>Z.value=e),type:"text",placeholder:"请输入标题",style:{padding:"10px",margin:"20px 15px 5px 15px",display:"block"}},null,8,["modelValue"]),i(p,{class:"oneLine"}),i(k,{modelValue:X.value,"onUpdate:modelValue":a[2]||(a[2]=e=>X.value=e),placeholder:"请输入正文",style:{padding:"10px",margin:"10px 15px 5px 15px",display:"block","line-height":"28px",width:"calc(100% - 50px)"}},null,8,["modelValue"]),i(p,{class:"oneLine"}),i(p,{class:""},{default:d((()=>[i(p,{style:{display:"flex",padding:"10px 15px"}},{default:d((()=>[i(b,{dataList:r.value,placeholder:"关联娃物",onSelect:ee},null,8,["dataList"]),i(l,{src:W,style:{width:"20px",height:"20px",margin:"10px"},mode:"aspectFill"})])),_:1})])),_:1}),i(p,{class:"saveCollocationDataList"},{default:d((()=>[(o(!0),t(u,null,A(N.value,((e,a)=>(o(),g(p,{key:a},{default:d((()=>[i(p,{class:"saveCollocationDataItem"},{default:d((()=>[i(l,{src:e.goods_image,mode:"aspectFill",style:{width:"70px",height:"70px"}},null,8,["src"]),i(x,{style:{width:"calc(100% - 120px)",display:"inline-block"}},{default:d((()=>[_(n(e.type)+" "+n(e.brand_name)+" - "+n(e.goods_name),1)])),_:2},1024),i(l,{src:O,class:"close_icon",onClick:e=>function(e){N.value.splice(e,1)}(a)},null,8,["onClick"])])),_:2},1024)])),_:2},1024)))),128))])),_:1}),i(L,{visible:m.value,"onUpdate:visible":a[3]||(a[3]=e=>m.value=e)},{default:d((()=>[i(p,{class:"selectTab",style:{border:"1px sold #b2b0b4"}},{default:d((()=>[i(w,{mode:"fill",onSelect:H,width:"calc(100vw - 120px)"}),i(y,{dataList:c.value,onSelect:$,margin:"10px 0 0 8px"},null,8,["dataList"]),i(J,{onClick:ae,style:{"margin-top":"20px","background-color":"#fff"}},{default:d((()=>[_("确认")])),_:1})])),_:1})])),_:1},8,["visible"]),i(p,{class:"footer"},{default:d((()=>[i(J,{onClick:z},{default:d((()=>[_("提交")])),_:1})])),_:1})])),_:1})}}},[["__scopeId","data-v-908aaec9"]]);export{N as default};
