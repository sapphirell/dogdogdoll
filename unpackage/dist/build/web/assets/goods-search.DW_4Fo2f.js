import{r as e,k as a,N as s,b as l,v as t,c as o,p as n,d as u,w as r,a0 as d,D as c,F as i,x as m,e as p,t as v,q as f,n as g,g as _,i as y,M as h,f as k,S}from"./index-BFzTDSoz.js";import{_ as b}from"./search.CsIL0f2m.js";import{_ as j}from"./cancel.CnEdunnH.js";import{w}from"./view-logs.yEAac7W9.js";import{_ as C}from"./_plugin-vue_export-helper.CXFOpRdI.js";const I=C({__name:"goods-search",props:{modelValue:{type:String,default:""},width:{type:String,default:"100%"},background:{type:String,default:""},fontSize:{type:String,default:""},tagColor:{type:String,default:"#666"},mode:{type:String,default:"jump",validator:e=>["jump","fill"].includes(e)},hiddenIcon:{type:Boolean,default:!0}},emits:["select","update:modelValue"],setup(C,{emit:I}){const x=e(!1),V=C,z=I,$=e([]),B=a({get:()=>V.modelValue,set:e=>z("update:modelValue",e)});s($,(e=>{x.value=e.length>0}));const q=()=>{$.value=[],x.value=!1},A=async e=>{var a;B.value=e.detail.value;const s=e.detail.value.trim();if(x.value=!0,s)try{const e=await f({url:w+`/search-goods?search=${encodeURIComponent(s)}`,method:"GET"});$.value="success"===(null==(a=e.data)?void 0:a.status)&&e.data.data||[]}catch(l){console.error("搜索失败:",l),$.value=[]}else $.value=[]},D=()=>{q()};return(e,a)=>{const s=_,f=y,w=h,I=k,E=S;return l(),t(i,null,[x.value?(l(),o(s,{key:0,class:"mask-layer",onClick:q})):n("",!0),u(s,{class:c(["search_tab",e.$attrs.class]),style:d({background:C.background||"#fff"})},{default:r((()=>[C.hiddenIcon?n("",!0):(l(),o(f,{key:0,class:"icon_image",src:b})),u(w,{class:"common_search_input",placeholder:"请输入娃物名称 (ㅇㅅㅇ❀)...",value:B.value,onInput:A,style:d({fontSize:C.fontSize||"22rpx"})},null,8,["value","style"]),$.value.length>0?(l(),o(f,{key:1,class:"icon_image",src:j,onClick:D})):n("",!0)])),_:1},8,["class","style"]),$.value.length>0?(l(),o(E,{key:1,class:"search_results",style:d({width:C.width}),"scroll-y":""},{default:r((()=>[(l(!0),t(i,null,m($.value,(e=>(l(),o(s,{key:e.id,class:"result_item",onClick:a=>{return s=e,"jump"===V.mode&&g({url:`/pages/goods/goods?goods_id=${s.id}`}),"fill"===V.mode&&(z("select",s),B.value=s.name,$.value=[]),void q();var s}},{default:r((()=>[e.brand_name?(l(),o(s,{key:0,class:"brand-tag"},{default:r((()=>[p(v(e.brand_name),1)])),_:2},1024)):n("",!0),u(I,{class:"goods-name"},{default:r((()=>[p(v(e.name),1)])),_:2},1024)])),_:2},1032,["onClick"])))),128))])),_:1},8,["style"])):n("",!0)],64)}}},[["__scopeId","data-v-a4ee91e3"]]);export{I as _};
