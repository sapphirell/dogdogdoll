import{g as e,h as a,q as s,s as l,k as t,m as o,c,w as d,l as r,v as n,o as u,a as i,Y as f,d as _,r as g,F as p,y as m,b as y,t as k,f as h,S as b,e as v,i as w,x as S,z as j,n as x}from"./index-B55GPRQF.js";import{_ as C}from"./common-search.OBIzXxZ7.js";import{o as $,r as D}from"./uni-app.es.CzHle-z4.js";import{_ as F}from"./common-page.Bgp-g0xT.js";import{w as O}from"./config.BIUptOrH.js";import{_ as z}from"./_plugin-vue_export-helper.BCo6x5W8.js";import"./search.CsIL0f2m.js";import"./cancel.CnEdunnH.js";const H=z({__name:"calendar",setup(z){const H=e(["全部","整体","单头","单体","娃衣","眼珠","娃鞋","手型","脚型","袜子","配饰"]);let M=e("全部"),T=e({}),Y=e({});const E=new Date,G=`${E.getFullYear()}-${String(E.getMonth()+1).padStart(2,"0")}-${String(E.getDate()).padStart(2,"0")}`,I=e(null),q=a(),A=q.screenWidth/7;let B=e(0);e(q.statusBarHeight);let K=e(G),P=e({});function V(){r({url:O+"/goods-news",method:"GET",timeout:5e3,success:e=>{console.log(e.data.data),T.value=e.data.data,Y.value=W("全部");for(let[a,s]of Object.entries(Y.value))a===G&&(P.value=s)},fail:e=>{console.log(e),t({title:"网络请求失败",icon:"none"})},complete:()=>{B.value=7*A-5,console.log("left:"+B.value),n()}})}function W(e){const a={};return Object.entries(T.value).forEach((([s,l])=>{const t={...l};t.goods&&(t.goods="全部"===e?t.goods:t.goods.filter((a=>a.type===e)),0===t.goods.length&&(t.goods=null)),a[s]=t})),a}s({title:"加载中"});function J(e){const a=new Date(1e3*e);a.getFullYear();return`${(a.getMonth()+1).toString().padStart(2,"0")}-${a.getDate().toString().padStart(2,"0")} ${a.getHours().toString().padStart(2,"0")}:${a.getMinutes().toString().padStart(2,"0")}`}return V(),$((async()=>{try{V(),l()}catch(e){l(),t({title:"刷新失败",icon:"none"})}})),(e,a)=>{const s=D(o("common-search"),C),l=h,t=b,n=v,$=w,z=D(o("common-page"),F);return u(),c(z,{head_color:"rgb(185 195 253)"},{default:d((()=>[i(l,{class:"header-container"},{default:d((()=>[i(l,{class:"search-container",style:f("")},{default:d((()=>[i(s,{width:"560rpx"})])),_:1},8,["style"]),i(l,{class:"category-container"},{default:d((()=>[i(t,{"scroll-x":"true",class:"category-scroll","show-scrollbar":!1},{default:d((()=>[(u(!0),_(p,null,g(H.value,((e,a)=>(u(),c(l,{class:S(["category-item",{active:m(M)===e}]),key:a,onClick:a=>(e=>{M.value=e;const a=W(e);Y.value={...a};const s=Object.entries(a).find((([e,a])=>a.goods));s?(K.value=s[0],P.value=s[1]):P.value={goods:null}})(e)},{default:d((()=>[y(k(e),1)])),_:2},1032,["class","onClick"])))),128))])),_:1})])),_:1})])),_:1}),i(l,{class:"date-picker-container"},{default:d((()=>[i(t,{class:"date-scroll","scroll-x":"true",ref_key:"scrollView",ref:I,"scroll-left":m(B),"show-scrollbar":!1},{default:d((()=>[(u(!0),_(p,null,g(m(Y),((e,a)=>(u(),c(l,{key:e.id,class:"date-item",onClick:s=>function(e,a){console.log(a),K.value=e,P.value=a}(a,e)},{default:d((()=>[e.goods_number>0?(u(),c(l,{key:0,class:"date-badge"},{default:d((()=>[y(k(e.goods_number),1)])),_:2},1024)):j("",!0),i(l,{class:S(["weekday",{weekend:"周日"===e.weekday||"周六"===e.weekday}])},{default:d((()=>[y(k(e.weekday),1)])),_:2},1032,["class"]),i(l,{class:S(["day-number",{selected:m(K)===a}])},{default:d((()=>[y(k(e.day_number),1)])),_:2},1032,["class"])])),_:2},1032,["onClick"])))),128))])),_:1},8,["scroll-left"])])),_:1}),i(l,{class:"goods-container"},{default:d((()=>[i(l,{class:"date-title"},{default:d((()=>[i(n,{class:"highlight"},{default:d((()=>[y(k(m(K))+" 日",1)])),_:1}),i(n,null,{default:d((()=>[y(" 星期"+k(m(P).weekday)+"上新",1)])),_:1})])),_:1}),null==m(P).goods?(u(),c(l,{key:0,class:"empty-tip"},{default:d((()=>[i($,{src:"/static/empty-box.png",class:"empty-icon"}),i(n,null,{default:d((()=>[y("这天没有上新呢...")])),_:1})])),_:1})):(u(),c(l,{key:1},{default:d((()=>[(u(!0),_(p,null,g(m(P).goods,(e=>(u(),c(l,{key:e.id,class:"goods-card",onClick:a=>{return s=e.id,l=e.goods_id,r({url:O+"/sale-record-click?id="+s,method:"POST",header:{"Content-Type":"application/json"},success:()=>{console.log("点击记录成功")},fail:e=>{console.error("点击记录失败:",e)}}),void x({url:"/pages/goods/goods?goods_id="+l});var s,l}},{default:d((()=>[i(l,{class:"goods-image-container"},{default:d((()=>[i($,{src:e.goods_image,mode:"aspectFill",class:"goods-image"},null,8,["src"]),i(l,{class:"goods-tags"},{default:d((()=>[i(n,{class:"tag sale-type"},{default:d((()=>[y(k(e.sale_type),1)])),_:2},1024),1==e.is_first_sale_day?(u(),c(n,{key:0,class:"tag first-day"},{default:d((()=>[y("首日")])),_:1})):j("",!0)])),_:2},1024)])),_:2},1024),i(l,{class:"goods-info"},{default:d((()=>[i(l,null,{default:d((()=>[i(n,{class:"brand-name"},{default:d((()=>[y(k(e.brand_name),1)])),_:2},1024),i(n,{class:"goods-name"},{default:d((()=>[y(k(e.goods_name),1)])),_:2},1024)])),_:2},1024),i(l,{class:"goods-details"},{default:d((()=>[i(n,null,{default:d((()=>[y(k(e.size)+" · "+k(e.size_detail)+" · "+k(e.type),1)])),_:2},1024)])),_:2},1024),i(l,{class:"time-info"},{default:d((()=>[i(n,null,{default:d((()=>[y("开定 "+k(J(e.sub_time)),1)])),_:2},1024),e.sub_time_end?(u(),c(n,{key:0},{default:d((()=>[y("截止 "+k(J(e.sub_time_end)),1)])),_:2},1024)):j("",!0)])),_:2},1024),i(l,{class:"price-info"},{default:d((()=>["限量现货"!=e.sale_type&&"不限量现货"!=e.sale_type?(u(),c(l,{key:0},{default:d((()=>[i(l,{class:"price-group"},{default:d((()=>[i(n,{class:"price-label"},{default:d((()=>[y("定金")])),_:1}),i(n,{class:"deposit-price"},{default:d((()=>[y(k(e.sub_amount),1)])),_:2},1024),i(n,{class:"currency"},{default:d((()=>[y("("+k(e.currency)+")",1)])),_:2},1024)])),_:2},1024),i(l,{class:"price-group"},{default:d((()=>[i(n,{class:"price-label"},{default:d((()=>[y("尾款")])),_:1}),i(n,{class:"final-price"},{default:d((()=>[y(k(e.fin_amount),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)):(u(),c(l,{key:1},{default:d((()=>[i(l,{class:"price-group"},{default:d((()=>[i(n,{class:"price-label"},{default:d((()=>[y("全款")])),_:1}),i(n,{class:"full-price"},{default:d((()=>[y(k(e.sub_amount+e.fin_amount),1)])),_:2},1024),i(n,{class:"currency"},{default:d((()=>[y("("+k(e.currency)+")",1)])),_:2},1024)])),_:2},1024)])),_:2},1024))])),_:2},1024)])),_:2},1024)])),_:2},1032,["onClick"])))),128))])),_:1}))])),_:1})])),_:1})}}},[["__scopeId","data-v-a1e299fc"]]);export{H as default};
