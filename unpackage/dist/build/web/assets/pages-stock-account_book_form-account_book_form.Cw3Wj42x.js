import{l as a,k as e,V as t,c as l,w as o,A as s,p as u,g as n,o as c,a as i,b as d,t as r,v as p,G as m,B as v,q as _,a2 as h,f,y as g,J as k,i as b,C as y}from"./index-D8OtiTi9.js";import{a as V,w as x,i as w}from"./config.BPuNpLTQ.js";import{c as C,g as T,u as j}from"./image.I4lmB4WI.js";import{_ as A}from"./_plugin-vue_export-helper.BCo6x5W8.js";const I=A({__name:"account_book_form",props:["account_book_id"],setup(A){const I=A,z=!!I.account_book_id,O=a();e(O.statusBarHeight);let q=e(""),B=e("");e(1);const G=e(0),P=e(["请选择","娃衣","娃头","眼珠","假发","娃鞋","其它"]);e({});const S=e("");function U(a){G.value=a.detail.value}function E(){C().then((a=>{T().then((e=>{console.log(e),j(a,e.token,e.path).then((a=>{200!=a.statusCode&&_({title:"上传失败",icon:"none"}),console.log(w+e.path),S.value=w+e.path,_({title:"上传成功",icon:"success"})}))}))}))}function F(){z?function(){let a={name:q.value,price:parseInt(B.value,10),type:P.value[G.value],image_url:S.value,id:parseInt(I.account_book_id,10)};u({url:x+"/with-state/update-account-book",method:"POST",header:{Authorization:s("token")},data:a,success:a=>{console.log(a.data),"success"==a.data.status?(_({title:"提交成功",icon:"success"}),setTimeout((()=>{h()}),500)):_({title:a.data.msg,icon:"none"})}})}():function(){let a={name:q.value,price:parseInt(B.value,10),type:P.value[G.value],image_url:S.value};console.log(a),u({url:x+"/with-state/add-account-book",method:"POST",header:{Authorization:s("token")},data:a,success:a=>{console.log(a.data),"success"==a.data.status?(_({title:"提交成功",icon:"success"}),setTimeout((()=>{h()}),500)):_({title:a.data.msg,icon:"none"})}})}()}return V().then((a=>{z?(!function(a){let e=s("token");u({url:x+"/with-state/account-book-detail",method:"GET",header:{Authorization:e},data:{id:a},success:a=>{console.log(a.data.data),q.value=a.data.data.name,B.value=a.data.data.price,G.value=P.value.indexOf(a.data.data.type),S.value=a.data.data.image_url},fail:a=>{console.log(a)}})}(I.account_book_id),t({title:"编辑账本"})):t({title:"新增账本"})})),(a,e)=>{const t=f,s=n,u=g,_=k,h=b,V=y;return c(),l(s,{style:{padding:"15px"}},{default:o((()=>[i(s,null,{default:o((()=>[i(t,null,{default:o((()=>[d("分类")])),_:1}),i(u,{mode:"selector",class:"inputer",value:G.value,range:P.value,onChange:U},{default:o((()=>[i(s,{class:"uni-input"},{default:o((()=>[d(r(P.value[G.value]),1)])),_:1})])),_:1},8,["value","range"])])),_:1}),i(_,{class:"inputer",type:"text",placeholder:"名称",modelValue:p(q),"onUpdate:modelValue":e[0]||(e[0]=a=>m(q)?q.value=a:q=a)},null,8,["modelValue"]),i(_,{class:"inputer",type:"digit",placeholder:"价值",modelValue:p(B),"onUpdate:modelValue":e[1]||(e[1]=a=>m(B)?B.value=a:B=a)},null,8,["modelValue"]),S.value?(c(),l(s,{key:0},{default:o((()=>[i(h,{mode:"aspectFill",src:S.value},null,8,["src"])])),_:1})):v("",!0),i(V,{class:"",onClick:E},{default:o((()=>[d("选择图片")])),_:1}),i(V,{class:"light_button",onClick:F},{default:o((()=>[d("提交")])),_:1})])),_:1})}}},[["__scopeId","data-v-410d006e"]]);export{I as default};
