import{r as e,o as a,a as l,b as s,c as t,w as o,d as n,e as i,n as c,s as u,i as d,f as r,g as _,h as f,j as p,k as v,l as g,m,t as h,p as y,q as b,u as k,S as w,v as x,F as C,x as L,y as z,z as F,A as S,B as D,C as T,D as j,E as $,G as B,H as U,I as A,J as E}from"./index-I3aG4WZL.js";import{_ as I}from"./view-logs.C4HVuFxK.js";import{_ as G,r as J,o as O,a as V,b as H}from"./_plugin-vue_export-helper.DF4WgY5m.js";import{_ as M}from"./uni-icons.BQtdpjJ2.js";import{_ as q,a as K}from"./common-modal.-arcCNZ3.js";import{g as N,w as Y,d as Z,a as P,b as Q}from"./config.BjeWXQ7P.js";import{_ as R}from"./loading-toast.B-pFXU1z.js";import{_ as W}from"./switch-search.B16f2bGk.js";import{_ as X}from"./common-search.CQlKpRi4.js";import"./goods-search.gE0Nx2pd.js";import"./search.CsIL0f2m.js";import"./cancel.CnEdunnH.js";const ee=G({__name:"privacy-permission-modal",setup(v){const g=e(!1),m=()=>{if((()=>{let e=p("privacyAgreementStatus");return console.log(e),"agreed"===e})())return void console.log("用户已经同意过隐私政策");const e=N();2===e||3===e?setTimeout((()=>{g.value=!0}),1e3):console.log("并非安卓或iOS客户端：",e)},h=()=>{c({url:"/pages/private/private"})},y=()=>{c({url:"/pages/permission/permission"})},b=()=>{u("privacyAgreementStatus","agreed"),g.value=!1},k=()=>{uni.exitApp()};return a((()=>{m()})),(e,a)=>{const c=d,u=r,p=_,v=J(l("uni-icons"),M),m=f,w=J(l("common-modal"),q);return s(),t(w,{visible:g.value,"onUpdate:visible":a[0]||(a[0]=e=>g.value=e),top:"20vh",height:"auto",closeable:!1},{default:o((()=>[n(p,{class:"privacy-container"},{default:o((()=>[n(p,{class:"header"},{default:o((()=>[n(c,{src:"/assets/write-B8BOxNp9.gif",class:"logo"}),n(u,{class:"title"},{default:o((()=>[i("隐私与权限说明")])),_:1})])),_:1}),n(p,{class:"content"},{default:o((()=>[n(u,{class:"desc"},{default:o((()=>[i("欢迎使用我们的应用，为了提供更好的服务，我们需要获取相关权限并说明隐私政策：")])),_:1}),n(p,{class:"policy-item",onClick:h},{default:o((()=>[n(v,{type:"info",size:"18",color:"#80afff"}),n(u,{class:"policy-text"},{default:o((()=>[i("《隐私政策》")])),_:1}),n(v,{type:"arrowright",size:"16",color:"#999"})])),_:1}),n(p,{class:"policy-item",onClick:y},{default:o((()=>[n(v,{type:"locked",size:"18",color:"#80afff"}),n(u,{class:"policy-text"},{default:o((()=>[i("《权限说明》")])),_:1}),n(v,{type:"arrowright",size:"16",color:"#999"})])),_:1})])),_:1}),n(p,{class:"footer"},{default:o((()=>[n(m,{class:"btn refuse",onClick:k},{default:o((()=>[i("拒绝并退出")])),_:1}),n(m,{class:"btn agree",onClick:b},{default:o((()=>[i("同意并继续")])),_:1})])),_:1})])),_:1})])),_:1},8,["visible"])}}},[["__scopeId","data-v-5c8d13a8"]]),ae=G({__name:"version-check",props:{showUpToDateToast:{type:Boolean,default:!1},currentVersion:{type:String,required:!1},autoCheck:{type:Boolean,default:!0}},setup(c,{expose:d}){const x=c,C=e(!1),L=e(null),z=e(!1),F=e("1.0.0"),S=v((()=>g().platform||"unknown")),D=e=>{if(!e)return"未知日期";const a=new Date(1e3*e);return`${a.getFullYear()}-${(a.getMonth()+1).toString().padStart(2,"0")}-${a.getDate().toString().padStart(2,"0")}`},T=async()=>{try{let e=N();if(1===e||4===e)return void console.log("scene:",e);if((()=>{const e=p("ignoreUpdateTime");if(console.log("忽略时间：",e),!e)return!1;const a=Date.now();return console.log("当前时间",a),a-e<2592e5})())return void console.log("在忽略期内，不显示更新提示 ");m().appVersion;const a=await b({url:`${Y}/latest-version?version=${Z}`,method:"GET"});a&&a.data&&("success"===a.data.status&&a.data.data?(L.value=a.data.data,C.value=!0):"failed"===a.data.status&&x.showUpToDateToast&&(z.value=!0,setTimeout((()=>{z.value=!1}),2e3)))}catch(e){console.error("版本检查失败:",e)}},j=()=>{u("ignoreUpdateTime",Date.now()),C.value=!1;const e=S.value.toLowerCase();console.log(e);let a=N();2===a||3===a?plus.runtime.openURL("https://apps.apple.com/app/id6747564362"):k({title:"更新提示",content:"请前往应用商店更新最新版本",showCancel:!1})},$=()=>{u("ignoreUpdateTime",Date.now()),C.value=!1};return d({checkVersion:T}),a((()=>{F.value=m().appVersion,x.autoCheck&&setTimeout((()=>{T()}),1500)})),(e,a)=>{const c=_,u=w,d=f,p=J(l("common-modal"),q),v=r;return s(),t(c,null,{default:o((()=>[n(p,{visible:C.value,"onUpdate:visible":a[0]||(a[0]=e=>C.value=e),top:"15vh"},{default:o((()=>[n(c,{class:"version-update-container"},{default:o((()=>[n(c,{class:"update-title"},{default:o((()=>{var e;return[i("发现新版本 v"+h(null==(e=L.value)?void 0:e.version)+" 当前 v"+h(),1)]})),_:1}),n(u,{class:"update-content","scroll-y":""},{default:o((()=>[n(c,{class:"update-section"},{default:o((()=>[n(c,{class:"section-title"},{default:o((()=>[i("更新内容")])),_:1}),n(c,{class:"section-content"},{default:o((()=>{var e;return[i(h((null==(e=L.value)?void 0:e.note)||"优化用户体验，修复已知问题"),1)]})),_:1})])),_:1}),n(c,{class:"update-section"},{default:o((()=>[n(c,{class:"section-title"},{default:o((()=>[i("更新日期")])),_:1}),n(c,{class:"section-content"},{default:o((()=>{var e;return[i(h(D(null==(e=L.value)?void 0:e.created_at)),1)]})),_:1})])),_:1})])),_:1}),n(c,{class:"update-buttons"},{default:o((()=>[n(d,{class:"update-btn ignore",onClick:$},{default:o((()=>[i("暂不更新")])),_:1}),n(d,{class:"update-btn confirm",onClick:j},{default:o((()=>[i("立即更新")])),_:1})])),_:1})])),_:1})])),_:1},8,["visible"]),z.value?(s(),t(c,{key:0,class:"toast-message"},{default:o((()=>[n(v,null,{default:o((()=>[i("已是最新版本")])),_:1})])),_:1})):y("",!0)])),_:1})}}},[["__scopeId","data-v-bbeb0234"]]),le=G({__name:"index-brand",props:["brand","key"],setup(e){const a=e;function l(){c({url:"/pages/brand/brand?brand_id="+a.brand.id})}return(a,u)=>{const f=d,p=r,v=_,g=w;return s(),t(v,{class:"brand-card",key:e.key},{default:o((()=>[n(v,{class:"brand-header",onClick:l},{default:o((()=>[e.brand.logo_image?(s(),t(f,{key:0,class:"brand-logo",src:e.brand.logo_image,mode:"aspectFit"},null,8,["src"])):(s(),t(v,{key:1,class:"brand-logo",style:{background:"linear-gradient(180deg, #d8c1b3 0%, #d3f5ff 100%)","align-items":"center"}},{default:o((()=>[n(p,{style:{color:"rgb(255, 255, 255)","font-size":"100rpx",display:"block","text-align":"center"}},{default:o((()=>[i("?")])),_:1})])),_:1})),n(v,{class:"brand-meta"},{default:o((()=>[n(v,{class:"title-row"},{default:o((()=>[n(f,{src:e.brand.brand_name_image,mode:"heightFix",style:{height:"40rpx"}},null,8,["src"]),n(p,{class:"brand-tag"},{default:o((()=>[i(h(e.brand.country_name)+"·"+h(e.brand.type),1)])),_:1}),n(p,{class:"goods-count"},{default:o((()=>[i("收录"+h(e.brand.total_goods)+"款",1)])),_:1})])),_:1}),n(p,{class:"brand-desc"},{default:o((()=>[i(h(e.brand.description),1)])),_:1})])),_:1})])),_:1}),n(g,{class:"goods-scroll","scroll-x":"","show-scrollbar":!1},{default:o((()=>[n(v,{class:"goods-list"},{default:o((()=>[(s(!0),x(C,null,L(e.brand.goods,((e,a)=>(s(),t(v,{class:"goods-item",key:e.id,onClick:a=>{return l=e.id,void c({url:"/pages/goods/goods?goods_id="+l});var l}},{default:o((()=>[n(f,{class:"goods-image",src:e.goods_images&&e.goods_images[0],mode:"aspectFill"},null,8,["src"]),n(p,{class:"goods-name"},{default:o((()=>[i(h(e.name),1)])),_:2},1024)])),_:2},1032,["onClick"])))),128))])),_:1})])),_:1})])),_:1})}}},[["__scopeId","data-v-3290f0de"]]),se=G({__name:"index",setup(a){z((e=>({"7e410270":xe.value})));let u=e([]),f=e({}),m=e(""),w=e(!1);const G=e([{label:"中国娃社",value:1},{label:"个人作者",value:2},{label:"外国娃社",value:3}]),q=e(1);e(0);const N=g();e(0);const Z=e(1),se=e(10),te=e(!0),oe=e(!1);let ne=e([]);const ie=e(1),ce=e(10),ue=e(!0),de=e(!1);let re=e([]);const _e=e(1),fe=e(10),pe=e(!0),ve=e(!1);let ge=e([]);const me=e(1),he=e(10),ye=e(!0),be=e(!1),ke=e("news"),we=e=>{ke.value=e};v((()=>0));const xe=v((()=>`${N.statusBarHeight||0}px`));O((async()=>{try{await Ce(),F()}catch(e){F(),S({title:"刷新失败",icon:"none"})}}));const Ce=async()=>{w.value=!0,setTimeout((async()=>{const e={brands:()=>{Z.value=1,u.value=[],te.value=!0,Fe(!0)},news:()=>{ie.value=1,ne.value=[],ue.value=!0,Le(!0)},hot:()=>{_e.value=1,re.value=[],pe.value=!0,ze(!0)},second:()=>{me.value=1,ge.value=[],ye.value=!0,Se(!0)}};await e[ke.value]()}),800)};const Le=async(e=!1)=>{e&&(ie.value=1),ue.value&&!de.value&&(de.value=!0,w.value=!0,b({url:Y+"/sale-news",data:{page:ie.value,pageSize:ce.value},success:e=>{const a=e.data.data.news_list.map((e=>({...e,imagesLoaded:!1,loadCount:0})));0!==a.length?(ne.value=[...ne.value,...a],ue.value=e.data.data.news_list.length===ce.value,ie.value++):ue.value=!1},fail:e=>{console.log(e),S({title:"加载失败",icon:"none"})},complete:()=>{de.value=!1,w.value=!1}}))};const ze=async(e=!1)=>{e&&(_e.value=1),pe.value&&!ve.value&&(ve.value=!0,w.value=!0,b({url:Y+"/hot-collocation",data:{page:_e.value,pageSize:fe.value},success:e=>{const a=e.data.data.collocation_relation_list;0!==a.length?(re.value=[...re.value,...a.map((e=>({...e})))],pe.value=re.value.length<e.data.data.total,_e.value++):pe.value=!1},fail:e=>{console.log(e),S({title:"加载失败",icon:"none"})},complete:()=>{ve.value=!1,w.value=!1}}))};const Fe=async(e=!1)=>{if(e&&(Z.value=1,u.value=[],te.value=!0,m.value=""),!te.value||oe.value)return;oe.value=!0,w.value=!0;const a={pageSize:se.value};m.value?a.cursor=m.value:q.value&&(a.searchType=q.value),b({url:Y+"/brands-info-list",data:a,success:e=>{if("success"!==e.data.status)return void S({title:"加载失败: "+e.data.message,icon:"none"});const a=e.data.data,l=a.data;console.log("newData:",l),m.value=a.next_cursor||"",0!==l.length?(u.value=[...u.value,...l],te.value=a.has_more):te.value=!1},fail:e=>{console.log(e),S({title:"网络请求失败",icon:"none"})},complete:()=>{oe.value=!1,w.value=!1}})},Se=async(e=!1)=>{e&&(me.value=1),ye.value&&!be.value&&(be.value=!0,w.value=!0,b({url:Y+"/treehole-submissions",data:{page:me.value,pageSize:he.value},success:e=>{const a=e.data.data.submission_list.map((e=>({...e,images:e.images||[],imagesLoaded:!1,loadCount:0})));0!==a.length?(ge.value=[...ge.value,...a],ye.value=ge.value.length<e.data.data.total,me.value++):ye.value=!1},fail:e=>{S({title:"加载失败",icon:"none"})},complete:()=>{be.value=!1,w.value=!1}}))};function De(){Q.isLogin?c({url:"/pages/treehole_publish/treehole_publish"}):k({title:"提示",content:"需要登录后才能发布树洞",success:e=>{e.confirm&&c({url:"/pages/login/login"})}})}const Te=e=>{const a=new Date(1e3*e);return`${a.getFullYear()}-${a.getMonth()+1}-${a.getDate()}`};return V((()=>{P(),Fe(),Le(),ze(),Se(),b({url:Y+"/articles",data:{page:1,page_size:10,status:1},success:e=>{"success"===e.data.status&&(f.value=e.data.data.list)},fail:e=>{console.error("获取Banner失败:",e),f.value={}}})})),H((()=>{"brands"===ke.value&&te.value?Fe():"news"===ke.value&&ue.value?Le():"second"===ke.value&&ye.value&&Se()})),(e,a)=>{const v=J(l("view-logs"),I),g=J(l("privacy-permission-modal"),ee),k=J(l("version-check"),ae),z=J(l("loading-toast"),R),F=_,O=d,V=J(l("switch-search"),W),H=r,N=$,P=B,se=J(l("uni-icons"),M),ie=J(l("uni-transition"),K),ce=J(l("common-search"),X),_e=J(l("index-brand"),le);return s(),x(C,null,[D("meta",{name:"theme-color",content:"#def9ff"}),n(v),n(F,null,{default:o((()=>[n(g),n(k,{"show-up-to-date-toast":!0}),n(z,{show:T(w)},null,8,["show"]),n(v),n(F,{class:"body"},{default:o((()=>[n(F,{class:"index_header"},{default:o((()=>[n(F,{class:"header-placeholders"}),n(F,null,{default:o((()=>[n(F,{style:{display:"inline-block","margin-left":"20rpx"}},{default:o((()=>[n(O,{src:"/assets/title-CZ7i4fDk.gif",mode:"widthFix",style:{width:"400rpx","max-height":"180rpx",position:"relative",left:"-20rpx","margin-bottom":"10rpx"}})])),_:1}),n(V,{onSelect:e.handleSearchSelect,mode:"jump",width:"95%",background:"#f8f8f8"},null,8,["onSelect"])])),_:1}),n(F,{style:{margin:"20rpx 0rpx 0rpx 0rpx",padding:"5px 10px 0px 10px","border-radius":"20px 20px 0 0"}},{default:o((()=>[n(F,{class:"index_page_article"},{default:o((()=>[n(F,{class:j(["swich_box",{active:"news"===ke.value}]),onClick:a[0]||(a[0]=e=>we("news"))},{default:o((()=>[n(O,{src:"/assets/telphone-wL0f-8us.gif",mode:"aspectFill"}),n(H,{class:"font-cute"},{default:o((()=>[i("新情报！")])),_:1})])),_:1},8,["class"]),n(F,{class:j(["swich_box",{active:"brands"===ke.value}]),onClick:a[1]||(a[1]=e=>we("brands"))},{default:o((()=>[n(O,{src:"/assets/read-DukGAD3K.gif",mode:"aspectFill"}),n(H,{class:"font-cute"},{default:o((()=>[i("娃物图鉴")])),_:1})])),_:1},8,["class"]),n(F,{class:j(["swich_box",{active:"hot"===ke.value}]),onClick:a[2]||(a[2]=e=>we("hot"))},{default:o((()=>[n(O,{src:"/assets/collocation-zJB_wQei.gif",mode:"aspectFill",style:{width:"90rpx",height:"90rpx",position:"relative",bottom:"0rpx"}}),n(H,{class:"font-cute",style:{position:"relative",bottom:"5rpx"}},{default:o((()=>[i("热门搭配")])),_:1})])),_:1},8,["class"]),n(F,{class:j(["swich_box",{active:"second"===ke.value}]),onClick:a[3]||(a[3]=e=>we("second"))},{default:o((()=>[n(O,{src:"/assets/write-B8BOxNp9.gif",mode:"aspectFill"}),n(H,{class:"font-cute"},{default:o((()=>[i("匿名版")])),_:1})])),_:1},8,["class"])])),_:1})])),_:1})])),_:1}),n(F,{class:"body_container"},{default:o((()=>[n(F,{style:{height:"40rpx"}}),n(ie,{"mode-class":["fade"],show:"news"===ke.value},{default:o((()=>["news"===ke.value?(s(),t(F,{key:0,class:"body_list news-box"},{default:o((()=>[n(F,{style:{position:"relative",height:"250rpx","margin-bottom":"20rpx",display:"none"}},{default:o((()=>[n(P,{interval:3e3,duration:200,class:"banner_swiper","indicator-active-color":"#4cbbd0","indicator-color":"rgba(255,255,255,0.5)"},{default:o((()=>[(s(!0),x(C,null,L(T(f),(e=>(s(),t(N,{key:e.id,class:"banner_swiper_item"},{default:o((()=>[n(F,{class:"swiper-item"},{default:o((()=>[n(O,{src:e.banner,mode:"aspectFill",style:{width:"100%",height:"250rpx"},onClick:a=>(e=>{c({url:`/pages/article_detail/article_detail?id=${e.id}`})})(e)},null,8,["src","onClick"])])),_:2},1024)])),_:2},1024)))),128)),0===T(f).length?(s(),t(N,{key:0},{default:o((()=>[n(F,{class:"empty-banner"},{default:o((()=>[n(O,{src:"/static/default-banner.jpg",mode:"aspectFill",style:{width:"100%",height:"250rpx"}})])),_:1})])),_:1})):y("",!0)])),_:1})])),_:1}),(s(!0),x(C,null,L(T(ne),(e=>(s(),t(F,{key:e.id,class:"news-item",onClick:a=>function(e){c({url:"/pages/sale_news/sale_news?id="+e.id+"&brand_id="+e.brand_id})}(e)},{default:o((()=>[n(F,{class:"news-images"},{default:o((()=>[e.image_list.length>0?(s(),t(P,{key:0,class:"image-swiper",autoplay:e.imagesLoaded,circular:!0},{default:o((()=>[(s(!0),x(C,null,L(e.image_list,((a,l)=>(s(),t(N,{key:l},{default:o((()=>[n(F,{class:"image-container"},{default:o((()=>[n(O,{src:a,mode:"aspectFill",class:j(["swiper-image",{loaded:e.imagesLoaded}]),onLoad:a=>(e=>{e.loadCount++,e.loadCount>=e.image_list.length&&(e.imagesLoaded=!0)})(e),onError:a=>((e,a)=>{console.error(`新闻图片加载失败: ${e.image_list[a]}`),e.loadCount||(e.loadCount=0),e.loadCount++,e.loadCount>=e.image_list.length&&(e.imagesLoaded=!0)})(e,l)},null,8,["src","class","onLoad","onError"]),e.imagesLoaded?y("",!0):(s(),t(F,{key:0,class:"loading-overlay"},{default:o((()=>[n(se,{type:"loop",size:"28",color:"rgb(185 185 185)",class:"loading-icon"})])),_:1}))])),_:2},1024)])),_:2},1024)))),128))])),_:2},1032,["autoplay"])):y("",!0)])),_:2},1024),n(F,{class:"news-content"},{default:o((()=>[n(H,{class:"news-title"},{default:o((()=>[i(h(e.title),1)])),_:2},1024),n(H,{class:"news-desc"},{default:o((()=>[i(h(e.content),1)])),_:2},1024),n(F,{class:"news-footer"},{default:o((()=>[n(H,{class:"brand-tag"},{default:o((()=>[i(h(e.brand_name),1)])),_:2},1024),n(H,{class:"news-time"},{default:o((()=>[i(h(Te(e.created_at)),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1032,["onClick"])))),128)),n(F,{class:"loading-more"},{default:o((()=>[de.value?(s(),t(H,{key:0},{default:o((()=>[i("加载中...")])),_:1})):y("",!0),ue.value?y("",!0):(s(),t(H,{key:1},{default:o((()=>[i("没有更多了~")])),_:1}))])),_:1})])),_:1})):y("",!0)])),_:1},8,["show"]),n(ie,{"mode-class":["fade"],show:"brands"===ke.value},{default:o((()=>[n(F,{style:{width:"700rpx"}},{default:o((()=>[n(ce,{style:{width:"100%"},width:"720rpx"})])),_:1}),n(F,{class:"filter-tabs"},{default:o((()=>[(s(!0),x(C,null,L(G.value,((e,a)=>(s(),t(F,{key:a,class:j(["tab-item",{active:q.value===e.value}]),onClick:a=>{return l=e.value,q.value===l?q.value=null:q.value=l,Z.value=1,te.value=!0,u.value=[],m.value="",void Fe();var l}},{default:o((()=>[i(h(e.label),1)])),_:2},1032,["class","onClick"])))),128))])),_:1}),n(F,{class:"brand_type_description",style:{display:"block"}},{default:o((()=>[1==q.value?(s(),t(H,{key:0},{default:o((()=>[i("中国公司制作的BJD在打磨、分模线等工艺的处理上比较优秀，价格也比外社低很多。")])),_:1})):y("",!0),2==q.value?(s(),t(H,{key:1},{default:o((()=>[i("个人作者在贩售娃物前基本都是圈内玩家，在设计方面花的心思很多。")])),_:1})):y("",!0),3==q.value?(s(),t(H,{key:2},{default:o((()=>[i("国外娃社起步较早，风格设计也比较多样化。")])),_:1})):y("",!0)])),_:1}),"brands"===ke.value?(s(),t(F,{key:0,class:"body_list brand_box",style:{position:"relative"}},{default:o((()=>[(s(!0),x(C,null,L(T(u),((e,a)=>(s(),t(F,{key:e.id},{default:o((()=>[n(_e,{brand:e},null,8,["brand"])])),_:2},1024)))),128)),n(F,{class:"loading-more"},{default:o((()=>[oe.value?(s(),t(H,{key:0},{default:o((()=>[i("加载中...")])),_:1})):y("",!0),te.value?y("",!0):(s(),t(H,{key:1},{default:o((()=>[i("没有更多数据了")])),_:1}))])),_:1})])),_:1})):y("",!0)])),_:1},8,["show"]),n(ie,{"mode-class":["fade"],show:"hot"===ke.value},{default:o((()=>["hot"===ke.value?(s(),t(F,{key:0,class:"body_list hot-box"},{default:o((()=>[(s(!0),x(C,null,L(T(re),(e=>(s(),t(F,{key:e.collocation_id,class:"hot-item",onClick:a=>function(e){c({url:`/pages/collocation_share/collocation_share?collocation_id=${e.collocation_id}&origin=${e.origin}`})}(e)},{default:o((()=>[n(F,{class:"images-box"},{default:o((()=>[e.image_urls.length>0?(s(),t(P,{key:0,class:"image-swiper",autoplay:!0,circular:!0},{default:o((()=>[(s(!0),x(C,null,L(e.image_urls,((a,l)=>(s(),t(N,{key:l},{default:o((()=>[n(O,{src:a,mode:"aspectFill",class:j(["swiper-image",{loaded:e.imagesLoaded}]),onLoad:a=>(e=>{console.log("搭配图片加载完成",e),e.loadCount||(e.loadCount=0),e.loadCount++,console.log(e.id,"加载进度:",e.loadCount,"/",e.image_urls.length),setTimeout((()=>{e.imagesLoaded=!0}),300)})(e)},null,8,["src","class","onLoad"])])),_:2},1024)))),128))])),_:2},1024)):y("",!0)])),_:2},1024),n(F,{class:"content-box"},{default:o((()=>[n(H,{class:"title"},{default:o((()=>[i(h(e.title),1)])),_:2},1024),n(H,{class:"desc"},{default:o((()=>[i(h(e.content),1)])),_:2},1024),n(F,{class:"tags-box"},{default:o((()=>[(s(!0),x(C,null,L(e.relation_list,((e,a)=>(s(),t(F,{key:a,class:"tag-item"},{default:o((()=>[n(H,{class:"tag-text"},{default:o((()=>[i(h(e.relation_goods_name),1)])),_:2},1024),n(H,{class:"brand-text"},{default:o((()=>[i(h(e.relation_brand_name),1)])),_:2},1024)])),_:2},1024)))),128))])),_:2},1024),n(F,{class:"footer"},{default:o((()=>[n(F,{class:"user-info"},{default:o((()=>[n(O,{src:e.avatar,class:"avatar",mode:"aspectFill"},null,8,["src"]),n(H,{class:"time"},{default:o((()=>[i(" 发布"+h(1==e.origin?"搭配":"展示柜")+"于 "+h(Te(e.created_at)),1)])),_:2},1024)])),_:2},1024),n(F,{class:"like-box"},{default:o((()=>[n(se,{type:"heart",size:"18",color:"#ff4d4f"}),n(H,{class:"like-count"},{default:o((()=>[i(h(e.like_count),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1032,["onClick"])))),128)),n(F,{class:"loading-more"},{default:o((()=>[ve.value?(s(),t(H,{key:0},{default:o((()=>[i("加载中...")])),_:1})):y("",!0),pe.value?y("",!0):(s(),t(H,{key:1},{default:o((()=>[i("没有更多了~")])),_:1}))])),_:1})])),_:1})):y("",!0)])),_:1},8,["show"]),n(ie,{"mode-class":["fade"],show:"second"===ke.value},{default:o((()=>["second"===ke.value?(s(),t(F,{key:0,class:"body_list treehole-box"},{default:o((()=>[n(F,{class:"publish-btn",onClick:De},{default:o((()=>[n(se,{type:"plusempty",size:"30",color:"#fff"})])),_:1}),(s(!0),x(C,null,L(T(ge),(e=>(s(),t(F,{key:e.id,class:"treehole-item",onClick:a=>function(e){c({url:"/pages/treehole_detail/treehole_detail?id="+e.id})}(e)},{default:o((()=>[n(F,{class:"user-info",onClick:U((a=>function(e){1!=e.is_anonymous&&c({url:"/pages/user_page/user_page?uid="+e.uid})}(e)),["stop"])},{default:o((()=>[""!==e.avatar?(s(),t(O,{key:0,src:e.avatar,class:"avatar",mode:"aspectFill"},null,8,["src"])):(s(),t(O,{key:1,src:"/assets/noname-CTwn5AZS.png",class:"avatar",mode:"scaleToFill"})),n(H,{class:"username"},{default:o((()=>[i(h(e.is_anonymous?"匿名用户":e.author_name),1)])),_:2},1024),n(H,{class:"time"},{default:o((()=>[i(h(Te(e.created_at)),1)])),_:2},1024),n(H,{class:"cid"},{default:o((()=>[i("【"+h(e.id)+"】",1)])),_:2},1024)])),_:2},1032,["onClick"]),n(H,{class:"content"},{default:o((()=>[i(h(e.content),1)])),_:2},1024),e.images.length>0?(s(),t(F,{key:0,class:"image-grid"},{default:o((()=>[n(P,{class:"image-swiper",autoplay:e.imagesLoaded,circular:!0,"indicator-dots":e.images.length>1,duration:300},{default:o((()=>[(s(!0),x(C,null,L(e.images,((a,l)=>(s(),t(N,{key:l},{default:o((()=>[n(F,{class:"image-container"},{default:o((()=>[n(O,{src:a,mode:"aspectFill",class:j(["swiper-image",{loaded:e.imagesLoaded}]),onClick:U((a=>{return s=e.images,void E({current:l,urls:s});var s}),["stop"]),onLoad:a=>(e=>{e.loadCount++,e.loadCount>=e.images.length&&(e.imagesLoaded=!0)})(e),onError:a=>((e,a)=>{console.error(`图片加载失败: ${e.images[a]}`),e.loadCount++,e.loadCount>=e.images.length&&(e.imagesLoaded=!0)})(e,l)},null,8,["src","class","onClick","onLoad","onError"]),e.imagesLoaded?y("",!0):(s(),t(F,{key:0,class:"loading-overlay"},{default:o((()=>[n(se,{type:"spinner-cycle",size:"28",color:"#4cbbd0",class:"loading-icon"})])),_:1}))])),_:2},1024)])),_:2},1024)))),128))])),_:2},1032,["autoplay","indicator-dots"])])),_:2},1024)):y("",!0),n(F,{class:"action-bar"},{default:o((()=>[n(F,{class:"action-item",onClick:a=>function(e){if(!Q.isLogin)return void S({title:"请先登录",icon:"none"});let a=p("token");a?b({url:Y+(e.has_liked?"/with-state/unlike":"/with-state/add-like"),method:"POST",header:{Authorization:a},data:{id:e.id,type:5},success:a=>{"success"===a.data.status?(e.has_liked=!e.has_liked,e.like_count+=e.has_liked?1:-1):uni.showD}}):S({title:"请先登录",icon:"none"})}(e)},{default:o((()=>[n(se,{type:e.has_liked?"hand-up-filled":"hand-up",size:"18",color:e.has_liked?"#ff4d4f":"#666"},null,8,["type","color"]),n(H,{class:"count"},{default:o((()=>[i(h(e.like_count||0),1)])),_:2},1024)])),_:2},1032,["onClick"]),n(F,{class:"action-item"},{default:o((()=>[n(se,{type:"chat",size:"18",color:"#666"}),n(H,{class:"count"},{default:o((()=>[i(h(e.comment_count||0),1)])),_:2},1024)])),_:2},1024),n(F,{class:"action-item",onClick:U((a=>function(e){let a="http://m.dogdogdoll.com/#/pages/treehole_detail/treehole_detail?id="+e.id;A({data:a,success:function(){S({title:"复制链接成功",icon:"none"})}})}(e)),["stop"])},{default:o((()=>[n(se,{type:"redo",size:"18",color:"#666"}),n(H,{class:"count"},{default:o((()=>[i("分享")])),_:1})])),_:2},1032,["onClick"])])),_:2},1024)])),_:2},1032,["onClick"])))),128)),n(F,{class:"loading-more"},{default:o((()=>[be.value?(s(),t(H,{key:0},{default:o((()=>[i("加载中...")])),_:1})):y("",!0),ye.value?y("",!0):(s(),t(H,{key:1},{default:o((()=>[i("没有更多了~")])),_:1}))])),_:1})])),_:1})):y("",!0)])),_:1},8,["show"])])),_:1})])),_:1})])),_:1})],64)}}},[["__scopeId","data-v-507171c2"]]);export{se as default};
