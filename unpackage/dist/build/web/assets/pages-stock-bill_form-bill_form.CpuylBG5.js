import{r as e,o as a,a3 as t,a as l,v as s,d as o,w as u,F as d,j as i,q as n,g as c,b as r,B as m,e as p,t as f,C as v,c as _,p as h,u as b,A as g,ab as x,f as y,N as w,K as k,i as F,h as T}from"./index-I3aG4WZL.js";import{_ as C}from"./view-logs.C4HVuFxK.js";import{_ as S,a as j,r as V}from"./_plugin-vue_export-helper.DF4WgY5m.js";import{_ as z}from"./info-circle.U4M77mlp.js";import{w as A}from"./config.BjeWXQ7P.js";const I=S({__name:"bill_form",props:["bill_id"],setup(S){const I=S,D=e({}),O=!!I.bill_id,P=e(""),U=e(""),$=e(""),G=e(0),q=["未补款","已补款"];j((e=>{D.value=e,e.name&&(P.value=decodeURIComponent(e.name)),e.amount&&(U.value=e.amount)}));const B=e("");function E(e){const a=e.detail.value;$.value=a,B.value=M(a)}function K(){b({title:"提示",content:"确定删除该账单吗？",success:e=>{e.confirm&&n({url:A+"/with-state/delete-tail-bill?id="+parseInt(I.bill_id,10),method:"POST",header:{Authorization:i("token")},success:e=>{"success"==e.data.status?(g({title:"删除成功",icon:"success"}),setTimeout((()=>{x()}),500)):g({title:e.data.msg,icon:"none"})}})}})}function M(e){let a=new Date(e);return`${a.getFullYear()}-${(a.getMonth()+1).toString().padStart(2,"0")}-${a.getDate().toString().padStart(2,"0")}`}function N(e){G.value=e.detail.value}function R(){O?function(){let e={id:parseInt(I.bill_id,10),name:P.value,price:parseFloat(U.value),ymd:$.value,status:G.value};n({url:A+"/with-state/update-tail-bill",method:"POST",header:{Authorization:i("token")},data:e,success:e=>{"success"==e.data.status?(g({title:"提交成功",icon:"success"}),setTimeout((()=>{x()}),500)):g({title:e.data.msg,icon:"none"})}})}():function(){let e={name:P.value,price:parseFloat(U.value),ymd:$.value,status:G.value};n({url:A+"/with-state/add-tail-bill",method:"POST",header:{Authorization:i("token")},data:e,success:e=>{"success"==e.data.status?(g({title:"提交成功",icon:"success"}),setTimeout((()=>{x()}),500)):g({title:e.data.msg,icon:"none"})}})}()}return a((()=>{O?(!function(e){let a=i("token");n({url:A+"/with-state/tail-bill-detail",method:"GET",header:{Authorization:a},data:{id:e},success:e=>{P.value=e.data.data.name,U.value=e.data.data.price,$.value=e.data.data.ymd,G.value=e.data.data.status,B.value=M(e.data.data.ymd)},fail:e=>{console.log(e)}})}(I.bill_id),t({title:"编辑账单"})):t({title:"新增账单"})})),(e,a)=>{const t=V(l("view-logs"),C),i=y,n=w,b=c,g=k,x=F,S=T;return r(),s(d,null,[o(t),o(b,{class:"container"},{default:u((()=>[m("meta",{name:"theme-color",content:"#F8F8F8"}),o(b,{class:"form-card"},{default:u((()=>[o(b,{class:"form-item"},{default:u((()=>[o(i,{class:"form-label"},{default:u((()=>[p("账单名称")])),_:1}),o(n,{class:"form-input",type:"text",placeholder:"请输入名称","placeholder-class":"placeholder-style",modelValue:P.value,"onUpdate:modelValue":a[0]||(a[0]=e=>P.value=e)},null,8,["modelValue"])])),_:1}),o(b,{class:"form-item"},{default:u((()=>[o(i,{class:"form-label"},{default:u((()=>[p("账单金额")])),_:1}),o(n,{class:"form-input",type:"digit",placeholder:"请输入金额","placeholder-class":"placeholder-style",modelValue:U.value,"onUpdate:modelValue":a[1]||(a[1]=e=>U.value=e)},null,8,["modelValue"])])),_:1}),o(b,{class:"form-item"},{default:u((()=>[o(i,{class:"form-label"},{default:u((()=>[p("账单日期")])),_:1}),o(b,{style:{padding:"0px 10px",border:"1px solid #e6e6e6","border-radius":"10px"}},{default:u((()=>[o(g,{mode:"date",value:B.value,onChange:E},{default:u((()=>[o(b,{class:"picker-content",style:{color:"#2c2c2c","font-size":"26rpx"}},{default:u((()=>[p(f(B.value||"请选择日期"),1)])),_:1})])),_:1},8,["value"])])),_:1})])),_:1}),o(b,{class:"form-item"},{default:u((()=>[o(i,{class:"form-label"},{default:u((()=>[p("账单状态")])),_:1}),o(b,{style:{padding:"0px 10px",border:"1px solid #e6e6e6","border-radius":"10px"}},{default:u((()=>[o(g,{mode:"selector",value:G.value,range:q,onChange:N},{default:u((()=>[o(b,{class:"picker-content"},{default:u((()=>[p(f(q[G.value]||"请选择状态"),1)])),_:1})])),_:1},8,["value"])])),_:1})])),_:1}),o(b,{style:{overflow:"hidden"}},{default:u((()=>[o(x,{src:z,mode:"aspectFill",style:{width:"28rpx",height:"28rpx","margin-right":"10rpx",position:"relative",top:"3rpx"}}),o(i,{style:{color:"#888"}},{default:u((()=>[p("仅用于您的记账，其他人不会看到")])),_:1})])),_:1})])),_:1}),o(b,{class:"button-group"},{default:u((()=>[o(S,{class:"submit-button",onClick:R},{default:u((()=>[p(" 记录"+f(v(O)?"修改":"新增"),1)])),_:1}),v(O)?(r(),_(S,{key:0,class:"delete-button",onClick:K},{default:u((()=>[p(" 删除账单 ")])),_:1})):h("",!0)])),_:1})])),_:1})],64)}}},[["__scopeId","data-v-272f8d5c"]]);export{I as default};
