import{_ as a,g as s,j as e,m as t,c as l,w as u,f as o,o as n,a as i,b as c,x as r,t as p,z as d,l as f,H as m,k as _,a7 as v,L as g,a9 as h,K as y,e as b}from"./index-B55GPRQF.js";import{_ as w}from"./uni-icons.B2Wm8RW1.js";import{r as j}from"./uni-app.es.CzHle-z4.js";import{a as x,w as k,g as z}from"./config.BIUptOrH.js";import{_ as I}from"./_plugin-vue_export-helper.BCo6x5W8.js";const V=I({__name:"username",setup(I){a({title:"修改用户名"});const V=s(x.userInfo.username||""),A=s(!1),T=e((()=>V.value.length>=2&&V.value!==x.userInfo.username));async function C(){if(T.value)try{A.value=!0;const a=await f({url:k+"/with-state/update-profile",method:"POST",header:{Authorization:m("token")},data:{username:V.value}});"success"===a.data.status?(_({title:"更新成功",icon:"success"}),await z(),setTimeout((()=>v()),1500)):_({title:a.data.msg||"更新失败",icon:"none"})}catch(a){_({title:"请求失败，请稍后重试",icon:"none"})}finally{A.value=!1}}return(a,s)=>{const e=g,f=h,m=j(t("uni-icons"),w),_=o,v=y,x=b;return n(),l(_,{class:"password-container"},{default:u((()=>[i(_,{class:"form-wrapper"},{default:u((()=>[i(_,{class:"input-group"},{default:u((()=>[i(_,{class:"input-item"},{default:u((()=>[i(e,{class:"input",type:"text",placeholder:" ",modelValue:V.value,"onUpdate:modelValue":s[0]||(s[0]=a=>V.value=a),maxlength:"20"},null,8,["modelValue"]),i(f,{class:"floating-label"},{default:u((()=>[c("用户名")])),_:1}),i(m,{class:"input-icon",type:"person",size:"18",color:"#999"})])),_:1})])),_:1}),i(v,{class:r(["submit-btn",{active:T.value}]),onClick:C,disabled:!T.value},{default:u((()=>[c(p(A.value?"提交中...":"更新用户名")+" ",1),A.value?(n(),l(_,{key:0,class:"loading"})):d("",!0)])),_:1},8,["class","disabled"])])),_:1}),i(_,{class:"security-tips"},{default:u((()=>[i(m,{type:"info",size:"16",color:"#666"}),i(x,null,{default:u((()=>[c("用户名2-20个字符，支持中英文、数字和下划线")])),_:1})])),_:1})])),_:1})}}},[["__scopeId","data-v-960efc4b"]]);export{V as default};
