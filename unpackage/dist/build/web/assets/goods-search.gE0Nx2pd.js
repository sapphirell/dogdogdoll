import{r as e,k as a,M as s,b as l,v as t,c as o,p as n,d as u,w as d,a1 as r,D as c,F as i,x as m,e as p,t as f,q as g,n as v,g as _,i as y,N as h,f as k,S}from"./index-I3aG4WZL.js";import{_ as b}from"./search.CsIL0f2m.js";import{_ as j}from"./cancel.CnEdunnH.js";import{w}from"./config.BjeWXQ7P.js";import{_ as C}from"./_plugin-vue_export-helper.DF4WgY5m.js";const x=C({__name:"goods-search",props:{modelValue:{type:String,default:""},width:{type:String,default:"100%"},background:{type:String,default:""},fontSize:{type:String,default:""},tagColor:{type:String,default:"#666"},mode:{type:String,default:"jump",validator:e=>["jump","fill"].includes(e)},hiddenIcon:{type:Boolean,default:!0}},emits:["select","update:modelValue"],setup(C,{emit:x}){const I=e(!1),V=C,z=x,$=e([]),D=a({get:()=>V.modelValue,set:e=>z("update:modelValue",e)});s($,(e=>{I.value=e.length>0}));const G=()=>{$.value=[],I.value=!1},M=async e=>{var a;D.value=e.detail.value;const s=e.detail.value.trim();if(I.value=!0,s)try{const e=await g({url:w+`/search-goods?search=${encodeURIComponent(s)}`,method:"GET"});$.value="success"===(null==(a=e.data)?void 0:a.status)&&e.data.data||[]}catch(l){console.error("搜索失败:",l),$.value=[]}else $.value=[]},q=()=>{G()};return(e,a)=>{const s=_,g=y,w=h,x=k,B=S;return l(),t(i,null,[I.value?(l(),o(s,{key:0,class:"mask-layer",onClick:G})):n("",!0),u(s,{class:c(["search_tab",e.$attrs.class]),style:r({background:C.background||"#fff"})},{default:d((()=>[C.hiddenIcon?n("",!0):(l(),o(g,{key:0,class:"icon_image",src:b})),u(w,{class:"common_search_input",placeholder:"请输入娃物名称 (ㅇㅅㅇ❀)...",value:D.value,onInput:M,style:r({fontSize:C.fontSize||"23rpx"})},null,8,["value","style"]),$.value.length>0?(l(),o(g,{key:1,class:"icon_image",src:j,onClick:q})):n("",!0)])),_:1},8,["class","style"]),$.value.length>0?(l(),o(B,{key:1,class:"search_results",style:r({width:C.width}),"scroll-y":""},{default:d((()=>[(l(!0),t(i,null,m($.value,(e=>(l(),o(s,{key:e.id,class:"result_item",onClick:a=>{return s=e,"jump"===V.mode&&v({url:`/pages/goods/goods?goods_id=${s.id}`}),"fill"===V.mode&&(z("select",s),D.value=s.name,$.value=[]),void G();var s}},{default:d((()=>[e.brand_name?(l(),o(s,{key:0,class:"brand-tag"},{default:d((()=>[p(f(e.brand_name),1)])),_:2},1024)):n("",!0),u(x,{class:"goods-name"},{default:d((()=>[p(f(e.name),1)])),_:2},1024)])),_:2},1032,["onClick"])))),128))])),_:1},8,["style"])):n("",!0)],64)}}},[["__scopeId","data-v-99b35cd1"]]);export{x as _};
