import{as as n,H as o,l as t,V as e,T as s,k as i}from"./index-B55GPRQF.js";const a="https://api.fantuanpu.com",c="https://images1.fantuanpu.com/";let u=n({isLogin:!1,userInfo:{}});function r(){i({title:"请在微信小程序中登录",icon:"none"})}function l(){return i({title:"请在微信小程序中绑定",icon:"none"}),Promise.reject("请在微信小程序中绑定")}function f(){const n=o("token");if(console.log("token:",n),!n)return console.log("没有token，无法获取用户信息"),void h();console.log("请求接口"),t({url:`${a}/with-state/mine`,method:"GET",header:{Authorization:n},success:n=>{const o=n.data.data;o?(console.log("获取用户信息成功,进行存储",o),m(o)):(console.log("无法获取，清理用户状态"),h())},fail:n=>{k(n,"获取用户信息失败")}})}function d(){return new Promise(((n,e)=>{const s=o("token");if(!s)return h(),void n(null);t({url:`${a}/with-state/mine`,method:"GET",header:{Authorization:s},success:o=>{const t=o.data.data;t?(console.log("返回：",t),m(t),n(t)):(h(),n(null))},fail:o=>{k(o,"获取用户信息失败"),n(null)}})}))}function g(){return 1}function m(n){e("userInfo",n),e("token",n.last_token),u.userInfo=n,u.isLogin=!0}function h(){s("userInfo"),u.userInfo={},u.isLogin=!1}function k(n,o="请求失败"){console.error(n),i({title:o,icon:"none"})}export{u as a,d as b,r as c,l as d,g as e,f as g,c as i,a as w};
