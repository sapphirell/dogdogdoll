import{a2 as t,m as a,r as e,o as s,c as n,w as o,p as l,q as A,v as i,A as c,g as u,b as r,k as d,l as f,F as w,d as p,a0 as h,e as m,t as g,u as E,n as C,x as v,j as y,_ as B,$ as I,f as x,C as b,i as k}from"./index-6ojkiy1R.js";import{c as Q,w as D,b as O,e as V}from"./config.Bhvn_Gfs.js";import{_ as P}from"./_plugin-vue_export-helper.BCo6x5W8.js";const S=P({__name:"setting",setup(P){t({title:"设置"});const S=a((()=>[{label:"更改用户名",action:N,status:!!O.userInfo.password,displayValue:O.userInfo.password?"去修改":"未设置"},{label:"更改密码",action:X,status:!!O.userInfo.password,displayValue:O.userInfo.password?"去修改":"未设置"},{label:"绑定手机号",action:q,status:!!O.userInfo.tel_phone,displayValue:O.userInfo.tel_phone?O.userInfo.tel_phone.replace(/(\d{3})\d{4}(\d{4})/,"$1****$2"):"去绑定"},{label:"绑定微信",action:F,status:!!O.userInfo.wechat_open_id,displayValue:O.userInfo.wechat_open_id?"已绑定":"去绑定"},{label:"检查更新",action:W,status:j.value.version,displayValue:L.value}]));e({});let j=e({});const H=e(!1);e(!1);const L=e("检查更新");let J=e(0);function X(){C({url:"/pages/setting/password/password"})}function q(){C({url:"/pages/setting/tel_phone/tel_phone"})}function N(){C({url:"/pages/setting/username/username"})}function F(){O.userInfo.wechat_open_id?c({title:"已绑定微信",icon:"none"}):V().then((()=>{console.log("微信绑定成功"),c({title:"微信绑定成功",icon:"none"})})).catch((t=>{console.error("微信绑定失败:",t),c({title:"微信绑定失败",icon:"none"})}))}const W=async()=>{l().platform;{J.value++,A().appVersion;const t=await i({url:`${D}/latest-version?version=1.0.40`,method:"GET"});t&&t.data&&("success"===t.data.status&&t.data.data?(L.value="有新版本:"+t.data.data.version,j.value=!0):J.value>1&&c({title:"当前已是最新版本",icon:"none"}))}};async function Y(){H.value?v({title:"取消注销申请",content:"确定要取消账号注销申请吗？",success:async t=>{t.confirm&&await async function(){const t=y("token");if(!t)return void c({title:"请先登录",icon:"none"});B({title:"处理中...",mask:!0});try{const a=await i({url:`${D}/with-state/cancel-delete`,method:"POST",header:{Authorization:t}});if(I(),"success"!==a.data.status)throw new Error(a.data.msg||"取消注销失败");H.value=!1,O.userInfo.deleteApplyAt=0,c({title:"已取消注销申请",icon:"success",duration:3e3})}catch(a){I(),c({title:a.message||"操作失败，请稍后重试",icon:"none",duration:3e3})}}()}}):v({title:"申请注销账号",content:"确定要申请注销账号吗？注销后账号将不可恢复！",confirmText:"确认注销",confirmColor:"#f56c6c",success:async t=>{t.confirm&&await async function(){const t=y("token");if(!t)return void c({title:"请先登录",icon:"none"});B({title:"处理中...",mask:!0});try{const a=await i({url:`${D}/with-state/apply-delete`,method:"POST",header:{Authorization:t}});if(I(),"success"!==a.data.status)throw new Error(a.data.msg||"申请注销失败");H.value=!0,O.userInfo.deleteApplyAt=Math.floor(Date.now()/1e3),c({title:"已申请注销账号",icon:"success",duration:3e3}),setTimeout((()=>{v({title:"注销申请已提交",content:"您的账号将在30天后正式注销。在此期间您可以正常使用所有功能，并可随时取消注销申请。",showCancel:!1,confirmText:"知道了"})}),1e3)}catch(a){I(),c({title:a.message||"操作失败，请稍后重试",icon:"none",duration:3e3})}}()}})}return s((()=>{Q().then((t=>{H.value=t.delete_apply_at>0})),W()})),(t,a)=>{const e=x,s=k,l=u;return r(),n(l,{class:"settings-container"},{default:o((()=>[(r(!0),d(w,null,f(S.value,((t,a)=>(r(),n(l,{key:a,class:"menu-item",onClick:a=>t.action(t)},{default:o((()=>[p(e,{class:"menu-label"},{default:o((()=>[m(g(t.label),1)])),_:2},1024),p(l,{class:"menu-value"},{default:o((()=>[p(e,{class:b(t.status?"active":"inactive")},{default:o((()=>[m(g(t.displayValue),1)])),_:2},1032,["class"]),p(s,{class:"arrow-icon",src:"data:image/png;base64,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"})])),_:2},1024)])),_:2},1032,["onClick"])))),128)),p(l,{class:"logout-section"},{default:o((()=>[p(l,{class:"logout-btn",onClick:Y,style:h({backgroundColor:H.value?"#f56c6c":"#cfcad8"})},{default:o((()=>[p(e,null,{default:o((()=>[m(g(H.value?"取消注销申请":"申请注销账号"),1)])),_:1})])),_:1},8,["style"]),H.value?(r(),n(e,{key:0,class:"deletion-notice"},{default:o((()=>[m(" 已申请注销，30天后账号将正式注销。在此之前可以正常使用，并可随时取消注销申请。 ")])),_:1})):E("",!0)])),_:1})])),_:1})}}},[["__scopeId","data-v-39d3f2aa"]]);export{S as default};
