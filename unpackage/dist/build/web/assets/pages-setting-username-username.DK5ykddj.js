import{a2 as a,r as s,k as e,a as t,v as l,d as u,w as o,F as n,g as i,b as r,e as c,D as d,t as p,c as f,p as m,q as v,j as _,A as b,ab as g,M as h,X as w,h as y,f as j}from"./index-BFzTDSoz.js";import{b as x,_ as k,w as z,a as A}from"./view-logs.yEAac7W9.js";import{_ as I,r as V}from"./_plugin-vue_export-helper.CXFOpRdI.js";import{_ as C}from"./uni-icons.COaeasi-.js";const T=I({__name:"username",setup(I){a({title:"修改用户名"});const T=s(x.userInfo.username||""),q=s(!1),B=e((()=>T.value.length>=2&&T.value!==x.userInfo.username));async function D(){if(B.value)try{q.value=!0;const a=await v({url:z+"/with-state/update-profile",method:"POST",header:{Authorization:_("token")},data:{username:T.value}});"success"===a.data.status?(b({title:"更新成功",icon:"success"}),await A(),setTimeout((()=>g()),1500)):b({title:a.data.msg||"更新失败",icon:"none"})}catch(a){b({title:"请求失败，请稍后重试",icon:"none"})}finally{q.value=!1}}return(a,s)=>{const e=V(t("view-logs"),k),v=h,_=w,b=V(t("uni-icons"),C),g=i,x=y,z=j;return r(),l(n,null,[u(e),u(g,{class:"password-container"},{default:o((()=>[u(g,{class:"form-wrapper"},{default:o((()=>[u(g,{class:"input-group"},{default:o((()=>[u(g,{class:"input-item"},{default:o((()=>[u(v,{class:"input",type:"text",placeholder:" ",modelValue:T.value,"onUpdate:modelValue":s[0]||(s[0]=a=>T.value=a),maxlength:"20"},null,8,["modelValue"]),u(_,{class:"floating-label"},{default:o((()=>[c("用户名")])),_:1}),u(b,{class:"input-icon",type:"person",size:"18",color:"#999"})])),_:1})])),_:1}),u(x,{class:d(["submit-btn",{active:B.value}]),onClick:D,disabled:!B.value},{default:o((()=>[c(p(q.value?"提交中...":"更新用户名")+" ",1),q.value?(r(),f(g,{key:0,class:"loading"})):m("",!0)])),_:1},8,["class","disabled"])])),_:1}),u(g,{class:"security-tips"},{default:o((()=>[u(b,{type:"info",size:"16",color:"#666"}),u(z,null,{default:o((()=>[c("用户名2-20个字符，支持中英文、数字和下划线")])),_:1})])),_:1})])),_:1})],64)}}},[["__scopeId","data-v-bf9b8671"]]);export{T as default};
