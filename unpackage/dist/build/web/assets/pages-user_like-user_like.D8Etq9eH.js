import{r as a,av as s,o as e,n as l,q as t,j as o,A as i,a3 as c,a as d,c as n,w as u,g as r,b as g,B as _,d as m,v as f,x as p,F as v,e as k,p as y,f as b,S as h,D as w,t as C,H as F,i as x,h as z}from"./index-I3aG4WZL.js";import{_ as $}from"./view-logs.C4HVuFxK.js";import{_ as j,r as A}from"./_plugin-vue_export-helper.DF4WgY5m.js";import{c as S,w as B}from"./config.BjeWXQ7P.js";const D=j({__name:"user_like",setup(j){const D=a([{type:1,name:"商品"},{type:2,name:"品牌"},{type:3,name:"搭配"},{type:4,name:"展示柜"}]),G=a(1),T=a([]),q=a(!1),E=a(!1),H=s({page:1,page_size:8,total:0});e((async()=>{await I(),O()}));const I=async()=>{await S()||l({url:"/pages/login/login"})},O=async()=>{if(!q.value&&!E.value){q.value=!0;try{const a=await t({url:`${B}/with-state/user-likes`,method:"GET",data:{type:G.value,page:H.page,page_size:H.page_size},header:{Authorization:o("token")}});if("success"===a.data.status){const s=a.data.data.list;T.value=[...T.value,...s],H.total=a.data.data.total,a.data.data.list.length?E.value=!1:E.value=!0,H.page+=1}}catch(a){i({title:"加载失败",icon:"none"})}finally{q.value=!1}}},P=()=>{E.value?console.log("no more"):O()},J=()=>{H.page=1,T.value=[],E.value=!1},K=a=>(null==a?void 0:a.length)>0?a[0]:"",L=a=>{const s=(null==a?void 0:a.split(",")[0])||"";return s||""};return c({title:"我的关注"}),(a,s)=>{const e=A(d("view-logs"),$),c=r,j=x,S=b,H=z,I=h;return g(),n(c,{class:"container"},{default:u((()=>[_("meta",{name:"theme-color",content:"#F8F8F8"}),m(e),m(c,{class:"nav-bar"},{default:u((()=>[(g(!0),f(v,null,p(D.value,((a,s)=>(g(),n(c,{key:s,class:w(["nav-item",{active:G.value===a.type}]),onClick:s=>{return e=a.type,void(G.value!==e&&(G.value=e,J(),O()));var e}},{default:u((()=>[k(C(a.name),1)])),_:2},1032,["class","onClick"])))),128))])),_:1}),m(I,{class:"scroll-view","scroll-y":"",onScrolltolower:P,"show-scrollbar":!1},{default:u((()=>[m(c,{class:"list-container"},{default:u((()=>[(g(!0),f(v,null,p(T.value,((s,e)=>(g(),f(v,{key:s.id},[1===G.value&&s.goods?(g(),n(c,{key:0,class:"list-item goods-item",onClick:a=>{return e=s.goods.id,void l({url:`/pages/goods/goods?goods_id=${e}`});var e}},{default:u((()=>[m(c,{class:"goods-left"},{default:u((()=>[m(j,{class:"goods-thumb",src:K(s.goods.goods_images),mode:"aspectFill"},null,8,["src"]),m(c,{class:"price-tag"},{default:u((()=>[k("¥"+C(s.goods.total_amount),1)])),_:2},1024)])),_:2},1024),m(c,{class:"goods-right"},{default:u((()=>[m(c,{class:"goods-header"},{default:u((()=>[m(S,{class:"goods-title line-clamp-2"},{default:u((()=>[k(C(s.goods.name),1)])),_:2},1024),m(H,{class:"unfollow-btn",onClick:F((a=>(async a=>{try{"success"===(await t({url:`${B}/user/unfollow`,method:"POST",data:{id:a},header:{Authorization:o("token")}})).data.status&&(T.value=T.value.filter((s=>s.id!==a)),i({title:"已取消关注",icon:"success"}))}catch(s){i({title:"操作失败",icon:"none"})}})(s.id)),["stop"])},{default:u((()=>[k("取消关注")])),_:2},1032,["onClick"])])),_:2},1024),m(c,{class:"goods-specs"},{default:u((()=>[m(S,{class:"spec-item"},{default:u((()=>[k(C(s.goods.brand_name),1)])),_:2},1024),m(S,{class:"spec-item"},{default:u((()=>[k(C(s.goods.size),1)])),_:2},1024),m(S,{class:"spec-item"},{default:u((()=>[k(C(s.goods.skin.split(" ")[0]),1)])),_:2},1024)])),_:2},1024),m(c,{class:"goods-footer"},{default:u((()=>[m(S,{class:"goods-type"},{default:u((()=>[k(C(s.goods.type),1)])),_:2},1024),m(S,{class:"goods-material"},{default:u((()=>[k(C(s.goods.doll_material),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1032,["onClick"])):y("",!0),2===G.value&&s.brand?(g(),n(c,{key:1,class:"list-item brand-item",onClick:a=>{return e=s.brand.id,void l({url:`/pages/brand/brand?brand_id=${e}`});var e}},{default:u((()=>[m(c,{class:"brand-content"},{default:u((()=>[m(j,{class:"brand-logo",src:s.brand.logo_image,mode:"aspectFit"},null,8,["src"]),m(c,{class:"brand-info"},{default:u((()=>[m(c,{class:"brand-header"},{default:u((()=>[m(S,{class:"brand-name"},{default:u((()=>[k(C(s.brand.brand_name),1)])),_:2},1024),m(S,{class:"brand-country"},{default:u((()=>[k(C(s.brand.country_name),1)])),_:2},1024)])),_:2},1024),m(S,{class:"brand-description line-clamp-2"},{default:u((()=>[k(C(s.brand.description),1)])),_:2},1024),m(c,{class:"brand-actions"},{default:u((()=>[m(H,{class:"action-btn",onClick:F((e=>a.unfollowBrand(s.id)),["stop"])},{default:u((()=>[k("取消关注")])),_:2},1032,["onClick"])])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1032,["onClick"])):y("",!0),3===G.value&&s.collocation?(g(),n(c,{key:2,class:"list-item",onClick:a=>{return e=s.collocation.id,void l({url:`/pages/collocation/detail?id=${e}`});var e}},{default:u((()=>[m(j,{class:"item-image",src:L(s.collocation.image_urls),mode:"aspectFill"},null,8,["src"]),m(S,{class:"item-title"},{default:u((()=>[k(C(s.collocation.title),1)])),_:2},1024)])),_:2},1032,["onClick"])):y("",!0),4===G.value&&s.showcase?(g(),n(c,{key:3,class:"list-item",onClick:a=>{return e=s.showcase.id,void l({url:`/pages/showcase/detail?id=${e}`});var e}},{default:u((()=>[m(j,{class:"item-image",src:K(s.showcase.image_urls),mode:"aspectFill"},null,8,["src"]),m(S,{class:"item-title"},{default:u((()=>[k(C(s.showcase.name),1)])),_:2},1024)])),_:2},1032,["onClick"])):y("",!0)],64)))),128)),m(c,{class:"loading-status"},{default:u((()=>[q.value?(g(),n(S,{key:0,class:"loading-text"},{default:u((()=>[k("加载中...")])),_:1})):y("",!0),E.value?(g(),n(S,{key:1,class:"no-more-text"},{default:u((()=>[k("没有更多了")])),_:1})):y("",!0)])),_:1})])),_:1})])),_:1})])),_:1})}}},[["__scopeId","data-v-8ece1c3a"]]);export{D as default};
