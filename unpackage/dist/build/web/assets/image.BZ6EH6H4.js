import{O as t,C as e,l as a,m as o,J as n}from"./index-u2rUIk8T.js";import{w as i,i as s}from"./config.DgkxgtZ3.js";function r(){return new Promise((e=>{t({count:1,success:t=>{e(t.tempFilePaths[0])}})}))}function c(){return new Promise(((t,n)=>{let s=e("token");a({url:i+"/with-state/qiniu-token",method:"POST",header:{Authorization:s},success:e=>{e.data.data&&e.data.data.token?(console.log("获取到的七牛token："+e.data.data.token),t(e.data.data)):(o({title:"获取上传凭证失败",icon:"none"}),n("获取上传凭证失败"))},fail:t=>{o({title:"获取上传凭证失败",icon:"none"}),n("获取上传凭证失败")}})}))}function l(t,r,c){let l=e("token");return new Promise(((e,u)=>{n({url:"https://up-cn-east-2.qiniup.com",name:"file",method:"POST",filePath:t,fileType:"image",formData:{token:r,key:c,scope:"hobby-box:"+c},success:async t=>{try{const o=s+c,n=await a({url:`${i}/with-state/add-image-log`,method:"POST",header:{"Content-Type":"application/json",Authorization:l},data:{image_url:o}});if(console.log(n),"success"!==n.data.status)throw new Error("上传图片失败");e({qiniuRes:t,imageUrl:o})}catch(n){console.error("日志记录失败:",n),o({title:"日志记录失败",icon:"none"}),u("日志记录失败")}},fail:t=>{o({title:"上传失败",icon:"none"}),u("上传失败")}})}))}export{r as c,c as g,l as u};
