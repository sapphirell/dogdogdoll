import{g as e,j as a,M as s,o as l,d as t,c as o,z as n,a as u,w as r,Y as d,x as c,F as i,r as m,b as p,t as f,l as g,n as v,f as _,i as y,L as h,e as k,S}from"./index-B55GPRQF.js";import{_ as j}from"./search.CsIL0f2m.js";import{_ as b}from"./cancel.CnEdunnH.js";import{w}from"./config.BIUptOrH.js";import{_ as C}from"./_plugin-vue_export-helper.BCo6x5W8.js";const I=C({__name:"goods-search",props:{modelValue:{type:String,default:""},width:{type:String,default:"100%"},background:{type:String,default:""},fontSize:{type:String,default:""},tagColor:{type:String,default:"#666"},mode:{type:String,default:"jump",validator:e=>["jump","fill"].includes(e)},hiddenIcon:{type:Boolean,default:!0}},emits:["select","update:modelValue"],setup(C,{emit:I}){const x=e(!1),z=C,V=I,$=e([]),G=a({get:()=>z.modelValue,set:e=>V("update:modelValue",e)});s($,(e=>{x.value=e.length>0}));const B=()=>{$.value=[],x.value=!1},D=async e=>{var a;G.value=e.detail.value;const s=e.detail.value.trim();if(x.value=!0,s)try{const e=await g({url:w+`/search-goods?search=${encodeURIComponent(s)}`,method:"GET"});$.value="success"===(null==(a=e.data)?void 0:a.status)&&e.data.data||[]}catch(l){console.error("搜索失败:",l),$.value=[]}else $.value=[]},E=()=>{B()};return(e,a)=>{const s=_,g=y,w=h,I=k,F=S;return l(),t(i,null,[x.value?(l(),o(s,{key:0,class:"mask-layer",onClick:B})):n("",!0),u(s,{class:c(["search_tab",e.$attrs.class]),style:d({background:C.background||"#fff"})},{default:r((()=>[C.hiddenIcon?n("",!0):(l(),o(g,{key:0,class:"icon_image",src:j})),u(w,{class:"common_search_input",placeholder:"请输入娃物名称 (ㅇㅅㅇ❀)...",value:G.value,onInput:D,style:d({fontSize:C.fontSize||"22rpx"})},null,8,["value","style"]),$.value.length>0?(l(),o(g,{key:1,class:"icon_image",src:b,onClick:E})):n("",!0)])),_:1},8,["class","style"]),$.value.length>0?(l(),o(F,{key:1,class:"search_results",style:d({width:C.width}),"scroll-y":""},{default:r((()=>[(l(!0),t(i,null,m($.value,(e=>(l(),o(s,{key:e.id,class:"result_item",onClick:a=>{return s=e,"jump"===z.mode&&v({url:`/pages/goods/goods?goods_id=${s.id}`}),"fill"===z.mode&&(V("select",s),G.value=s.name,$.value=[]),void B();var s}},{default:r((()=>[e.brand_name?(l(),o(s,{key:0,class:"brand-tag"},{default:r((()=>[p(f(e.brand_name),1)])),_:2},1024)):n("",!0),u(I,{class:"goods-name"},{default:r((()=>[p(f(e.name),1)])),_:2},1024)])),_:2},1032,["onClick"])))),128))])),_:1},8,["style"])):n("",!0)],64)}}},[["__scopeId","data-v-a4ee91e3"]]);export{I as _};
