import{a3 as a,k as t,r as e,o as s,a as n,v as o,d as l,w as i,F as A,l as c,q as u,A as r,g as d,b as f,x as w,a1 as p,e as h,t as m,c as g,p as E,n as v,u as C,j as y,$ as B,a0 as I,f as b,D as x,i as k}from"./index-I3aG4WZL.js";import{_ as D}from"./view-logs.C4HVuFxK.js";import{_ as Q,r as O}from"./_plugin-vue_export-helper.DF4WgY5m.js";import{c as P,w as S,d as V,b as j,f as H}from"./config.BjeWXQ7P.js";const L=Q({__name:"setting",setup(Q){a({title:"设置"});const L=t((()=>[{label:"更改用户名",action:W,status:!!j.userInfo.password,displayValue:j.userInfo.password?"去修改":"未设置"},{label:"更改密码",action:F,status:!!j.userInfo.password,displayValue:j.userInfo.password?"去修改":"未设置"},{label:"绑定手机号",action:G,status:!!j.userInfo.tel_phone,displayValue:j.userInfo.tel_phone?j.userInfo.tel_phone.replace(/(\d{3})\d{4}(\d{4})/,"$1****$2"):"去绑定"},{label:"绑定微信",action:Y,status:!!j.userInfo.wechat_open_id,displayValue:j.userInfo.wechat_open_id?"已绑定":"去绑定"},{label:"检查更新",action:R,status:J.value.version,displayValue:q.value}]));e({});let J=e({});const X=e(!1);e(!1);const q=e("检查更新");let N=e(0);function F(){v({url:"/pages/setting/password/password"})}function G(){v({url:"/pages/setting/tel_phone/tel_phone"})}function W(){v({url:"/pages/setting/username/username"})}function Y(){j.userInfo.wechat_open_id?r({title:"已绑定微信",icon:"none"}):H().then((()=>{console.log("微信绑定成功"),r({title:"微信绑定成功",icon:"none"})})).catch((a=>{console.error("微信绑定失败:",a),r({title:"微信绑定失败",icon:"none"})}))}const R=async()=>{c().platform;{N.value++;const a=await u({url:`${S}/latest-version?version=${V}`,method:"GET"});a&&a.data&&("success"===a.data.status&&a.data.data?(q.value="有新版本:"+a.data.data.version,J.value=!0):N.value>1&&r({title:"当前已是最新版本",icon:"none"}))}};async function z(){X.value?C({title:"取消注销申请",content:"确定要取消账号注销申请吗？",success:async a=>{a.confirm&&await async function(){const a=y("token");if(!a)return void r({title:"请先登录",icon:"none"});B({title:"处理中...",mask:!0});try{const t=await u({url:`${S}/with-state/cancel-delete`,method:"POST",header:{Authorization:a}});if(I(),"success"!==t.data.status)throw new Error(t.data.msg||"取消注销失败");X.value=!1,j.userInfo.deleteApplyAt=0,r({title:"已取消注销申请",icon:"success",duration:3e3})}catch(t){I(),r({title:t.message||"操作失败，请稍后重试",icon:"none",duration:3e3})}}()}}):C({title:"申请注销账号",content:"确定要申请注销账号吗？注销后账号将不可恢复！",confirmText:"确认注销",confirmColor:"#f56c6c",success:async a=>{a.confirm&&await async function(){const a=y("token");if(!a)return void r({title:"请先登录",icon:"none"});B({title:"处理中...",mask:!0});try{const t=await u({url:`${S}/with-state/apply-delete`,method:"POST",header:{Authorization:a}});if(I(),"success"!==t.data.status)throw new Error(t.data.msg||"申请注销失败");X.value=!0,j.userInfo.deleteApplyAt=Math.floor(Date.now()/1e3),r({title:"已申请注销账号",icon:"success",duration:3e3}),setTimeout((()=>{C({title:"注销申请已提交",content:"您的账号将在30天后正式注销。在此期间您可以正常使用所有功能，并可随时取消注销申请。",showCancel:!1,confirmText:"知道了"})}),1e3)}catch(t){I(),r({title:t.message||"操作失败，请稍后重试",icon:"none",duration:3e3})}}()}})}return s((()=>{P().then((a=>{X.value=a.delete_apply_at>0})),R()})),(a,t)=>{const e=O(n("view-logs"),D),s=b,c=k,u=d;return f(),o(A,null,[l(e),l(u,{class:"settings-container"},{default:i((()=>[(f(!0),o(A,null,w(L.value,((a,t)=>(f(),g(u,{key:t,class:"menu-item",onClick:t=>a.action(a)},{default:i((()=>[l(s,{class:"menu-label"},{default:i((()=>[h(m(a.label),1)])),_:2},1024),l(u,{class:"menu-value"},{default:i((()=>[l(s,{class:x(a.status?"active":"inactive")},{default:i((()=>[h(m(a.displayValue),1)])),_:2},1032,["class"]),l(c,{class:"arrow-icon",src:"data:image/png;base64,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"})])),_:2},1024)])),_:2},1032,["onClick"])))),128)),l(u,{class:"logout-section"},{default:i((()=>[l(u,{class:"logout-btn",onClick:z,style:p({backgroundColor:X.value?"#f56c6c":"#cfcad8"})},{default:i((()=>[l(s,null,{default:i((()=>[h(m(X.value?"取消注销申请":"申请注销账号"),1)])),_:1})])),_:1},8,["style"]),X.value?(f(),g(s,{key:0,class:"deletion-notice"},{default:i((()=>[h(" 已申请注销，30天后账号将正式注销。在此之前可以正常使用，并可随时取消注销申请。 ")])),_:1})):E("",!0)])),_:1})])),_:1})],64)}}},[["__scopeId","data-v-e3a4097b"]]);export{L as default};
