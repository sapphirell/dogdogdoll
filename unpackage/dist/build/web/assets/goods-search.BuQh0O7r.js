import{r as e,m as a,N as s,b as l,k as t,c as o,u as n,d as u,w as r,a0 as d,C as c,F as i,l as m,e as p,t as f,v as g,n as v,g as _,i as y,M as h,f as k,S}from"./index-6ojkiy1R.js";import{_ as b}from"./search.CsIL0f2m.js";import{_ as j}from"./cancel.CnEdunnH.js";import{w as C}from"./config.Bhvn_Gfs.js";import{_ as w}from"./_plugin-vue_export-helper.BCo6x5W8.js";const I=w({__name:"goods-search",props:{modelValue:{type:String,default:""},width:{type:String,default:"100%"},background:{type:String,default:""},fontSize:{type:String,default:""},tagColor:{type:String,default:"#666"},mode:{type:String,default:"jump",validator:e=>["jump","fill"].includes(e)},hiddenIcon:{type:Boolean,default:!0}},emits:["select","update:modelValue"],setup(w,{emit:I}){const x=e(!1),V=w,z=I,$=e([]),E=a({get:()=>V.modelValue,set:e=>z("update:modelValue",e)});s($,(e=>{x.value=e.length>0}));const B=()=>{$.value=[],x.value=!1},D=async e=>{var a;E.value=e.detail.value;const s=e.detail.value.trim();if(x.value=!0,s)try{const e=await g({url:C+`/search-goods?search=${encodeURIComponent(s)}`,method:"GET"});$.value="success"===(null==(a=e.data)?void 0:a.status)&&e.data.data||[]}catch(l){console.error("搜索失败:",l),$.value=[]}else $.value=[]},F=()=>{B()};return(e,a)=>{const s=_,g=y,C=h,I=k,G=S;return l(),t(i,null,[x.value?(l(),o(s,{key:0,class:"mask-layer",onClick:B})):n("",!0),u(s,{class:c(["search_tab",e.$attrs.class]),style:d({background:w.background||"#fff"})},{default:r((()=>[w.hiddenIcon?n("",!0):(l(),o(g,{key:0,class:"icon_image",src:b})),u(C,{class:"common_search_input",placeholder:"请输入娃物名称 (ㅇㅅㅇ❀)...",value:E.value,onInput:D,style:d({fontSize:w.fontSize||"22rpx"})},null,8,["value","style"]),$.value.length>0?(l(),o(g,{key:1,class:"icon_image",src:j,onClick:F})):n("",!0)])),_:1},8,["class","style"]),$.value.length>0?(l(),o(G,{key:1,class:"search_results",style:d({width:w.width}),"scroll-y":""},{default:r((()=>[(l(!0),t(i,null,m($.value,(e=>(l(),o(s,{key:e.id,class:"result_item",onClick:a=>{return s=e,"jump"===V.mode&&v({url:`/pages/goods/goods?goods_id=${s.id}`}),"fill"===V.mode&&(z("select",s),E.value=s.name,$.value=[]),void B();var s}},{default:r((()=>[e.brand_name?(l(),o(s,{key:0,class:"brand-tag"},{default:r((()=>[p(f(e.brand_name),1)])),_:2},1024)):n("",!0),u(I,{class:"goods-name"},{default:r((()=>[p(f(e.name),1)])),_:2},1024)])),_:2},1032,["onClick"])))),128))])),_:1},8,["style"])):n("",!0)],64)}}},[["__scopeId","data-v-a4ee91e3"]]);export{I as _};
