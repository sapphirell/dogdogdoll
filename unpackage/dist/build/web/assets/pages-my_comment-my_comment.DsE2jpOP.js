import{r as a,o as e,v as t,j as s,a2 as l,c as o,w as n,g as c,b as r,d as i,k as u,l as d,F as m,e as _,u as g,f,S as p,t as v,C as h,A as k,n as b,i as y}from"./index-6ojkiy1R.js";import{w as S}from"./config.Bhvn_Gfs.js";import{_ as $}from"./_plugin-vue_export-helper.BCo6x5W8.js";const w=$({__name:"my_comment",setup($){const w=a([]),x=a(1),C=a(10),j=a(0),F=a(!1),D=a(!1),z={1:{name:"品牌",class:"brand"},2:{name:"商品",class:"goods"},3:{name:"搭配",class:"collocation"},4:{name:"资讯",class:"news"},5:{name:"树洞",class:"treehole"},6:{name:"展示柜",class:"collocation"},7:{name:"文章",class:"collocation"}};e((()=>{A()}));const A=async(a=!1)=>{if(!F.value&&!D.value){F.value=!0;try{const e=await t({url:`${S}/with-state/my-comment`,method:"GET",header:{Authorization:s("token")},data:{page:x.value,page_size:C.value}});if("success"===e.data.status){const t=e.data.data;w.value=a?[...w.value,...t.comment_list]:t.comment_list,j.value=t.total,x.value++,D.value=w.value.length>=j.value}}finally{F.value=!1}}},E=()=>{D.value||A(!0)},M=a=>{let e="";const t=a.relation_id;switch(a.type){case 1:e=`/pages/brand/brand?brand_id=${t}`;break;case 2:e=`/pages/goods/goods?goods_id=${t}`;break;case 3:e=`/pages/collocation_share/collocation_share?collocation_id=${t}&origin=1`;break;case 4:e=`/pages/sale_news/sale_news?id=${t}&brand_id=0`;break;case 5:e=`/pages/treehole_detail/treehole_detail?id=${t}`;break;case 6:e=`/pages/collocation_share/collocation_share?collocation_id=${t}&origin=2`;break;default:return void k({title:"未知类型",icon:"none"})}e&&b({url:e})},G=a=>{var e;return(null==(e=z[a])?void 0:e.name)||"未知"};function H(a){const e=new Date(1e3*a);return`${e.getFullYear()}-${(e.getMonth()+1).toString().padStart(2,"0")}-${e.getDate().toString().padStart(2,"0")} ${e.getHours().toString().padStart(2,"0")}:${e.getMinutes().toString().padStart(2,"0")}:${e.getSeconds().toString().padStart(2,"0")}`}return l({title:"我的评论"}),(a,e)=>{const t=y,s=f,l=c,k=p;return r(),o(l,{class:"page-container"},{default:n((()=>[i(k,{class:"comment-list","scroll-y":"",onScrolltolower:E,"show-scrollbar":!1},{default:n((()=>[(r(!0),u(m,null,d(w.value,((a,e)=>(r(),o(l,{key:e,class:"comment-item",onClick:e=>M(a)},{default:n((()=>[i(l,{class:"user-info"},{default:n((()=>[i(t,{class:"avatar",src:a.avatar||"/static/default-avatar.png",mode:"aspectFill"},null,8,["src"]),i(l,{class:"user-meta"},{default:n((()=>[i(s,{class:"username"},{default:n((()=>[_(v(a.username),1)])),_:2},1024),i(s,{class:"time"},{default:n((()=>[_(v(H(a.created_at)),1)])),_:2},1024)])),_:2},1024)])),_:2},1024),i(l,{class:"content-box"},{default:n((()=>[i(s,{class:"content"},{default:n((()=>[_(v(a.comment),1)])),_:2},1024)])),_:2},1024),i(l,{class:"target-box",onClick:e=>M(a)},{default:n((()=>[a.target_image?(r(),o(t,{key:0,class:"target-image",src:a.target_image,mode:"aspectFill"},null,8,["src"])):g("",!0),i(l,{class:"target-info"},{default:n((()=>{return[i(l,{class:h(["type-tag",(e=a.type,(null==(t=z[e])?void 0:t.class)||"")])},{default:n((()=>[_(v(G(a.type)),1)])),_:2},1032,["class"]),i(s,{class:"target-name"},{default:n((()=>[_(v(a.target_name),1)])),_:2},1024)];var e,t})),_:2},1024)])),_:2},1032,["onClick"])])),_:2},1032,["onClick"])))),128)),i(l,{class:"loading-status"},{default:n((()=>[F.value?(r(),o(s,{key:0,class:"loading-text"},{default:n((()=>[_("加载中...")])),_:1})):g("",!0),D.value?(r(),o(s,{key:1,class:"no-more-text"},{default:n((()=>[_("没有更多了")])),_:1})):g("",!0)])),_:1})])),_:1})])),_:1})}}},[["__scopeId","data-v-70964898"]]);export{w as default};
