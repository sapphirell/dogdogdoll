import{g as e,M as a,_ as t,c as l,w as s,l as i,k as c,f as o,o as n,p as u,a as r,b as d,t as m,d as _,r as p,F as g,z as f,i as v,e as h,x as $}from"./index-B55GPRQF.js";import{c as k,b as w}from"./uni-app.es.CzHle-z4.js";import{w as y}from"./config.BIUptOrH.js";import{_ as b}from"./_plugin-vue_export-helper.BCo6x5W8.js";const F=b({__name:"user_page",props:["uid"],setup(b){const F=e(0),S=e(["搭配","娃柜","点评"]),x=b,C=e({avatar:"",user_name:"加载中..."}),j=e([]),z=e([]),D=e([]),L=e([{page:1,pageSize:10,total:0,loading:!1,finished:!1},{page:1,pageSize:10,total:0,loading:!1,finished:!1},{page:1,pageSize:10,total:0,loading:!1,finished:!1}]);a(F,(e=>{L.value[e];0===[j,z,D][e].value.length&&M()}));const M=async()=>{const e=L.value[F.value];if(!e.loading&&!e.finished){e.loading=!0;try{let a,t;switch(F.value){case 0:a=`/user-info/collection?user_id=${x.uid}&page=${e.page}`,t="List";break;case 1:a=`/user-info/show-case?user_id=${x.uid}&page=${e.page}`,t="List";break;case 2:a=`/user-info/posts?user_id=${x.uid}&page=${e.page}`,t="comment_list"}console.log(`${y}${a}`);const l=await i({url:`${y}${a}`});if("success"===l.data.status){const a=l.data.data,s=a[t].map((e=>{var a,t,l;switch(F.value){case 0:return{id:e.id,cover:(null==(a=e.image_urls)?void 0:a.split(",")[0])||"",images:(null==(t=e.image_urls)?void 0:t.split(","))||[],title:e.title,time:e.created_at};case 1:return{id:e.id,cover:(null==(l=e.image_urls)?void 0:l.split(",")[0])||"",title:e.name,desc:e.description,time:e.created_at};case 2:return{id:e.id,product_thumb:e.target_image,product_name:e.target_name,content:e.comment,create_time:T(e.created_at)}}})),i=[j,z,D][F.value];i.value=[...i.value,...s],e.total=a.total,e.finished=i.value.length>=a.total,e.page++}}catch(a){console.log(a),c({title:"数据加载失败",icon:"none"})}finally{e.loading=!1}}},T=e=>{const a=new Date(1e3*e);return`${a.getFullYear()}-${(a.getMonth()+1).toString().padStart(2,"0")}-${a.getDate().toString().padStart(2,"0")}`};return t({title:"用户主页"}),k((()=>{(async()=>{try{const e=await i({url:`${y}/user-info?uid=${x.uid}`});"success"===e.data.status&&(C.value=e.data.data)}catch(e){c({title:"用户信息加载失败",icon:"none"})}})(),M()})),w((()=>{M()})),(e,a)=>{const t=v,i=h,c=o;return n(),l(c,{class:"page-container"},{default:s((()=>[u("meta",{name:"theme-color",content:"#F8F8F8"}),r(c,{class:"header_container"},{default:s((()=>[r(c,{class:"user-info-container"},{default:s((()=>[r(c,{class:"user-info-box"},{default:s((()=>[r(t,{class:"avatar",src:C.value.avatar,mode:"aspectFill"},null,8,["src"]),r(i,{class:"username"},{default:s((()=>[d(m(C.value.user_name),1)])),_:1})])),_:1})])),_:1})])),_:1}),r(c,{class:"content"},{default:s((()=>[r(c,{class:"tabs-container"},{default:s((()=>[r(c,{class:"tabs"},{default:s((()=>[(n(!0),_(g,null,p(S.value,((e,a)=>(n(),l(c,{key:a,class:$(["tab-item font-alimamashuhei",{active:F.value===a}]),onClick:e=>F.value=a},{default:s((()=>[d(m(e),1)])),_:2},1032,["class","onClick"])))),128))])),_:1})])),_:1}),0===F.value?(n(),l(c,{key:0,class:"collocation-list"},{default:s((()=>[(n(!0),_(g,null,p(j.value,((a,o)=>(n(),l(c,{key:o,class:"collocation-item item-image-container",onClick:t=>e.navigateTo(`/pages/collocation_share/collocation_share?collocation_id=${a.id}`)},{default:s((()=>[r(t,{class:"item-image",src:a.cover,mode:"aspectFill"},null,8,["src"]),r(i,{class:"item-title"},{default:s((()=>[d(m(a.title),1)])),_:2},1024)])),_:2},1032,["onClick"])))),128))])),_:1})):f("",!0),1===F.value?(n(),l(c,{key:1,class:"doll-list"},{default:s((()=>[(n(!0),_(g,null,p(z.value,((a,o)=>(n(),l(c,{key:o,class:"doll-item item-image-container",onClick:t=>e.navigateTo(`/pages/user_doll/user_doll?id=${a.id}`)},{default:s((()=>[r(t,{class:"item-image",src:a.cover,mode:"aspectFill"},null,8,["src"]),r(i,{class:"item-title"},{default:s((()=>[d(m(a.title),1)])),_:2},1024),r(i,{class:"item-price"},{default:s((()=>[d("¥"+m(a.price),1)])),_:2},1024)])),_:2},1032,["onClick"])))),128))])),_:1})):f("",!0),2===F.value?(n(),l(c,{key:2,class:"review-list"},{default:s((()=>[(n(!0),_(g,null,p(D.value,((e,a)=>(n(),l(c,{key:a,class:"review-item"},{default:s((()=>[r(t,{class:"product-thumb",src:e.product_thumb,mode:"aspectFill"},null,8,["src"]),r(c,{class:"review-content"},{default:s((()=>[r(i,{class:"product-name"},{default:s((()=>[d(m(e.product_name),1)])),_:2},1024),r(i,{class:"review-text"},{default:s((()=>[d(m(e.content),1)])),_:2},1024),r(i,{class:"review-time"},{default:s((()=>[d(m(e.create_time),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)))),128))])),_:1})):f("",!0)])),_:1})])),_:1})}}},[["__scopeId","data-v-6636d08d"]]);export{F as default};
