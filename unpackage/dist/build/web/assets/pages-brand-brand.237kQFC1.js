import{o as e,c as t,w as o,Q as l,j as s,h as a,f as n,R as i,m as c,a as d,e as u,F as f,r,U as _,g as p,s as m,k as h,p as g,V as y,q as b,u as v,A as x,v as S,b as w,t as k,d as C,B as z,G as M,i as N,C as P,O as R,n as $,M as I}from"./index-D8OtiTi9.js";import{_ as V}from"./_plugin-vue_export-helper.BCo6x5W8.js";import{r as F}from"./uni-app.es.JSb8JX9v.js";import{w as T,g as B,v as j}from"./config.BPuNpLTQ.js";const L=[{font_class:"arrow-down",unicode:""},{font_class:"arrow-left",unicode:""},{font_class:"arrow-right",unicode:""},{font_class:"arrow-up",unicode:""},{font_class:"auth",unicode:""},{font_class:"auth-filled",unicode:""},{font_class:"back",unicode:""},{font_class:"bars",unicode:""},{font_class:"calendar",unicode:""},{font_class:"calendar-filled",unicode:""},{font_class:"camera",unicode:""},{font_class:"camera-filled",unicode:""},{font_class:"cart",unicode:""},{font_class:"cart-filled",unicode:""},{font_class:"chat",unicode:""},{font_class:"chat-filled",unicode:""},{font_class:"chatboxes",unicode:""},{font_class:"chatboxes-filled",unicode:""},{font_class:"chatbubble",unicode:""},{font_class:"chatbubble-filled",unicode:""},{font_class:"checkbox",unicode:""},{font_class:"checkbox-filled",unicode:""},{font_class:"checkmarkempty",unicode:""},{font_class:"circle",unicode:""},{font_class:"circle-filled",unicode:""},{font_class:"clear",unicode:""},{font_class:"close",unicode:""},{font_class:"closeempty",unicode:""},{font_class:"cloud-download",unicode:""},{font_class:"cloud-download-filled",unicode:""},{font_class:"cloud-upload",unicode:""},{font_class:"cloud-upload-filled",unicode:""},{font_class:"color",unicode:""},{font_class:"color-filled",unicode:""},{font_class:"compose",unicode:""},{font_class:"contact",unicode:""},{font_class:"contact-filled",unicode:""},{font_class:"down",unicode:""},{font_class:"bottom",unicode:""},{font_class:"download",unicode:""},{font_class:"download-filled",unicode:""},{font_class:"email",unicode:""},{font_class:"email-filled",unicode:""},{font_class:"eye",unicode:""},{font_class:"eye-filled",unicode:""},{font_class:"eye-slash",unicode:""},{font_class:"eye-slash-filled",unicode:""},{font_class:"fire",unicode:""},{font_class:"fire-filled",unicode:""},{font_class:"flag",unicode:""},{font_class:"flag-filled",unicode:""},{font_class:"folder-add",unicode:""},{font_class:"folder-add-filled",unicode:""},{font_class:"font",unicode:""},{font_class:"forward",unicode:""},{font_class:"gear",unicode:""},{font_class:"gear-filled",unicode:""},{font_class:"gift",unicode:""},{font_class:"gift-filled",unicode:""},{font_class:"hand-down",unicode:""},{font_class:"hand-down-filled",unicode:""},{font_class:"hand-up",unicode:""},{font_class:"hand-up-filled",unicode:""},{font_class:"headphones",unicode:""},{font_class:"heart",unicode:""},{font_class:"heart-filled",unicode:""},{font_class:"help",unicode:""},{font_class:"help-filled",unicode:""},{font_class:"home",unicode:""},{font_class:"home-filled",unicode:""},{font_class:"image",unicode:""},{font_class:"image-filled",unicode:""},{font_class:"images",unicode:""},{font_class:"images-filled",unicode:""},{font_class:"info",unicode:""},{font_class:"info-filled",unicode:""},{font_class:"left",unicode:""},{font_class:"link",unicode:""},{font_class:"list",unicode:""},{font_class:"location",unicode:""},{font_class:"location-filled",unicode:""},{font_class:"locked",unicode:""},{font_class:"locked-filled",unicode:""},{font_class:"loop",unicode:""},{font_class:"mail-open",unicode:""},{font_class:"mail-open-filled",unicode:""},{font_class:"map",unicode:""},{font_class:"map-filled",unicode:""},{font_class:"map-pin",unicode:""},{font_class:"map-pin-ellipse",unicode:""},{font_class:"medal",unicode:""},{font_class:"medal-filled",unicode:""},{font_class:"mic",unicode:""},{font_class:"mic-filled",unicode:""},{font_class:"micoff",unicode:""},{font_class:"micoff-filled",unicode:""},{font_class:"minus",unicode:""},{font_class:"minus-filled",unicode:""},{font_class:"more",unicode:""},{font_class:"more-filled",unicode:""},{font_class:"navigate",unicode:""},{font_class:"navigate-filled",unicode:""},{font_class:"notification",unicode:""},{font_class:"notification-filled",unicode:""},{font_class:"paperclip",unicode:""},{font_class:"paperplane",unicode:""},{font_class:"paperplane-filled",unicode:""},{font_class:"person",unicode:""},{font_class:"person-filled",unicode:""},{font_class:"personadd",unicode:""},{font_class:"personadd-filled",unicode:""},{font_class:"personadd-filled-copy",unicode:""},{font_class:"phone",unicode:""},{font_class:"phone-filled",unicode:""},{font_class:"plus",unicode:""},{font_class:"plus-filled",unicode:""},{font_class:"plusempty",unicode:""},{font_class:"pulldown",unicode:""},{font_class:"pyq",unicode:""},{font_class:"qq",unicode:""},{font_class:"redo",unicode:""},{font_class:"redo-filled",unicode:""},{font_class:"refresh",unicode:""},{font_class:"refresh-filled",unicode:""},{font_class:"refreshempty",unicode:""},{font_class:"reload",unicode:""},{font_class:"right",unicode:""},{font_class:"scan",unicode:""},{font_class:"search",unicode:""},{font_class:"settings",unicode:""},{font_class:"settings-filled",unicode:""},{font_class:"shop",unicode:""},{font_class:"shop-filled",unicode:""},{font_class:"smallcircle",unicode:""},{font_class:"smallcircle-filled",unicode:""},{font_class:"sound",unicode:""},{font_class:"sound-filled",unicode:""},{font_class:"spinner-cycle",unicode:""},{font_class:"staff",unicode:""},{font_class:"staff-filled",unicode:""},{font_class:"star",unicode:""},{font_class:"star-filled",unicode:""},{font_class:"starhalf",unicode:""},{font_class:"trash",unicode:""},{font_class:"trash-filled",unicode:""},{font_class:"tune",unicode:""},{font_class:"tune-filled",unicode:""},{font_class:"undo",unicode:""},{font_class:"undo-filled",unicode:""},{font_class:"up",unicode:""},{font_class:"top",unicode:""},{font_class:"upload",unicode:""},{font_class:"upload-filled",unicode:""},{font_class:"videocam",unicode:""},{font_class:"videocam-filled",unicode:""},{font_class:"vip",unicode:""},{font_class:"vip-filled",unicode:""},{font_class:"wallet",unicode:""},{font_class:"wallet-filled",unicode:""},{font_class:"weibo",unicode:""},{font_class:"weixin",unicode:""}];const O=V({name:"UniIcons",emits:["click"],props:{type:{type:String,default:""},color:{type:String,default:"#333333"},size:{type:[Number,String],default:16},customPrefix:{type:String,default:""},fontFamily:{type:String,default:""}},data:()=>({icons:L}),computed:{unicode(){let e=this.icons.find((e=>e.font_class===this.type));return e?e.unicode:""},iconSize(){return"number"==typeof(e=this.size)||/^[0-9]*$/g.test(e)?e+"px":e;var e},styleObj(){return""!==this.fontFamily?`color: ${this.color}; font-size: ${this.iconSize}; font-family: ${this.fontFamily};`:`color: ${this.color}; font-size: ${this.iconSize};`}},methods:{_onClick(){this.$emit("click")}}},[["render",function(i,c,d,u,f,r){const _=n;return e(),t(_,{style:s(r.styleObj),class:a(["uni-icons",["uniui-"+d.type,d.customPrefix,d.customPrefix?d.type:""]]),onClick:r._onClick},{default:o((()=>[l(i.$slots,"default",{},void 0,!0)])),_:3},8,["style","class","onClick"])}],["__scopeId","data-v-1320ff52"]]);const X=V({name:"UniRate",props:{isFill:{type:[Boolean,String],default:!0},color:{type:String,default:"#ececec"},activeColor:{type:String,default:"#ffca3e"},disabledColor:{type:String,default:"#c0c0c0"},size:{type:[Number,String],default:24},value:{type:[Number,String],default:0},modelValue:{type:[Number,String],default:0},max:{type:[Number,String],default:5},margin:{type:[Number,String],default:0},disabled:{type:[Boolean,String],default:!1},readonly:{type:[Boolean,String],default:!1},allowHalf:{type:[Boolean,String],default:!1},touchable:{type:[Boolean,String],default:!0}},data:()=>({valueSync:"",userMouseFristMove:!0,userRated:!1,userLastRate:1}),watch:{value(e){this.valueSync=Number(e)},modelValue(e){this.valueSync=Number(e)}},computed:{stars(){const e=this.valueSync?this.valueSync:0,t=[],o=Math.floor(e),l=Math.ceil(e);for(let s=0;s<this.max;s++)o>s?t.push({activeWitch:"100%"}):l-1===s?t.push({activeWitch:100*(e-o)+"%"}):t.push({activeWitch:"0"});return t},marginNumber(){return Number(this.margin)}},created(){this.valueSync=Number(this.value||this.modelValue),this._rateBoxLeft=0,this._oldValue=null},mounted(){setTimeout((()=>{this._getSize()}),100),this.PC=this.IsPC()},methods:{touchstart(e){if(this.IsPC())return;if(this.readonly||this.disabled)return;const{clientX:t,screenX:o}=e.changedTouches[0];this._getRateCount(t||o)},touchmove(e){if(this.IsPC())return;if(this.readonly||this.disabled||!this.touchable)return;const{clientX:t,screenX:o}=e.changedTouches[0];this._getRateCount(t||o)},mousedown(e){if(!this.IsPC())return;if(this.readonly||this.disabled)return;const{clientX:t}=e;this.userLastRate=this.valueSync,this._getRateCount(t),this.userRated=!0},mousemove(e){if(!this.IsPC())return;if(this.userRated)return;if(this.userMouseFristMove&&(console.log("---mousemove----",this.valueSync),this.userLastRate=this.valueSync,this.userMouseFristMove=!1),this.readonly||this.disabled||!this.touchable)return;const{clientX:t}=e;this._getRateCount(t)},mouseleave(e){this.IsPC()&&(this.readonly||this.disabled||!this.touchable||(this.userRated?this.userRated=!1:this.valueSync=this.userLastRate))},IsPC(){var e=navigator.userAgent,t=["Android","iPhone","SymbianOS","Windows Phone","iPad","iPod"],o=!0;for(let l=0;l<t.length-1;l++)if(e.indexOf(t[l])>0){o=!1;break}return o},_getRateCount(e){this._getSize();const t=Number(this.size);if(isNaN(t))return new Error("size 属性只能设置为数字");const o=e-this._rateBoxLeft;let l=parseInt(o/(t+this.marginNumber));l=l<0?0:l,l=l>this.max?this.max:l;const s=parseInt(o-(t+this.marginNumber)*l);let a=0;(this._oldValue!==l||this.PC)&&(this._oldValue=l,a=this.allowHalf?s>t/2?l+1:l+.5:l+1,a=Math.max(.5,Math.min(a,this.max)),this.valueSync=a,this._onChange())},_onChange(){this.$emit("input",this.valueSync),this.$emit("update:modelValue",this.valueSync),this.$emit("change",{value:this.valueSync})},_getSize(){i().in(this).select(".uni-rate").boundingClientRect().exec((e=>{e&&(this._rateBoxLeft=e[0].left)}))}}},[["render",function(l,n,i,m,h,g){const y=F(c("uni-icons"),O),b=p;return e(),t(b,null,{default:o((()=>[d(b,{ref:"uni-rate",class:"uni-rate"},{default:o((()=>[(e(!0),u(f,null,r(g.stars,((l,n)=>(e(),t(b,{class:a(["uni-rate__icon",{"uni-cursor-not-allowed":i.disabled}]),style:s({"margin-right":g.marginNumber+"px"}),key:n,onTouchstart:_(g.touchstart,["stop"]),onTouchmove:_(g.touchmove,["stop"]),onMousedown:_(g.mousedown,["stop"]),onMousemove:_(g.mousemove,["stop"]),onMouseleave:g.mouseleave},{default:o((()=>[d(y,{color:i.color,size:i.size,type:i.isFill?"star-filled":"star"},null,8,["color","size","type"]),d(b,{style:s({width:l.activeWitch}),class:"uni-rate__icon-on"},{default:o((()=>[d(y,{color:i.disabled?i.disabledColor:i.activeColor,size:i.size,type:"star-filled"},null,8,["color","size"])])),_:2},1032,["style"])])),_:2},1032,["class","style","onTouchstart","onTouchmove","onMousedown","onMousemove","onMouseleave"])))),128))])),_:1},512)])),_:1})}],["__scopeId","data-v-06ce50f7"]]),A=V({__name:"brand",props:["brand_id"],setup(l){const s=l;console.log(s),m({});let i=h(""),_=h(0),V=h(!1);function L(){0!=_.value?_.value>5?b({title:"评分不能大于5",icon:"none"}):(console.log(_.value,s.brand_id),j(1,_.value,s.brand_id)):b({title:"请先评分",icon:"none"})}function O(e){const t=new Date(1e3*e),o=t.getFullYear(),l=(t.getMonth()+1).toString().padStart(2,"0"),s=t.getDate().toString().padStart(2,"0"),a=t.getHours().toString().padStart(2,"0"),n=t.getMinutes().toString().padStart(2,"0");return t.getSeconds().toString().padStart(2,"0"),`${o}-${l}-${s} ${a}:${n}`}function A(){g({url:T+"/brand-goods?brand_id="+s.brand_id+"&page="+q.value,method:"GET",timeout:5e3,success:e=>{console.log(e.data.data),W.value.page_index=e.data.data.page_index,W.value.total=e.data.data.total,W.value.goods_list=W.value.goods_list?W.value.goods_list.concat(e.data.data.goods_list):e.data.data.goods_list,e.data.data.goods_list.length>0&&(q.value+=1),0==e.data.data.goods_list.length&&q.value>1&&b({title:"没有更多数据了",icon:"none"})},fail:e=>{console.log(e),b({title:"网络请求失败",icon:"none"})}})}function E(){g({url:T+"/brand-comment?brand_id="+s.brand_id+"&page="+Q.value,method:"GET",timeout:5e3,success:e=>{console.log(e.data.data),D.value.page_index=e.data.data.page_index,D.value.total=e.data.data.total,D.value.comment_list=D.value.comment_list?D.value.comment_list.concat(e.data.data.comment_list):e.data.data.comment_list,null!=e.data.data.comment_list&&(e.data.data.comment_list.length>0&&(Q.value+=1),0==e.data.data.comment_list.length&&Q.value>1&&b({title:"没有更多数据了",icon:"none"}))},fail:e=>{console.log(e),b({title:"网络请求失败",icon:"none"})}})}function G(e){V.value=!V.value}function U(){let e=x("token");e?""!=i.value?g({url:T+"/with-state/add-comment",method:"POST",header:{Authorization:e},data:{target_id:parseInt(s.brand_id),content:i.value,type:1},success:e=>(console.log(e.data),"success"==e.data.status?(b({title:"评论成功",icon:"success"}),i.value="",Q.value=1,D.value={},void E()):void b({title:e.data.msg,icon:"none"})),fail:e=>{console.log(e),b({title:"网络请求失败",icon:"none"})}}):b({title:"请输入评论内容",icon:"none"}):b({title:"请先登录",icon:"none"})}let W=h({}),q=h(1),H=h({}),D=h({}),Q=h(1);return g({url:T+"/brand-info?id="+s.brand_id,method:"GET",timeout:5e3,success:e=>{console.log(e.data.data),H.value=e.data.data,y({title:e.data.data.brand_name})},fail:e=>{console.log(e),b({title:"网络请求失败",icon:"none"})},complete:()=>{v()}}),A(),E(),function(e,t){let o=x("token");o&&B.isLogin&&g({url:T+"/with-state/my-vote-record",method:"GET",header:{Authorization:o,"Content-Type":"application/json"},data:{target_id:parseInt(t),type:e},success:e=>(console.log(e.data.data),"success"==e.data.status?(_.value=e.data.data.score,e.data.data.score):(b({title:e.data.msg,icon:"none"}),0)),fail:e=>(console.log(e),b({title:"网络请求失败",icon:"none"}),0)})}(1,s.brand_id),(l,s)=>{const m=N,h=n,g=p,y=F(c("uni-rate"),X),b=I,v=P,x=R;return e(),t(g,null,{default:o((()=>[d(m,{src:S(H).logo_image,mode:"aspectFit",class:"brand_logo"},null,8,["src"]),d(g,{class:"body"},{default:o((()=>[d(g,null,{default:o((()=>[d(h,{style:{float:"left","font-size":"20px"},selectable:"true","user-select":"true"},{default:o((()=>[w(k(S(H).brand_name),1)])),_:1}),d(h,{style:{float:"right",margin:"5px 0px"}},{default:o((()=>[w(k(S(H).country_name)+" / "+k(S(H).type),1)])),_:1}),d(g,{style:{clear:"both"}})])),_:1}),d(g,{onClick:s[0]||(s[0]=e=>G())},{default:o((()=>[d(y,{style:{"margin-top":"5px",float:"left"},value:S(H).score,"allow-half":"true","disabled-color":"rgb(255 157 219)"},null,8,["value"]),d(h,{style:{float:"left","margin-left":"20px",position:"relative",top:"5px"}},{default:o((()=>[w(k(S(H).score)+"（"+k(S(H).vote_number)+"次评分）",1)])),_:1}),d(g,{style:{clear:"both"}})])),_:1}),d(g,{style:{"margin-top":"15px"}},{default:o((()=>[d(h,null,{default:o((()=>[w("别名："+k(S(H).nickname_list),1)])),_:1})])),_:1}),d(g,{style:{"margin-top":"10px"}},{default:o((()=>[d(h,null,{default:o((()=>[w("简介："+k(S(H).description),1)])),_:1})])),_:1}),C("div",{style:{clear:"both"}}),d(h,{style:{color:"rgb(100, 198, 220)",display:"block",margin:"20px 0px"}},{default:o((()=>[w("收录作品 ("+k(S(W).total)+")",1)])),_:1}),d(g,{class:"brand_goods"},{default:o((()=>[(e(!0),u(f,null,r(S(W).goods_list,((l,s)=>(e(),t(g,{class:"brand_goods_item",style:{},key:l.id},{default:o((()=>[d(b,{onClick:e=>{return t=l.id,void $({url:"/pages/goods/goods?goods_id="+t});var t}},{default:o((()=>[d(m,{style:{},src:l.goods_images[0],mode:"aspectFit",class:"brand_goods_image"},null,8,["src"])])),_:2},1032,["onClick"])])),_:2},1024)))),128))])),_:1}),d(v,{class:"load_more",onClick:A},{default:o((()=>[w("加载更多")])),_:1}),d(g,null,{default:o((()=>[d(h,{style:{color:"rgb(100, 198, 220)",display:"block",margin:"20px 0px"}},{default:o((()=>[w("讨论 ("+k(S(D).total)+")",1)])),_:1}),S(D).comment_list?(e(),t(g,{key:0},{default:o((()=>[(e(!0),u(f,null,r(S(D).comment_list,((l,s)=>(e(),t(g,{class:"comment_item",key:l.id,style:{"margin-bottom":"20px"}},{default:o((()=>[d(g,{style:{float:"left",width:"80px",padding:"0px 10px 10px 0px"}},{default:o((()=>[d(m,{style:{width:"50px",height:"50px","border-radius":"100%",display:"block",margin:"10px"},src:l.avatar,mode:"aspectFill"},null,8,["src"]),d(h,{style:{display:"block","white-space":"nowrap",overflow:"hidden","text-overflow":"ellipsis"}},{default:o((()=>[w(k(l.username),1)])),_:2},1024)])),_:2},1024),d(g,{style:{float:"left",padding:"15px 15px 30px 15px",background:"rgb(245 245 245)",width:"calc(100vw - 170px)","min-height":"60px","border-radius":"15px",position:"relative",top:"2px"}},{default:o((()=>[d(h,{style:{width:"100%","white-space":"normal","word-break":"break-all"}},{default:o((()=>[w(k(l.comment),1)])),_:2},1024),d(h,{style:{color:"#888","font-size":"12px",position:"absolute",bottom:"3px",left:"15px"}},{default:o((()=>[w(k(O(l.created_at))+" floor#"+k(l.floor),1)])),_:2},1024)])),_:2},1024),d(g,{style:{clear:"both"}})])),_:2},1024)))),128)),d(v,{class:"load_more",onClick:E},{default:o((()=>[w("加载更多")])),_:1})])),_:1})):z("",!0)])),_:1})])),_:1}),d(g,{style:{height:"80px"}}),d(g,{class:a(["modal_shadow",{none:!S(V)}]),onClick:s[2]||(s[2]=e=>G())},{default:o((()=>[d(g,{class:"modal_box"},{default:o((()=>[d(g,null,{default:o((()=>[d(h,{style:{"font-size":"25px",color:"#7b6d6d",width:"100%","text-align":"center","margin-bottom":"13px",display:"block"}},{default:o((()=>[w("您的评分 "+k(S(_)),1)])),_:1}),d(y,{modelValue:S(_),"onUpdate:modelValue":s[1]||(s[1]=e=>M(_)?_.value=e:_=e),"allow-half":"true",style:{"margin-top":"5px",float:"left"},size:"45"},null,8,["modelValue"])])),_:1}),d(g,{style:{clear:"both"}}),d(v,{style:{display:"block",width:"100px",position:"absolute",bottom:"0px",right:"20px"},class:"light_button",onClick:L},{default:o((()=>[d(h,{style:{color:"#fff"}},{default:o((()=>[w("提交")])),_:1})])),_:1})])),_:1})])),_:1},8,["class"]),d(g,{class:"bottom_tab",style:{}},{default:o((()=>[d(x,{class:"comment_input",modelValue:S(i),"onUpdate:modelValue":s[3]||(s[3]=e=>M(i)?i.value=e:i=e)},null,8,["modelValue"]),d(v,{style:{},onClick:U},{default:o((()=>[w("写评论")])),_:1})])),_:1})])),_:1})}}},[["__scopeId","data-v-50a20f48"]]);export{A as default};
