import{g as a,ah as s,ac as l,n as e,l as t,C as o,m as c,$ as i,c as d,w as n,f as u,o as r,a as g,d as _,r as m,F as f,b as p,v,e as b,S as k,q as y,t as h,z as w,i as C,H as z}from"./index-CfMR_IzQ.js";import{b as $,w as x}from"./config.BX5UpUDr.js";import{_ as F}from"./_plugin-vue_export-helper.BCo6x5W8.js";const j=F({__name:"user_like",setup(F){const j=a([{type:1,name:"商品"},{type:2,name:"品牌"},{type:3,name:"搭配"},{type:4,name:"展示柜"}]),A=a(1),S=a([]),T=a(!1),q=a(!1),B=s({page:1,page_size:8,total:0});l((async()=>{await E(),G()}));const E=async()=>{await $()||e({url:"/pages/login/login"})},G=async()=>{if(!T.value&&!q.value){T.value=!0;try{const a=await t({url:`${x}/with-state/user-likes`,method:"GET",data:{type:A.value,page:B.page,page_size:B.page_size},header:{Authorization:o("token")}});if("success"===a.data.status){const s=a.data.data.list;S.value=[...S.value,...s],B.total=a.data.data.total,a.data.data.list.length?q.value=!1:q.value=!0,B.page+=1}}catch(a){c({title:"加载失败",icon:"none"})}finally{T.value=!1}}},H=()=>{q.value?console.log("no more"):G()},I=()=>{B.page=1,S.value=[],q.value=!1},O=a=>(null==a?void 0:a.length)>0?a[0]:"",P=a=>{const s=(null==a?void 0:a.split(",")[0])||"";return s||""};return i({title:"我的关注"}),(a,s)=>{const l=u,i=C,$=b,F=z,B=k;return r(),d(l,{class:"container"},{default:n((()=>[g(l,{class:"nav-bar"},{default:n((()=>[(r(!0),_(f,null,m(j.value,((a,s)=>(r(),d(l,{key:s,class:y(["nav-item",{active:A.value===a.type}]),onClick:s=>{return l=a.type,void(A.value!==l&&(A.value=l,I(),G()));var l}},{default:n((()=>[p(h(a.name),1)])),_:2},1032,["class","onClick"])))),128))])),_:1}),g(B,{class:"scroll-view","scroll-y":"",onScrolltolower:H,"show-scrollbar":!1},{default:n((()=>[g(l,{class:"list-container"},{default:n((()=>[(r(!0),_(f,null,m(S.value,((s,u)=>(r(),_(f,{key:s.id},[1===A.value&&s.goods?(r(),d(l,{key:0,class:"list-item goods-item",onClick:a=>{return l=s.goods.id,void e({url:`/pages/goods/goods?goods_id=${l}`});var l}},{default:n((()=>[g(l,{class:"goods-left"},{default:n((()=>[g(i,{class:"goods-thumb",src:O(s.goods.goods_images),mode:"aspectFill"},null,8,["src"]),g(l,{class:"price-tag"},{default:n((()=>[p("¥"+h(s.goods.total_amount),1)])),_:2},1024)])),_:2},1024),g(l,{class:"goods-right"},{default:n((()=>[g(l,{class:"goods-header"},{default:n((()=>[g($,{class:"goods-title line-clamp-2"},{default:n((()=>[p(h(s.goods.name),1)])),_:2},1024),g(F,{class:"unfollow-btn",onClick:w((a=>(async a=>{try{"success"===(await t({url:`${x}/user/unfollow`,method:"POST",data:{id:a},header:{Authorization:o("token")}})).data.status&&(S.value=S.value.filter((s=>s.id!==a)),c({title:"已取消关注",icon:"success"}))}catch(s){c({title:"操作失败",icon:"none"})}})(s.id)),["stop"])},{default:n((()=>[p("取消关注")])),_:2},1032,["onClick"])])),_:2},1024),g(l,{class:"goods-specs"},{default:n((()=>[g($,{class:"spec-item"},{default:n((()=>[p(h(s.goods.brand_name),1)])),_:2},1024),g($,{class:"spec-item"},{default:n((()=>[p(h(s.goods.size),1)])),_:2},1024),g($,{class:"spec-item"},{default:n((()=>[p(h(s.goods.skin.split(" ")[0]),1)])),_:2},1024)])),_:2},1024),g(l,{class:"goods-footer"},{default:n((()=>[g($,{class:"goods-type"},{default:n((()=>[p(h(s.goods.type),1)])),_:2},1024),g($,{class:"goods-material"},{default:n((()=>[p(h(s.goods.doll_material),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1032,["onClick"])):v("",!0),2===A.value&&s.brand?(r(),d(l,{key:1,class:"list-item brand-item",onClick:a=>{return l=s.brand.id,void e({url:`/pages/brand/brand?brand_id=${l}`});var l}},{default:n((()=>[g(l,{class:"brand-content"},{default:n((()=>[g(i,{class:"brand-logo",src:s.brand.logo_image,mode:"aspectFit"},null,8,["src"]),g(l,{class:"brand-info"},{default:n((()=>[g(l,{class:"brand-header"},{default:n((()=>[g($,{class:"brand-name"},{default:n((()=>[p(h(s.brand.brand_name),1)])),_:2},1024),g($,{class:"brand-country"},{default:n((()=>[p(h(s.brand.country_name),1)])),_:2},1024)])),_:2},1024),g($,{class:"brand-description line-clamp-2"},{default:n((()=>[p(h(s.brand.description),1)])),_:2},1024),g(l,{class:"brand-actions"},{default:n((()=>[g(F,{class:"action-btn",onClick:w((l=>a.unfollowBrand(s.id)),["stop"])},{default:n((()=>[p("取消关注")])),_:2},1032,["onClick"])])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1032,["onClick"])):v("",!0),3===A.value&&s.collocation?(r(),d(l,{key:2,class:"list-item",onClick:a=>{return l=s.collocation.id,void e({url:`/pages/collocation/detail?id=${l}`});var l}},{default:n((()=>[g(i,{class:"item-image",src:P(s.collocation.image_urls),mode:"aspectFill"},null,8,["src"]),g($,{class:"item-title"},{default:n((()=>[p(h(s.collocation.title),1)])),_:2},1024)])),_:2},1032,["onClick"])):v("",!0),4===A.value&&s.showcase?(r(),d(l,{key:3,class:"list-item",onClick:a=>{return l=s.showcase.id,void e({url:`/pages/showcase/detail?id=${l}`});var l}},{default:n((()=>[g(i,{class:"item-image",src:O(s.showcase.image_urls),mode:"aspectFill"},null,8,["src"]),g($,{class:"item-title"},{default:n((()=>[p(h(s.showcase.name),1)])),_:2},1024)])),_:2},1032,["onClick"])):v("",!0)],64)))),128)),g(l,{class:"loading-status"},{default:n((()=>[T.value?(r(),d($,{key:0,class:"loading-text"},{default:n((()=>[p("加载中...")])),_:1})):v("",!0),q.value?(r(),d($,{key:1,class:"no-more-text"},{default:n((()=>[p("没有更多了")])),_:1})):v("",!0)])),_:1})])),_:1})])),_:1})])),_:1})}}},[["__scopeId","data-v-c4eb830c"]]);export{j as default};
