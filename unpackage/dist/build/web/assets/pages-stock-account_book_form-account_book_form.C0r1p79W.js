import{h as a,g as e,W as t,c as l,w as s,C as o,l as c,f as u,o as n,k as i,a as d,b as r,t as m,u as p,N as f,v as _,m as h,a4 as v,e as g,E as k,Q as b,i as y,H as w}from"./index-CAhh9jg-.js";import{_ as x}from"./info-circle.U4M77mlp.js";import{b as C,w as V,i as j}from"./config.D_tpLRWx.js";import{c as F,g as I,u as T}from"./image.b6tkzStG.js";import{_ as z}from"./_plugin-vue_export-helper.BCo6x5W8.js";const A=z({__name:"account_book_form",props:["account_book_id"],setup(z){const A=z,H=!!A.account_book_id,O=a();e(O.statusBarHeight);let E=e(""),P=e("");e(1);const S=e(0),U=e(["请选择","娃衣","娃头","眼珠","假发","娃鞋","其它"]);e({});const B=e("");function D(a){S.value=a.detail.value}function G(){F().then((a=>{I().then((e=>{console.log(e),T(a,e.token,e.path).then((a=>{200!=a.statusCode&&h({title:"上传失败",icon:"none"}),console.log(j+e.path),B.value=j+e.path,h({title:"上传成功",icon:"success"})}))}))}))}function N(){H?function(){let a={name:E.value,price:parseInt(P.value,10),type:U.value[S.value],image_url:B.value,id:parseInt(A.account_book_id,10)};c({url:V+"/with-state/update-account-book",method:"POST",header:{Authorization:o("token")},data:a,success:a=>{console.log(a.data),"success"==a.data.status?(h({title:"提交成功",icon:"success"}),setTimeout((()=>{v()}),500)):h({title:a.data.msg,icon:"none"})}})}():function(){let a={name:E.value,price:parseInt(P.value,10),type:U.value[S.value],image_url:B.value};console.log(a),c({url:V+"/with-state/add-account-book",method:"POST",header:{Authorization:o("token")},data:a,success:a=>{console.log(a.data),"success"==a.data.status?(h({title:"提交成功",icon:"success"}),setTimeout((()=>{v()}),500)):h({title:a.data.msg,icon:"none"})}})}()}return C().then((a=>{H?(!function(a){let e=o("token");c({url:V+"/with-state/account-book-detail",method:"GET",header:{Authorization:e},data:{id:a},success:a=>{console.log(a.data.data),E.value=a.data.data.name,P.value=a.data.data.price,S.value=U.value.indexOf(a.data.data.type),B.value=a.data.data.image_url},fail:a=>{console.log(a)}})}(A.account_book_id),t({title:"编辑账本"})):t({title:"新增账本"})})),(a,e)=>{const t=g,o=u,c=k,h=b,v=y,C=w;return n(),l(o,{class:"container"},{default:s((()=>[i("meta",{name:"theme-color",content:"#F8F8F8"}),d(o,{class:"form-card"},{default:s((()=>[d(o,{class:"form-item"},{default:s((()=>[d(t,{class:"form-label"},{default:s((()=>[r("分类")])),_:1}),d(c,{mode:"selector",class:"form-input",value:S.value,range:U.value,onChange:D},{default:s((()=>[d(o,{class:"picker-content"},{default:s((()=>[r(m(U.value[S.value]||"请选择分类"),1)])),_:1})])),_:1},8,["value","range"])])),_:1}),d(o,{class:"form-item"},{default:s((()=>[d(t,{class:"form-label"},{default:s((()=>[r("名称")])),_:1}),d(h,{class:"form-input",type:"text",placeholder:"请输入名称","placeholder-class":"placeholder-style",modelValue:p(E),"onUpdate:modelValue":e[0]||(e[0]=a=>f(E)?E.value=a:E=a)},null,8,["modelValue"])])),_:1}),d(o,{class:"form-item"},{default:s((()=>[d(t,{class:"form-label"},{default:s((()=>[r("价值")])),_:1}),d(h,{class:"form-input",type:"digit",placeholder:"请输入价值","placeholder-class":"placeholder-style",modelValue:p(P),"onUpdate:modelValue":e[1]||(e[1]=a=>f(P)?P.value=a:P=a)},null,8,["modelValue"])])),_:1}),d(o,{class:"form-item"},{default:s((()=>[d(t,{class:"form-label"},{default:s((()=>[r("物品图片")])),_:1}),d(o,{class:"upload-wrapper"},{default:s((()=>[B.value?(n(),l(o,{key:0,class:"preview-image"},{default:s((()=>[d(v,{mode:"aspectFill",src:B.value,class:"image-preview"},null,8,["src"]),d(t,{class:"image-tip"},{default:s((()=>[r("点击更换图片")])),_:1})])),_:1})):(n(),l(C,{key:1,class:"upload-button",onClick:G},{default:s((()=>[d(t,{class:"iconfont icon-camera"}),r(" 选择图片 ")])),_:1}))])),_:1})])),_:1}),d(o,{style:{overflow:"hidden"}},{default:s((()=>[d(v,{src:x,mode:"aspectFill",style:{width:"28rpx",height:"28rpx","margin-right":"10rpx",position:"relative",top:"3rpx"}}),d(t,{style:{color:"#888"}},{default:s((()=>[r("仅用于记录您所购买过的物品，其他人不会看到")])),_:1})])),_:1}),d(o,{class:"button-group"},{default:s((()=>[p(H)?(n(),l(C,{key:0,class:"delete-button",onClick:a.handleDelete},{default:s((()=>[r(" 删除账本 ")])),_:1},8,["onClick"])):_("",!0),d(C,{class:"submit-button",onClick:N},{default:s((()=>[r(" 提交"+m(p(H)?"修改":"新增"),1)])),_:1})])),_:1})])),_:1})])),_:1})}}},[["__scopeId","data-v-a22b9f71"]]);export{A as default};
