import{r as a,av as s,o as e,n as l,v as t,j as o,A as c,a2 as d,c as i,w as n,g as u,b as r,B as g,d as _,k as m,l as f,F as p,e as v,u as k,f as b,S as y,C as h,t as w,H as C,i as F,h as z}from"./index-6ojkiy1R.js";import{c as $,w as x}from"./config.Bhvn_Gfs.js";import{_ as j}from"./_plugin-vue_export-helper.BCo6x5W8.js";const A=j({__name:"user_like",setup(j){const A=a([{type:1,name:"商品"},{type:2,name:"品牌"},{type:3,name:"搭配"},{type:4,name:"展示柜"}]),S=a(1),B=a([]),E=a(!1),T=a(!1),D=s({page:1,page_size:8,total:0});e((async()=>{await G(),H()}));const G=async()=>{await $()||l({url:"/pages/login/login"})},H=async()=>{if(!E.value&&!T.value){E.value=!0;try{const a=await t({url:`${x}/with-state/user-likes`,method:"GET",data:{type:S.value,page:D.page,page_size:D.page_size},header:{Authorization:o("token")}});if("success"===a.data.status){const s=a.data.data.list;B.value=[...B.value,...s],D.total=a.data.data.total,a.data.data.list.length?T.value=!1:T.value=!0,D.page+=1}}catch(a){c({title:"加载失败",icon:"none"})}finally{E.value=!1}}},I=()=>{T.value?console.log("no more"):H()},O=()=>{D.page=1,B.value=[],T.value=!1},P=a=>(null==a?void 0:a.length)>0?a[0]:"",q=a=>{const s=(null==a?void 0:a.split(",")[0])||"";return s||""};return d({title:"我的关注"}),(a,s)=>{const e=u,d=F,$=b,j=z,D=y;return r(),i(e,{class:"container"},{default:n((()=>[g("meta",{name:"theme-color",content:"#F8F8F8"}),_(e,{class:"nav-bar"},{default:n((()=>[(r(!0),m(p,null,f(A.value,((a,s)=>(r(),i(e,{key:s,class:h(["nav-item",{active:S.value===a.type}]),onClick:s=>{return e=a.type,void(S.value!==e&&(S.value=e,O(),H()));var e}},{default:n((()=>[v(w(a.name),1)])),_:2},1032,["class","onClick"])))),128))])),_:1}),_(D,{class:"scroll-view","scroll-y":"",onScrolltolower:I,"show-scrollbar":!1},{default:n((()=>[_(e,{class:"list-container"},{default:n((()=>[(r(!0),m(p,null,f(B.value,((s,u)=>(r(),m(p,{key:s.id},[1===S.value&&s.goods?(r(),i(e,{key:0,class:"list-item goods-item",onClick:a=>{return e=s.goods.id,void l({url:`/pages/goods/goods?goods_id=${e}`});var e}},{default:n((()=>[_(e,{class:"goods-left"},{default:n((()=>[_(d,{class:"goods-thumb",src:P(s.goods.goods_images),mode:"aspectFill"},null,8,["src"]),_(e,{class:"price-tag"},{default:n((()=>[v("¥"+w(s.goods.total_amount),1)])),_:2},1024)])),_:2},1024),_(e,{class:"goods-right"},{default:n((()=>[_(e,{class:"goods-header"},{default:n((()=>[_($,{class:"goods-title line-clamp-2"},{default:n((()=>[v(w(s.goods.name),1)])),_:2},1024),_(j,{class:"unfollow-btn",onClick:C((a=>(async a=>{try{"success"===(await t({url:`${x}/user/unfollow`,method:"POST",data:{id:a},header:{Authorization:o("token")}})).data.status&&(B.value=B.value.filter((s=>s.id!==a)),c({title:"已取消关注",icon:"success"}))}catch(s){c({title:"操作失败",icon:"none"})}})(s.id)),["stop"])},{default:n((()=>[v("取消关注")])),_:2},1032,["onClick"])])),_:2},1024),_(e,{class:"goods-specs"},{default:n((()=>[_($,{class:"spec-item"},{default:n((()=>[v(w(s.goods.brand_name),1)])),_:2},1024),_($,{class:"spec-item"},{default:n((()=>[v(w(s.goods.size),1)])),_:2},1024),_($,{class:"spec-item"},{default:n((()=>[v(w(s.goods.skin.split(" ")[0]),1)])),_:2},1024)])),_:2},1024),_(e,{class:"goods-footer"},{default:n((()=>[_($,{class:"goods-type"},{default:n((()=>[v(w(s.goods.type),1)])),_:2},1024),_($,{class:"goods-material"},{default:n((()=>[v(w(s.goods.doll_material),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1032,["onClick"])):k("",!0),2===S.value&&s.brand?(r(),i(e,{key:1,class:"list-item brand-item",onClick:a=>{return e=s.brand.id,void l({url:`/pages/brand/brand?brand_id=${e}`});var e}},{default:n((()=>[_(e,{class:"brand-content"},{default:n((()=>[_(d,{class:"brand-logo",src:s.brand.logo_image,mode:"aspectFit"},null,8,["src"]),_(e,{class:"brand-info"},{default:n((()=>[_(e,{class:"brand-header"},{default:n((()=>[_($,{class:"brand-name"},{default:n((()=>[v(w(s.brand.brand_name),1)])),_:2},1024),_($,{class:"brand-country"},{default:n((()=>[v(w(s.brand.country_name),1)])),_:2},1024)])),_:2},1024),_($,{class:"brand-description line-clamp-2"},{default:n((()=>[v(w(s.brand.description),1)])),_:2},1024),_(e,{class:"brand-actions"},{default:n((()=>[_(j,{class:"action-btn",onClick:C((e=>a.unfollowBrand(s.id)),["stop"])},{default:n((()=>[v("取消关注")])),_:2},1032,["onClick"])])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1032,["onClick"])):k("",!0),3===S.value&&s.collocation?(r(),i(e,{key:2,class:"list-item",onClick:a=>{return e=s.collocation.id,void l({url:`/pages/collocation/detail?id=${e}`});var e}},{default:n((()=>[_(d,{class:"item-image",src:q(s.collocation.image_urls),mode:"aspectFill"},null,8,["src"]),_($,{class:"item-title"},{default:n((()=>[v(w(s.collocation.title),1)])),_:2},1024)])),_:2},1032,["onClick"])):k("",!0),4===S.value&&s.showcase?(r(),i(e,{key:3,class:"list-item",onClick:a=>{return e=s.showcase.id,void l({url:`/pages/showcase/detail?id=${e}`});var e}},{default:n((()=>[_(d,{class:"item-image",src:P(s.showcase.image_urls),mode:"aspectFill"},null,8,["src"]),_($,{class:"item-title"},{default:n((()=>[v(w(s.showcase.name),1)])),_:2},1024)])),_:2},1032,["onClick"])):k("",!0)],64)))),128)),_(e,{class:"loading-status"},{default:n((()=>[E.value?(r(),i($,{key:0,class:"loading-text"},{default:n((()=>[v("加载中...")])),_:1})):k("",!0),T.value?(r(),i($,{key:1,class:"no-more-text"},{default:n((()=>[v("没有更多了")])),_:1})):k("",!0)])),_:1})])),_:1})])),_:1})])),_:1})}}},[["__scopeId","data-v-e3b1fd8f"]]);export{A as default};
