"use strict";const e=require("../../common/vendor.js"),a=require("../../common/assets.js"),t=require("../../common/config.js"),l=Object.assign({inheritAttrs:!1},{__name:"common-search",props:{mode:{type:String,default:"jump",validator:e=>["jump","fill"].includes(e)},width:{type:String,default:"100%"},background:{type:String,default:""},fontSize:{type:String,default:""},hiddenIcon:{type:Boolean,default:!1},showIndexSelector:{type:Boolean,default:!1},indexOptions:{type:Array,default:()=>[{label:"店铺",value:""},{label:"妆师",value:"bjd_artist"},{label:"毛娘",value:"hairstylist"}]},defaultIndex:{type:String,default:""}},emits:["select","close-associate","index-change"],setup(l,{emit:n}){var o;const u=l,d=n,i=e.ref(""),r=e.ref([]),s=e.ref(u.defaultIndex||(null==(o=u.indexOptions[0])?void 0:o.value)||""),v=e.computed((()=>{const e=u.indexOptions.find((e=>e.value===s.value));return e?e.label:"选择类型"})),c=e.computed((()=>u.indexOptions.map((e=>e.label)))),p=e.computed((()=>u.indexOptions.findIndex((e=>e.value===s.value)))),m=()=>{console.log("开始通知",i.value),r.value=[],d("close-associate",i.value)},f=e=>{var a;const t=e.detail.value;s.value=(null==(a=u.indexOptions[t])?void 0:a.value)||"",d("index-change",s.value),""!==i.value.trim()&&h()},h=async()=>{if(""===i.value.trim())return void(r.value=[]);d("select",0,i.value);let a=`${t.websiteUrl.value}/search-brand?search=${encodeURIComponent(i.value)}`;s.value&&(a+=`&index=${s.value}`);try{const t=await e.index.request({url:a,method:"GET",header:{"Content-Type":"application/json"}});return console.log("请求结果:",t.data),"success"==t.data.status?null==t.data.data?void(r.value=[]):void(r.value=t.data.data):void(r.value=[])}catch(l){return console.error("请求错误:",l),void(r.value=[])}};function g(){i.value="",r.value=[]}return(t,n)=>e.e({a:!u.hiddenIcon&&"jump"==u.mode},u.hiddenIcon||"jump"!=u.mode?{}:{b:a._imports_0$15},{c:l.showIndexSelector},l.showIndexSelector?{d:e.t(v.value),e:p.value,f:c.value,g:e.o(f)}:{},{h:e.o([e=>i.value=e.detail.value,h]),i:i.value,j:r.value.length>0},r.value.length>0?e.e({k:r.value.length>0&&i.value.length<5},(r.value.length>0&&i.value.length,{}),{l:a._imports_1$5,m:e.o(g)}):{},{n:e.n(t.$attrs.class),o:l.background||"#fff",p:r.value.length>0},r.value.length>0?{q:e.o(m),r:e.f(r.value,((a,t,l)=>({a:e.t(a.name),b:a.id,c:e.o((t=>{return l=a.id,n=a.name,void("jump"===u.mode?e.index.navigateTo({url:`/pages/brand/brand?brand_id=${l}`}):"fill"===u.mode&&(i.value=n,r.value=[],d("select",l,n)));var l,n}),a.id)}))),s:l.width}:{})}}),n=e._export_sfc(l,[["__scopeId","data-v-00dc1005"]]);wx.createComponent(n);
