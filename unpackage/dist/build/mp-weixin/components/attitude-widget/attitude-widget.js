"use strict";const e=require("../../common/vendor.js"),t=require("../../common/config.js");if(!Array){e.resolveComponent("uni-icons")()}Math;const a={__name:"attitude-widget",props:{targetId:Number,type:Number,attitudeStatus:{type:Number,default:0},attitudeCounts:{type:Object,default:()=>({})}},emits:["change"],setup(a,{emit:u}){const l=a,o=u,v=e.ref(!1),i=e.ref(l.attitudeStatus),n=e.ref({}),r=e.ref([{emoji:"üòù",value:1,label:"ÂæàÊúâË∂£"},{emoji:"üò®",value:2,label:"Ëøô‰∏™..."},{emoji:"ü§§",value:3,label:"Êàë‰πüÊÉ≥Ë¶Å"},{emoji:"ü§¶‚Äç‚ôÄÔ∏è",value:4,label:"Èöæ‰ª•Áõ¥ËßÜ"},{emoji:"ü§°",value:5,label:"Ë∞ÅÁöÑÈºªÂ≠êÊéâ‰∫Ü?"}]);e.watch((()=>l.attitudeCounts),(e=>{r.value.forEach((t=>{n.value[t.value]=Number(e[t.value]??0)})),n.value={...n.value}}),{immediate:!0,deep:!0});const c=e.computed((()=>r.value.map((e=>({...e,count:n.value[e.value]||0}))).filter((e=>e.count>0||e.value===i.value)).filter((e=>e.count>0)))),s=()=>{v.value=!v.value};return(a,u)=>e.e({a:v.value},v.value?{b:e.o(s),c:e.o((()=>{}))}:{},{d:e.f(c.value,((t,a,u)=>({a:e.t(t.emoji),b:e.t(t.count),c:t.value,d:i.value===t.value?1:"",e:t.count>0?1:""}))),e:e.p({type:v.value?"arrowup":"plus",size:"16",color:"#888"}),f:e.t(v.value?"Êî∂Ëµ∑":"Ë°®ÊÄÅ"),g:e.o(s),h:v.value},v.value?{i:e.f(r.value,((a,u,r)=>({a:e.t(a.emoji),b:e.t(a.label),c:a.value,d:i.value===a.value?1:"",e:e.o((u=>(async a=>{try{const u=e.index.getStorageSync("token");if(!u)return void e.index.showToast({title:"ËØ∑ÂÖàÁôªÂΩï",icon:"none"});const r=i.value===a,c=`${t.websiteUrl}/with-state/attitude/${r?"remove":"add"}`;"success"===(await e.index.request({url:c,method:"POST",data:{target_id:l.targetId,type:l.type,action_type:a},header:{Authorization:u}})).data.status&&(r?(n.value[a]--,i.value=0):(i.value>0&&n.value[i.value]--,i.value=a,n.value[a]=(n.value[a]||0)+1),o("change",{status:i.value,counts:{...n.value}}),v.value=!1)}catch(u){console.log(u),e.index.showToast({title:"Êìç‰ΩúÂ§±Ë¥•",icon:"none"})}})(a.value)),a.value)})))}:{})}},u=e._export_sfc(a,[["__scopeId","data-v-a520d9e4"]]);wx.createComponent(u);
