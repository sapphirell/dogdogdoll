"use strict";const e=require("../../../common/vendor.js"),t=require("../../../common/config.js");if(!Array){e.resolveComponent("view-logs")()}Math;const o={__name:"tel_phone",setup(o){e.index.setNavigationBarTitle({title:"手机号"});let n=e.ref(""),a=e.ref(""),s=e.ref("发送验证码");function l(){e.index.request({url:t.websiteUrl+"/with-state/update-profile",method:"POST",header:{Authorization:e.index.getStorageSync("token")},data:{tel_phone:n.value,code:a.value},success:o=>{console.log(o.data),"success"==o.data.status?(e.index.showToast({title:"修改成功",icon:"success"}),t.getUserInfo()):e.index.showToast({title:o.data.msg,icon:"none"})}})}function i(){"发送验证码"==s.value?""!=n.value&&""!=n.value?/^1[3456789]\d{9}$/.test(n.value)?(s.value="发送中",e.index.request({url:t.websiteUrl+"/send-sms-code",method:"POST",header:{Authorization:e.index.getStorageSync("token")},data:{tel_phone:n.value},success:t=>{console.log(t.data),"success"==t.data.status?(s.value="已发送",e.index.showToast({title:"发送成功",icon:"success"})):(e.index.showToast({title:t.data.msg,icon:"none"}),s.value="发送验证码")}})):e.index.showToast({title:"手机号格式错误",icon:"none"}):e.index.showToast({title:"请输入手机号和密码",icon:"none"}):e.index.showToast({title:"请点击发送验证码",icon:"none"})}return t.getUserInfo(),(o,u)=>e.e({a:e.unref(t.global).userInfo.tel_phone},e.unref(t.global).userInfo.tel_phone?{b:e.unref(t.global).userInfo.tel_phone}:{c:e.unref(n),d:e.o((t=>e.isRef(n)?n.value=t.detail.value:n=t.detail.value)),e:e.unref(a),f:e.o((t=>e.isRef(a)?a.value=t.detail.value:a=t.detail.value)),g:e.t(e.unref(s)),h:e.o(i)},{i:!e.unref(t.global).userInfo.tel_phone},e.unref(t.global).userInfo.tel_phone?{}:{j:e.o(l)})}},n=e._export_sfc(o,[["__scopeId","data-v-5536066a"]]);wx.createPage(n);
