"use strict";const e=require("../../common/vendor.js"),o=require("../../common/assets.js"),t=require("../../common/config.js");if(!Array){(e.resolveComponent("common-search")+e.resolveComponent("loading-toast")+e.resolveComponent("common-page"))()}Math||((()=>"../../components/common-search/common-search.js")+(()=>"../../components/loading-toast/loading-toast.js")+(()=>"../../components/common-page/common-page.js"))();const n={__name:"calendar",setup(n){const s=e.ref(["全部","整体","单头","单体","娃衣","眼珠","娃鞋","手型","脚型","袜子","配饰"]);let r=e.ref("全部"),a=e.ref({}),l=e.ref({});const d=new Date,u=`${d.getFullYear()}-${String(d.getMonth()+1).padStart(2,"0")}-${String(d.getDate()).padStart(2,"0")}`;e.ref(null);const i=e.index.getSystemInfoSync(),c=i.screenWidth/7;let g=e.ref(0);e.ref(i.statusBarHeight);let f=e.ref(u),m=e.ref({}),p=e.ref(!0);function _(){p.value=!0,e.index.request({url:t.websiteUrl+"/goods-news",method:"GET",timeout:5e3,success:e=>{console.log(e.data.data),a.value=e.data.data,l.value=v("全部");for(let[o,t]of Object.entries(l.value))o===u&&(m.value=t)},fail:o=>{console.log(o),e.index.showToast({title:"网络请求失败",icon:"none"})},complete:()=>{g.value=7*c-5,console.log("left:"+g.value),p.value=!1}})}function h(e){return e===u}function v(e){const o={};return Object.entries(a.value).forEach((([t,n])=>{const s={...n};s.goods&&(s.goods="全部"===e?s.goods:s.goods.filter((o=>o.type===e)),0===s.goods.length&&(s.goods=null)),o[t]=s})),o}function y(e){const o=new Date(1e3*e);o.getFullYear();return`${(o.getMonth()+1).toString().padStart(2,"0")}-${o.getDate().toString().padStart(2,"0")} ${o.getHours().toString().padStart(2,"0")}:${o.getMinutes().toString().padStart(2,"0")}`}return _(),e.onPullDownRefresh((async()=>{try{_(),e.index.stopPullDownRefresh()}catch(o){e.index.stopPullDownRefresh(),e.index.showToast({title:"刷新失败",icon:"none"})}})),(n,a)=>e.e({a:e.p({width:"560rpx"}),b:e.s("width:500rpx; margin:0rpx 20rpx 10rpx 20rpx;"),c:e.f(s.value,((o,t,n)=>({a:e.t(o),b:t,c:e.unref(r)===o?1:"",d:e.o((e=>(e=>{r.value=e;const o=v(e);l.value={...o};const t=Object.entries(o).find((([e,o])=>o.goods));t?(f.value=t[0],m.value=t[1]):m.value={goods:null}})(o)),t)}))),d:e.f(e.unref(l),((o,t,n)=>e.e({a:o.goods_number>0},o.goods_number>0?{b:e.t(o.goods_number)}:{},{c:e.t(o.weekday),d:"周日"===o.weekday||"周六"===o.weekday?1:"",e:e.t(h(t)?"今天":o.day_number),f:e.unref(f)===t?1:"",g:o.id,h:e.o((e=>function(e,o){console.log(o),f.value=e,m.value=o}(t,o)),o.id)}))),e:e.unref(g),f:e.t(e.unref(f)),g:e.t(e.unref(m).weekday),h:null==e.unref(m).goods},null==e.unref(m).goods?{i:o._imports_0$5}:{j:e.f(e.unref(m).goods,((o,n,s)=>e.e({a:o.goods_image,b:e.t(o.sale_type),c:1==o.is_first_sale_day},(o.is_first_sale_day,{}),{d:e.t(o.brand_name),e:e.t(o.goods_name),f:e.t(o.size),g:e.t(o.size_detail),h:e.t(o.type),i:e.t(y(o.sub_time)),j:o.sub_time_end},o.sub_time_end?{k:e.t(y(o.sub_time_end))}:{},{l:"限量现货"!=o.sale_type&&"不限量现货"!=o.sale_type},"限量现货"!=o.sale_type&&"不限量现货"!=o.sale_type?{m:e.t(o.sub_amount),n:e.t(o.currency),o:e.t(o.fin_amount)}:{p:e.t(o.sub_amount+o.fin_amount),q:e.t(o.currency)},{r:o.id,s:e.o((n=>{return s=o.id,r=o.goods_id,e.index.request({url:t.websiteUrl+"/sale-record-click?id="+s,method:"POST",header:{"Content-Type":"application/json"},success:()=>{console.log("点击记录成功")},fail:e=>{console.error("点击记录失败:",e)}}),void e.index.navigateTo({url:"/pages/goods/goods?goods_id="+r});var s,r}),o.id)})))},{k:e.p({show:e.unref(p)}),l:e.p({head_color:"rgb(185 195 253)"})})}},s=e._export_sfc(n,[["__scopeId","data-v-48d0500a"]]);n.__runtimeHooks=2,wx.createPage(s);
