"use strict";const e=require("../../../common/vendor.js"),t=require("../../../common/config.js"),a=require("../../../common/image.js"),i={__name:"showcase_form",props:["showcase_id"],setup(i){const s=i,o=!!s.showcase_id,n=e.ref(""),u=e.ref(""),d=e.ref("");function c(){a.chooseImage().then((i=>{a.getQiniuToken().then((s=>{a.uploadImageToQiniu(i,s.token,s.path).then((a=>{200!=a.statusCode&&e.index.showToast({title:"上传失败",icon:"none"}),d.value=t.image1Url+s.path,e.index.showToast({title:"上传成功",icon:"success"})}))}))}))}function l(){o?function(){let a={id:parseInt(s.showcase_id,10),name:n.value,description:u.value,image_url:d.value};e.index.request({url:t.websiteUrl+"/with-state/update-showcase",method:"POST",header:{Authorization:e.index.getStorageSync("token")},data:a,success:t=>{"success"==t.data.status?(e.index.showToast({title:"提交成功",icon:"success"}),setTimeout((()=>{e.index.navigateBack()}),500)):e.index.showToast({title:t.data.msg,icon:"none"})}})}():function(){let a={name:n.value,description:u.value,image_url:d.value};e.index.request({url:t.websiteUrl+"/with-state/add-showcase",method:"POST",header:{Authorization:e.index.getStorageSync("token")},data:a,success:t=>{"success"==t.data.status?(e.index.showToast({title:"提交成功",icon:"success"}),setTimeout((()=>{e.index.navigateBack()}),500)):e.index.showToast({title:t.data.msg,icon:"none"})}})}()}return o?(!function(a){let i=e.index.getStorageSync("token");e.index.request({url:t.websiteUrl+"/with-state/showcase-detail",method:"GET",header:{Authorization:i},data:{id:a},success:e=>{n.value=e.data.data.name,u.value=e.data.data.description,d.value=e.data.data.image_url},fail:e=>{console.log(e)}})}(s.showcase_id),e.index.setNavigationBarTitle({title:"编辑展示柜"})):e.index.setNavigationBarTitle({title:"新增展示柜"}),(t,a)=>e.e({a:n.value,b:e.o((e=>n.value=e.detail.value)),c:u.value,d:e.o((e=>u.value=e.detail.value)),e:d.value,f:e.o((e=>d.value=e.detail.value)),g:d.value},d.value?{h:d.value}:{},{i:e.o(c),j:e.o(l)})}};wx.createPage(i);
