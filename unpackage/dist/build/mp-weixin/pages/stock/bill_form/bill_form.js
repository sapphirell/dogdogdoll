"use strict";const e=require("../../../common/vendor.js"),t=require("../../../common/assets.js"),a=require("../../../common/config.js"),i={__name:"bill_form",props:["bill_id"],setup(i){const s=i,n=!!s.bill_id,o=e.ref(""),l=e.ref(""),u=e.ref(""),d=e.ref(0),r=["未补款","已补款"];const c=e.ref("");function v(e){const t=e.detail.value;u.value=t,c.value=g(t)}function m(){e.index.showModal({title:"提示",content:"确定删除该账单吗？",success:t=>{t.confirm&&e.index.request({url:a.websiteUrl+"/with-state/delete-tail-bill?id="+parseInt(s.bill_id,10),method:"POST",header:{Authorization:e.index.getStorageSync("token")},success:t=>{"success"==t.data.status?(e.index.showToast({title:"删除成功",icon:"success"}),setTimeout((()=>{e.index.navigateBack()}),500)):e.index.showToast({title:t.data.msg,icon:"none"})}})}})}function g(e){let t=new Date(e);return`${t.getFullYear()}-${(t.getMonth()+1).toString().padStart(2,"0")}-${t.getDate().toString().padStart(2,"0")}`}function h(e){d.value=e.detail.value}function f(){n?function(){let t={id:parseInt(s.bill_id,10),name:o.value,price:parseFloat(l.value),ymd:u.value,status:d.value};e.index.request({url:a.websiteUrl+"/with-state/update-tail-bill",method:"POST",header:{Authorization:e.index.getStorageSync("token")},data:t,success:t=>{"success"==t.data.status?(e.index.showToast({title:"提交成功",icon:"success"}),setTimeout((()=>{e.index.navigateBack()}),500)):e.index.showToast({title:t.data.msg,icon:"none"})}})}():function(){let t={name:o.value,price:parseFloat(l.value),ymd:u.value,status:d.value};e.index.request({url:a.websiteUrl+"/with-state/add-tail-bill",method:"POST",header:{Authorization:e.index.getStorageSync("token")},data:t,success:t=>{"success"==t.data.status?(e.index.showToast({title:"提交成功",icon:"success"}),setTimeout((()=>{e.index.navigateBack()}),500)):e.index.showToast({title:t.data.msg,icon:"none"})}})}()}return e.onMounted((()=>{n?(!function(t){let i=e.index.getStorageSync("token");e.index.request({url:a.websiteUrl+"/with-state/tail-bill-detail",method:"GET",header:{Authorization:i},data:{id:t},success:e=>{o.value=e.data.data.name,l.value=e.data.data.price,u.value=e.data.data.ymd,d.value=e.data.data.status,c.value=g(e.data.data.ymd)},fail:e=>{console.log(e)}})}(s.bill_id),e.index.setNavigationBarTitle({title:"编辑账单"})):e.index.setNavigationBarTitle({title:"新增账单"})})),(a,i)=>e.e({a:o.value,b:e.o((e=>o.value=e.detail.value)),c:l.value,d:e.o((e=>l.value=e.detail.value)),e:e.t(c.value||"请选择日期"),f:c.value,g:e.o(v),h:e.t(r[d.value]||"请选择状态"),i:d.value,j:r,k:e.o(h),l:t._imports_0$4,m:e.t(e.unref(n)?"修改":"新增"),n:e.o(f),o:e.unref(n)},e.unref(n)?{p:e.o(m)}:{})}},s=e._export_sfc(i,[["__scopeId","data-v-32fe386f"]]);wx.createPage(s);
