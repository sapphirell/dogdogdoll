"use strict";const e=require("../../../common/vendor.js"),t=require("../../../common/config.js"),a={__name:"bill_form",props:["bill_id"],setup(a){const i=a,l=!!i.bill_id,n=e.ref(""),s=e.ref(""),o=e.ref(""),u=e.ref(0),d=["未补款","已补款"];const r=e.ref("");function c(e){const t=e.detail.value;o.value=t,r.value=v(t)}function v(e){let t=new Date(e);return`${t.getFullYear()}-${(t.getMonth()+1).toString().padStart(2,"0")}-${t.getDate().toString().padStart(2,"0")}`}function g(e){u.value=e.detail.value}function m(){l?function(){let a={id:parseInt(i.bill_id,10),name:n.value,price:parseFloat(s.value),ymd:o.value,status:u.value};e.index.request({url:t.websiteUrl+"/with-state/update-tail-bill",method:"POST",header:{Authorization:e.index.getStorageSync("token")},data:a,success:t=>{"success"==t.data.status?(e.index.showToast({title:"提交成功",icon:"success"}),setTimeout((()=>{e.index.navigateBack()}),500)):e.index.showToast({title:t.data.msg,icon:"none"})}})}():function(){let a={name:n.value,price:parseFloat(s.value),ymd:o.value,status:u.value};e.index.request({url:t.websiteUrl+"/with-state/add-tail-bill",method:"POST",header:{Authorization:e.index.getStorageSync("token")},data:a,success:t=>{"success"==t.data.status?(e.index.showToast({title:"提交成功",icon:"success"}),setTimeout((()=>{e.index.navigateBack()}),500)):e.index.showToast({title:t.data.msg,icon:"none"})}})}()}return e.onMounted((()=>{l?(!function(a){let i=e.index.getStorageSync("token");e.index.request({url:t.websiteUrl+"/with-state/tail-bill-detail",method:"GET",header:{Authorization:i},data:{id:a},success:e=>{n.value=e.data.data.name,s.value=e.data.data.price,o.value=e.data.data.ymd,u.value=e.data.data.status,r.value=v(e.data.data.ymd)},fail:e=>{console.log(e)}})}(i.bill_id),e.index.setNavigationBarTitle({title:"编辑账单"})):e.index.setNavigationBarTitle({title:"新增账单"})})),(t,a)=>({a:n.value,b:e.o((e=>n.value=e.detail.value)),c:s.value,d:e.o((e=>s.value=e.detail.value)),e:e.t(r.value),f:r.value,g:e.o(c),h:e.t(d[u.value]),i:u.value,j:d,k:e.o(g),l:e.o(m)})}};wx.createPage(a);
