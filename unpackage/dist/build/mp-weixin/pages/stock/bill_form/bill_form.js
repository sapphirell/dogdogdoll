"use strict";const e=require("../../../common/vendor.js"),t=require("../../../common/assets.js"),a=require("../../../common/config.js");if(!Array){e.resolveComponent("view-logs")()}Math;const i={__name:"bill_form",props:["bill_id"],setup(i){const n=i,o=e.ref({}),s=!!n.bill_id,l=e.ref(""),u=e.ref(""),d=e.ref(""),r=e.ref(0),c=["未补款","已补款"];e.onLoad((e=>{o.value=e,e.name&&(l.value=decodeURIComponent(e.name)),e.amount&&(u.value=e.amount)}));const v=e.ref("");function m(e){const t=e.detail.value;d.value=t,v.value=h(t)}function g(){e.index.showModal({title:"提示",content:"确定删除该账单吗？",success:t=>{t.confirm&&e.index.request({url:a.websiteUrl.value+"/with-state/delete-tail-bill?id="+parseInt(n.bill_id,10),method:"POST",header:{Authorization:e.index.getStorageSync("token")},success:t=>{"success"==t.data.status?(e.index.showToast({title:"删除成功",icon:"success"}),setTimeout((()=>{e.index.navigateBack()}),500)):e.index.showToast({title:t.data.msg,icon:"none"})}})}})}function h(e){let t=new Date(e);return`${t.getFullYear()}-${(t.getMonth()+1).toString().padStart(2,"0")}-${t.getDate().toString().padStart(2,"0")}`}function f(e){r.value=e.detail.value}function x(){s?function(){let t={id:parseInt(n.bill_id,10),name:l.value,price:parseFloat(u.value),ymd:d.value,status:r.value};e.index.request({url:a.websiteUrl.value+"/with-state/update-tail-bill",method:"POST",header:{Authorization:e.index.getStorageSync("token")},data:t,success:t=>{"success"==t.data.status?(e.index.showToast({title:"提交成功",icon:"success"}),setTimeout((()=>{e.index.navigateBack()}),500)):e.index.showToast({title:t.data.msg,icon:"none"})}})}():function(){let t={name:l.value,price:parseFloat(u.value),ymd:d.value,status:r.value};e.index.request({url:a.websiteUrl.value+"/with-state/add-tail-bill",method:"POST",header:{Authorization:e.index.getStorageSync("token")},data:t,success:t=>{"success"==t.data.status?(e.index.showToast({title:"提交成功",icon:"success"}),setTimeout((()=>{e.index.navigateBack()}),500)):e.index.showToast({title:t.data.msg,icon:"none"})}})}()}return e.onMounted((()=>{s?(!function(t){let i=e.index.getStorageSync("token");e.index.request({url:a.websiteUrl.value+"/with-state/tail-bill-detail",method:"GET",header:{Authorization:i},data:{id:t},success:e=>{l.value=e.data.data.name,u.value=e.data.data.price,d.value=e.data.data.ymd,r.value=e.data.data.status,v.value=h(e.data.data.ymd)},fail:e=>{console.log(e)}})}(n.bill_id),e.index.setNavigationBarTitle({title:"编辑账单"})):e.index.setNavigationBarTitle({title:"新增账单"})})),(a,i)=>e.e({a:l.value,b:e.o((e=>l.value=e.detail.value)),c:u.value,d:e.o((e=>u.value=e.detail.value)),e:e.t(v.value||"请选择日期"),f:v.value,g:e.o(m),h:e.t(c[r.value]||"请选择状态"),i:r.value,j:c,k:e.o(f),l:t._imports_0$8,m:e.t(e.unref(s)?"修改":"新增"),n:e.o(x),o:e.unref(s)},e.unref(s)?{p:e.o(g)}:{})}},n=e._export_sfc(i,[["__scopeId","data-v-bf24d98c"]]);wx.createPage(n);
