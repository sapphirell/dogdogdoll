"use strict";const e=require("../../../common/vendor.js"),t=require("../../../common/assets.js"),a=require("../../../common/config.js"),i={__name:"bill_form",props:["bill_id"],setup(i){const l=i,n=!!l.bill_id,s=e.ref(""),o=e.ref(""),u=e.ref(""),d=e.ref(0),r=["未补款","已补款"];const c=e.ref("");function v(e){const t=e.detail.value;u.value=t,c.value=m(t)}function m(e){let t=new Date(e);return`${t.getFullYear()}-${(t.getMonth()+1).toString().padStart(2,"0")}-${t.getDate().toString().padStart(2,"0")}`}function g(e){d.value=e.detail.value}function f(){n?function(){let t={id:parseInt(l.bill_id,10),name:s.value,price:parseFloat(o.value),ymd:u.value,status:d.value};e.index.request({url:a.websiteUrl+"/with-state/update-tail-bill",method:"POST",header:{Authorization:e.index.getStorageSync("token")},data:t,success:t=>{"success"==t.data.status?(e.index.showToast({title:"提交成功",icon:"success"}),setTimeout((()=>{e.index.navigateBack()}),500)):e.index.showToast({title:t.data.msg,icon:"none"})}})}():function(){let t={name:s.value,price:parseFloat(o.value),ymd:u.value,status:d.value};e.index.request({url:a.websiteUrl+"/with-state/add-tail-bill",method:"POST",header:{Authorization:e.index.getStorageSync("token")},data:t,success:t=>{"success"==t.data.status?(e.index.showToast({title:"提交成功",icon:"success"}),setTimeout((()=>{e.index.navigateBack()}),500)):e.index.showToast({title:t.data.msg,icon:"none"})}})}()}return e.onMounted((()=>{n?(!function(t){let i=e.index.getStorageSync("token");e.index.request({url:a.websiteUrl+"/with-state/tail-bill-detail",method:"GET",header:{Authorization:i},data:{id:t},success:e=>{s.value=e.data.data.name,o.value=e.data.data.price,u.value=e.data.data.ymd,d.value=e.data.data.status,c.value=m(e.data.data.ymd)},fail:e=>{console.log(e)}})}(l.bill_id),e.index.setNavigationBarTitle({title:"编辑账单"})):e.index.setNavigationBarTitle({title:"新增账单"})})),(a,i)=>e.e({a:s.value,b:e.o((e=>s.value=e.detail.value)),c:o.value,d:e.o((e=>o.value=e.detail.value)),e:e.t(c.value||"请选择日期"),f:c.value,g:e.o(v),h:e.t(r[d.value]||"请选择状态"),i:d.value,j:r,k:e.o(g),l:t._imports_0$6,m:e.t(e.unref(n)?"修改":"新增"),n:e.o(f),o:e.unref(n)},e.unref(n)?{p:e.o(((...e)=>a.handleDelete&&a.handleDelete(...e)))}:{})}},l=e._export_sfc(i,[["__scopeId","data-v-577d2293"]]);wx.createPage(l);
