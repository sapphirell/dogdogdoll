"use strict";const e=require("../../common/vendor.js"),o=require("../../common/assets.js"),t=require("../../common/config.js");if(!Array){(e.resolveComponent("view-logs")+e.resolveComponent("stock-myitems")+e.resolveComponent("uni-transition")+e.resolveComponent("uni-icons")+e.resolveComponent("common-modal")+e.resolveComponent("common-page"))()}Math||((()=>"../../components/view-logs/view-logs.js")+(()=>"../../components/stock-myitems/stock-myitems.js")+(()=>"../../uni_modules/uni-transition/components/uni-transition/uni-transition.js")+(()=>"../../uni_modules/uni-icons/components/uni-icons/uni-icons.js")+(()=>"../../components/common-modal/common-modal.js")+(()=>"../../components/common-page/common-page.js"))();const a={__name:"stock",setup(a){const s=e.index.getSystemInfoSync();e.ref(s.statusBarHeight);const n=e.ref(1),i=e.ref(1);function l(){return n.value>1?["fade","slide-left"]:["fade","slide-right"]}function c(e){const o=n.value;switch(i.value=o,n.value=e,console.log(`从 tab ${o} 切换到 tab ${e}，方向: ${l()}`),e){case 1:g();break;case 2:v();break;case 3:b()}}function r(e){let o=0,t=0;return e.forEach((e=>{const a=parseFloat(e.price)||0;o+=a,1===e.status&&(t+=a)})),`${t.toFixed(1)}/${o.toFixed(1)}`}const u=e=>{console.log("更新账本列表"),g(e)};function d(){switch(n.value){case 1:e.index.navigateTo({url:"/pages/stock/account_book_form/account_book_form"});break;case 2:e.index.navigateTo({url:"/pages/stock/showcase_form/showcase_form"});break;case 3:_(!1)}}const m=e.ref({}),p=e.ref({}),f=e.ref({});function g(o){if(console.log(t.global),!t.global.isLogin)return m.value={},p.value={},void(f.value={});let a=e.index.getStorageSync("token"),s=t.websiteUrl+"/with-state/account-book";o&&"全部"!==o&&(s=t.websiteUrl+"/with-state/account-book?type="+o),e.index.request({url:s,method:"GET",header:{Authorization:a},success:e=>{console.log(e.data.data),m.value=e.data.data},fail:e=>{console.log(e)}})}function v(){if(console.log(t.global),!t.global.isLogin)return;let o=e.index.getStorageSync("token");e.index.request({url:t.websiteUrl+"/with-state/showcase",method:"GET",header:{Authorization:o},success:e=>{console.log(e.data.data),p.value=e.data.data},fail:e=>{console.log(e)}})}function b(){if(console.log(t.global),!t.global.isLogin)return;let o=e.index.getStorageSync("token");e.index.request({url:t.websiteUrl+"/with-state/tail-bill",method:"GET",header:{Authorization:o},success:e=>{console.log(e.data.data),f.value=e.data.data},fail:e=>{console.log(e)}})}function h(o){e.index.navigateTo({url:"/pages/stock/account_book_form/account_book_form?account_book_id="+o})}function _(o){0!=o?e.index.navigateTo({url:"/pages/stock/bill_form/bill_form?bill_id="+o}):e.index.navigateTo({url:"/pages/stock/bill_form/bill_form"})}return e.onShow((()=>{t.asyncGetUserInfo().then((e=>{switch(n.value){case 1:g();break;case 2:v();break;case 3:b()}}))})),(t,a)=>e.e({a:o._imports_0$4,b:e.o((e=>c(1))),c:1===n.value?1:"",d:o._imports_1$2,e:e.o((e=>c(2))),f:2===n.value?1:"",g:o._imports_2$1,h:e.o((e=>c(3))),i:3===n.value?1:"",j:e.o(h),k:e.o(u),l:e.p({accountBookData:m.value}),m:e.p({name:l(),"mode-class":["fade","slide-bottom"],duration:300,show:1===n.value}),n:p.value.showcases&&p.value.showcases.length>0},p.value.showcases&&p.value.showcases.length>0?{o:e.f(p.value.showcases,((o,t,a)=>{return e.e({a:1!==o.display},1!==o.display?{b:e.t((s=o.display,{0:"审核中",2:"人工复核中",3:"违规隐藏中"}[s]||""))}:{},{c:o.image_url_list[0],d:e.t(o.name),e:e.t(o.description),f:e.t(o.views||0),g:e.t(o.like_count||0),h:1!==o.display?1:"",i:t,j:e.o((t=>{return a=o.id,void e.index.navigateTo({url:"/pages/stock/showcase_form/showcase_form?showcase_id="+a});var a}),t)});var s})),p:o._imports_3$1,q:o._imports_4}:{r:o._imports_0$3},{s:e.p({name:l(),"mode-class":["fade","slide-bottom"],duration:300,show:2===n.value}),t:Object.keys(f.value).length>0},Object.keys(f.value).length>0?{v:e.f(f.value,((o,t,a)=>({a:e.t(t),b:e.t(r(o)),c:e.f(o,((o,t,a)=>({a:e.t(o.name),b:e.t(o.price),c:e.t(o.ymd),d:e.t(0===o.status?"未补款":"已补款"),e:1===o.status?1:"",f:o.id,g:e.o((e=>_(o.id)),o.id)}))),d:t})))}:{w:o._imports_0$3},{x:e.p({name:l(),"mode-class":["fade","slide-bottom"],duration:300,show:3===n.value}),y:e.f(t.customTypes,((o,a,s)=>({a:e.t(o.name),b:e.o((e=>t.deleteType(o.id)),o.id),c:"1226824b-7-"+s+",1226824b-6",d:o.id}))),z:e.p({type:"trash",size:"22",color:"#ff6666"}),A:t.newTypeName,B:e.o((e=>t.newTypeName=e.detail.value)),C:e.o(((...e)=>t.addNewType&&t.addNewType(...e))),D:e.o((e=>t.typeModalVisible=e)),E:e.p({visible:t.typeModalVisible,top:"300rpx",height:"60%"}),F:e.p({type:"plusempty",size:"30",color:"#fff"}),G:e.o(d),H:e.p({head_color:"#d8deff"})})}},s=e._export_sfc(a,[["__scopeId","data-v-1226824b"]]);wx.createPage(s);
