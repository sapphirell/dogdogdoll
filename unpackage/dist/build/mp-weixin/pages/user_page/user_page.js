"use strict";const e=require("../../common/vendor.js"),a=require("../../common/config.js"),t={__name:"user_page",props:["uid"],setup(t){const i=e.ref(0),o=e.ref(["搭配","娃柜","点评"]),l=t,s=e.ref({avatar:"",user_name:"加载中..."}),n=e.ref([]),r=e.ref([]),c=e.ref([]),u=e.ref([{page:1,pageSize:10,total:0,loading:!1,finished:!1},{page:1,pageSize:10,total:0,loading:!1,finished:!1},{page:1,pageSize:10,total:0,loading:!1,finished:!1}]);e.watch(i,(e=>{u.value[e];0===[n,r,c][e].value.length&&d()}));const d=async()=>{const t=u.value[i.value];if(!t.loading&&!t.finished){t.loading=!0;try{let o,s;switch(i.value){case 0:o=`/user-info/collection?user_id=${l.uid}&page=${t.page}`,s="List";break;case 1:o=`/user-info/show-case?user_id=${l.uid}&page=${t.page}`,s="List";break;case 2:o=`/user-info/posts?user_id=${l.uid}&page=${t.page}`,s="comment_list"}console.log(`${a.websiteUrl}${o}`);const u=await e.index.request({url:`${a.websiteUrl}${o}`});if("success"===u.data.status){const e=u.data.data,a=e[s].map((e=>{var a,t,o;switch(i.value){case 0:return{id:e.id,cover:(null==(a=e.image_urls)?void 0:a.split(",")[0])||"",images:(null==(t=e.image_urls)?void 0:t.split(","))||[],title:e.title,time:e.created_at};case 1:return{id:e.id,cover:(null==(o=e.image_urls)?void 0:o.split(",")[0])||"",title:e.name,desc:e.description,time:e.created_at};case 2:return{id:e.id,product_thumb:e.target_image,product_name:e.target_name,content:e.comment,create_time:g(e.created_at)}}})),o=[n,r,c][i.value];o.value=[...o.value,...a],t.total=e.total,t.finished=o.value.length>=e.total,t.page++}}catch(o){console.log(o),e.index.showToast({title:"数据加载失败",icon:"none"})}finally{t.loading=!1}}},g=e=>{const a=new Date(1e3*e);return`${a.getFullYear()}-${(a.getMonth()+1).toString().padStart(2,"0")}-${a.getDate().toString().padStart(2,"0")}`};return e.index.setNavigationBarTitle({title:"用户主页"}),e.onShow((()=>{(async()=>{try{const t=await e.index.request({url:`${a.websiteUrl}/user-info?uid=${l.uid}`});"success"===t.data.status&&(s.value=t.data.data)}catch(t){e.index.showToast({title:"用户信息加载失败",icon:"none"})}})(),d()})),e.onReachBottom((()=>{d()})),(a,t)=>e.e({a:s.value.avatar,b:e.t(s.value.user_name),c:e.f(o.value,((a,t,o)=>({a:e.t(a),b:t,c:i.value===t?1:"",d:e.o((e=>i.value=t),t)}))),d:0===i.value},0===i.value?{e:e.f(n.value,((t,i,o)=>({a:t.cover,b:e.t(t.title),c:i,d:e.o((e=>a.navigateTo(`/pages/collocation_share/collocation_share?collocation_id=${t.id}`)),i)})))}:{},{f:1===i.value},1===i.value?{g:e.f(r.value,((t,i,o)=>({a:t.cover,b:e.t(t.title),c:e.t(t.price),d:i,e:e.o((e=>a.navigateTo(`/pages/user_doll/user_doll?id=${t.id}`)),i)})))}:{},{h:2===i.value},2===i.value?{i:e.f(c.value,((a,t,i)=>({a:a.product_thumb,b:e.t(a.product_name),c:e.t(a.content),d:e.t(a.create_time),e:t})))}:{})}},i=e._export_sfc(t,[["__scopeId","data-v-6636d08d"]]);wx.createPage(i);
