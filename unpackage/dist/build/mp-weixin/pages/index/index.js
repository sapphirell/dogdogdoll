"use strict";const e=require("../../common/vendor.js"),a=require("../../common/assets.js"),n=require("../../common/config.js");if(!Array){(e.resolveComponent("common-search")+e.resolveComponent("index-brand")+e.resolveComponent("uni-icons")+e.resolveComponent("common-page"))()}Math||((()=>"../../components/common-search/common-search.js")+(()=>"../../components/index-brand/index-brand.js")+(()=>"../../uni_modules/uni-icons/components/uni-icons/uni-icons.js")+(()=>"../../components/common-page/common-page.js"))();const o={__name:"index",setup(o){let l=e.ref([]),t=e.ref(["https://images1.fantuanpu.com/box/100024/28a0d23e82607d47a56edb08daa85d0f","https://images1.fantuanpu.com/box/100024/28a0d23e82607d47a56edb08daa85d0f","https://images1.fantuanpu.com/box/100024/28a0d23e82607d47a56edb08daa85d0f"]);const i=e.ref([{label:"中国娃社",value:1},{label:"个人作者",value:2},{label:"外国娃社",value:3}]),u=e.ref(1);e.ref(0),e.index.getSystemInfoSync(),e.ref(0);const s=e.ref(1),d=e.ref(10),r=e.ref(!0),c=e.ref(!1);let v=e.ref([]);const f=e.ref(1),m=e.ref(10),g=e.ref(!0),_=e.ref(!1);let p=e.ref([]);const h=e.ref(1),b=e.ref(10),x=e.ref(!0),w=e.ref(!1),j=e.ref("news"),q=e=>{j.value=e};function L(e){this.swiperIndex.value=e.detail.current}function y(){g.value&&!_.value&&(_.value=!0,e.index.showLoading(),e.index.request({url:n.websiteUrl+"/sale-news",data:{page:f.value,pageSize:m.value},success:e=>{const a=e.data.data.news_list;0!==a.length?(v.value=[...v.value,...a],g.value=v.value.length<e.data.data.total,f.value++):g.value=!1},fail:a=>{console.log(a),e.index.showToast({title:"加载失败",icon:"none"})},complete:()=>{_.value=!1,e.index.hideLoading()}}))}function T(){r.value&&!c.value&&(c.value=!0,e.index.showLoading(),e.index.request({url:n.websiteUrl+"/brands",data:{page:s.value,pageSize:d.value,...u.value&&{searchType:u.value}},success:e=>{const a=e.data.data.brands_list;0!==a.length?(l.value=[...l.value,...a],r.value=l.value.length<e.data.data.total,s.value++):r.value=!1},fail:a=>{console.log(a),e.index.showToast({title:"网络请求失败",icon:"none"})},complete:()=>{c.value=!1,e.index.hideLoading()}}))}const z=e=>{const a=new Date(1e3*e);return`${a.getFullYear()}-${a.getMonth()+1}-${a.getDate()}`};return e.onLoad((()=>{T(),y(),x.value&&!w.value&&(w.value=!0,e.index.showLoading(),e.index.request({url:n.websiteUrl+"/hot-collocation",data:{page:h.value,pageSize:b.value},success:e=>{const a=e.data.data.collocation_relation_list;0!==a.length?(p.value=[...p.value,...a.map((e=>({...e})))],x.value=p.value.length<e.data.data.total,h.value++):x.value=!1},fail:a=>{console.log(a),e.index.showToast({title:"加载失败",icon:"none"})},complete:()=>{w.value=!1,e.index.hideLoading()}}))})),e.onReachBottom((()=>{"brands"===j.value?T():"news"===j.value&&y()})),(n,o)=>e.e({a:a._imports_7,b:e.p({width:"680rpx"}),c:e.f(e.unref(t),((e,a,n)=>({a:e,b:e}))),d:e.o(L),e:a._imports_1,f:"news"===j.value?1:"",g:e.o((e=>q("news"))),h:a._imports_2,i:"brands"===j.value?1:"",j:e.o((e=>q("brands"))),k:a._imports_3,l:"hot"===j.value?1:"",m:e.o((e=>q("hot"))),n:a._imports_4,o:"second"===j.value?1:"",p:e.o((e=>q("second"))),q:"news"===j.value},"news"===j.value?e.e({r:e.f(e.unref(v),((a,n,o)=>e.e({a:a.image_list.length>0},a.image_list.length>0?{b:e.f(a.image_list,((e,a,n)=>({a:e,b:a})))}:{},{c:e.t(a.title),d:e.t(a.content),e:e.t(a.brand_name),f:e.t(z(a.created_at)),g:a.id,h:e.o((n=>function(a){e.index.navigateTo({url:"/pages/sale_news/sale_news?id="+a.id+"&brand_id="+a.brand_id})}(a)),a.id)}))),s:_.value},(_.value,{}),{t:!g.value},(g.value,{})):{},{v:"brands"===j.value},"brands"===j.value?e.e({w:e.f(i.value,((a,n,o)=>({a:e.t(a.label),b:n,c:u.value===a.value?1:"",d:e.o((e=>{return n=a.value,u.value===n?u.value=null:u.value=n,s.value=1,r.value=!0,l.value=[],void T();var n}),n)}))),x:e.f(e.unref(l),((a,n,o)=>({a:"89df2a83-2-"+o+",89df2a83-0",b:e.p({brand:a}),c:a.id}))),y:c.value},(c.value,{}),{z:!r.value},(r.value,{})):{},{A:"hot"===j.value},"hot"===j.value?e.e({B:e.f(e.unref(p),((a,n,o)=>e.e({a:a.image_urls.length>0},a.image_urls.length>0?{b:e.f(a.image_urls,((e,a,n)=>({a:e,b:a})))}:{},{c:e.t(a.title),d:e.t(a.content),e:e.f(a.relation_list,((a,n,o)=>({a:e.t(a.relation_goods_name),b:e.t(a.relation_brand_name),c:n}))),f:a.avatar,g:e.t(1==a.origin?"搭配":"展示柜"),h:e.t(z(a.created_at)),i:"89df2a83-3-"+o+",89df2a83-0",j:e.t(a.like_count),k:a.collocation_id,l:e.o((n=>function(a){e.index.navigateTo({url:`/pages/collocation_share/collocation_share?collocation_id=${a.collocation_id}&origin=${a.origin}`})}(a)),a.collocation_id)}))),C:e.p({type:"heart",size:"18",color:"#ff4d4f"}),D:w.value},(w.value,{}),{E:!x.value},(x.value,{})):{},{F:"second"===j.value},(j.value,{}),{G:e.p({head_color:"rgb(255 230 215) "})})}},l=e._export_sfc(o,[["__scopeId","data-v-89df2a83"]]);o.__runtimeHooks=2,wx.createPage(l);
