"use strict";const e=require("../../common/vendor.js"),a=require("../../common/config.js");if(!Array){(e.resolveComponent("view-logs")+e.resolveComponent("uni-load-more")+e.resolveComponent("uni-icons"))()}Math||((()=>"../../components/view-logs/view-logs.js")+(()=>"../../uni_modules/uni-load-more/components/uni-load-more/uni-load-more.js")+(()=>"../../uni_modules/uni-icons/components/uni-icons/uni-icons.js"))();const t={__name:"message_info",props:["message_id"],setup(t){const o=t,i=e.ref(null),n=e.ref(!0),s=e.ref(""),u=e.ref(""),r=async()=>{try{if(n.value=!0,s.value="",!u.value)return void(s.value="无效的消息ID");if(!(await a.asyncGetUserInfo()))return void(s.value="请先登录");const t=await e.index.request({url:`${a.websiteUrl}/with-state/message-detail`,method:"GET",data:{id:u.value},header:{Authorization:e.index.getStorageSync("token")}});"success"===t.data.status?(i.value=t.data.data,e.index.$emit("message-status-update",{id:u.value,is_read:1})):s.value=t.data.msg||"获取详情失败"}catch(t){s.value="请求失败，请检查网络",console.error("详情请求失败:",t)}finally{n.value=!1}};return e.onMounted((()=>{e.index.setNavigationBarTitle({title:"消息详情"}),u.value=o.message_id,r()})),(a,t)=>{return e.e({a:n.value},n.value?{b:e.p({status:"loading"})}:s.value?{d:e.p({type:"info",size:"24",color:"#ff4d4f"}),e:e.t(s.value),f:e.o(r)}:{g:i.value.cover_image,h:e.t(i.value.title),i:e.t((o=i.value.created_at,new Date(1e3*o).toLocaleDateString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}).replace(/\//g,"-"))),j:e.t(i.value.msg)},{c:s.value});var o}}};wx.createPage(t);
