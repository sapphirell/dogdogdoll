"use strict";const e=require("../../common/vendor.js"),a=require("../../common/config.js");if(!Array){(e.resolveComponent("uni-load-more")+e.resolveComponent("uni-icons"))()}Math;const t={__name:"message_info",props:["message_id"],setup(t){const i=t,r=e.ref(null),o=e.ref(!0),n=e.ref(""),s=e.ref(""),u=async()=>{try{if(o.value=!0,n.value="",!s.value)return void(n.value="无效的消息ID");if(!(await a.asyncGetUserInfo()))return void(n.value="请先登录");const t=await e.index.request({url:`${a.websiteUrl}/with-state/message-detail`,method:"GET",data:{id:s.value},header:{Authorization:e.index.getStorageSync("token")}});"success"===t.data.status?(r.value=t.data.data,e.index.$emit("message-status-update",{id:s.value,is_read:1})):n.value=t.data.msg||"获取详情失败"}catch(t){n.value="请求失败，请检查网络",console.error("详情请求失败:",t)}finally{o.value=!1}};return e.onMounted((()=>{e.index.setNavigationBarTitle({title:"消息详情"}),s.value=i.message_id,u()})),(a,t)=>{return e.e({a:o.value},o.value?{b:e.p({status:"loading"})}:n.value?{d:e.p({type:"info",size:"24",color:"#ff4d4f"}),e:e.t(n.value),f:e.o(u)}:{g:r.value.cover_image,h:e.t(r.value.title),i:e.t((i=r.value.created_at,new Date(1e3*i).toLocaleDateString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}).replace(/\//g,"-"))),j:e.t(r.value.msg)},{c:n.value});var i}}};wx.createPage(t);
