"use strict";const e=require("../../common/vendor.js"),a=require("../../common/config.js");if(!Array){e.resolveComponent("view-logs")()}Math;const o={__name:"user_like",setup(o){const t=e.ref([{type:1,name:"商品"},{type:2,name:"品牌"},{type:3,name:"搭配"},{type:4,name:"展示柜"}]),i=e.ref(1),n=e.ref([]),l=e.ref(!1),s=e.ref(!1),d=e.reactive({page:1,page_size:8,total:0});e.onMounted((async()=>{await r(),u()}));const r=async()=>{await a.asyncGetUserInfo()||e.index.navigateTo({url:"/pages/login/login"})},u=async()=>{if(!l.value&&!s.value){l.value=!0;try{const o=await e.index.request({url:`${a.websiteUrl.value}/with-state/user-likes`,method:"GET",data:{type:i.value,page:d.page,page_size:d.page_size},header:{Authorization:e.index.getStorageSync("token")}});if("success"===o.data.status){const e=o.data.data.list;n.value=[...n.value,...e],d.total=o.data.data.total,o.data.data.list.length?s.value=!1:s.value=!0,d.page+=1}}catch(o){e.index.showToast({title:"加载失败",icon:"none"})}finally{l.value=!1}}},c=()=>{s.value?console.log("no more"):u()},v=()=>{d.page=1,n.value=[],s.value=!1},g=e=>(null==e?void 0:e.length)>0?e[0]:"",p=e=>{const a=(null==e?void 0:e.split(",")[0])||"";return a||""};return e.index.setNavigationBarTitle({title:"我的关注"}),(o,d)=>e.e({a:e.f(t.value,((a,o,t)=>({a:e.t(a.name),b:o,c:i.value===a.type?1:"",d:e.o((e=>{return o=a.type,void(i.value!==o&&(i.value=o,v(),u()));var o}),o)}))),b:e.f(n.value,((t,l,s)=>e.e({a:1===i.value&&t.goods},1===i.value&&t.goods?{b:g(t.goods.goods_images),c:e.t(t.goods.total_amount),d:e.t(t.goods.name),e:e.o((o=>(async o=>{try{"success"===(await e.index.request({url:`${a.websiteUrl.value}/user/unfollow`,method:"POST",data:{id:o},header:{Authorization:e.index.getStorageSync("token")}})).data.status&&(n.value=n.value.filter((e=>e.id!==o)),e.index.showToast({title:"已取消关注",icon:"success"}))}catch(t){e.index.showToast({title:"操作失败",icon:"none"})}})(t.id)),t.id),f:e.t(t.goods.brand_name),g:e.t(t.goods.size),h:e.t(t.goods.skin.split(" ")[0]),i:e.t(t.goods.type),j:e.t(t.goods.doll_material),k:e.o((a=>{return o=t.goods.id,void e.index.navigateTo({url:`/pages/goods/goods?goods_id=${o}`});var o}),t.id)}:{},{l:2===i.value&&t.brand},2===i.value&&t.brand?{m:t.brand.logo_image,n:e.t(t.brand.brand_name),o:e.t(t.brand.country_name),p:e.t(t.brand.description),q:e.o((e=>o.unfollowBrand(t.id)),t.id),r:e.o((a=>{return o=t.brand.id,void e.index.navigateTo({url:`/pages/brand/brand?brand_id=${o}`});var o}),t.id)}:{},{s:3===i.value&&t.collocation},3===i.value&&t.collocation?{t:p(t.collocation.image_urls),v:e.t(t.collocation.title),w:e.o((a=>{return o=t.collocation.id,void e.index.navigateTo({url:`/pages/collocation/detail?id=${o}`});var o}),t.id)}:{},{x:4===i.value&&t.showcase},4===i.value&&t.showcase?{y:g(t.showcase.image_urls),z:e.t(t.showcase.name),A:e.o((a=>{return o=t.showcase.id,void e.index.navigateTo({url:`/pages/showcase/detail?id=${o}`});var o}),t.id)}:{},{B:t.id}))),c:l.value},(l.value,{}),{d:s.value},(s.value,{}),{e:e.o(c)})}},t=e._export_sfc(o,[["__scopeId","data-v-546fd9fc"]]);wx.createPage(t);
