"use strict";const e=require("../../common/vendor.js"),a=require("../../common/config.js"),o={__name:"reset_password",setup(o){const s=e.ref({telephone:"",code:"",newPassword:"",reNewPassword:""}),l=e.ref({phone:"",code:"",newPassword:"",reNewPassword:""}),t=e.ref(0),u=e.computed((()=>t.value>0)),n=e.computed((()=>t.value>0?`${t.value}秒后重发`:"获取验证码")),d=e.ref(!1),r=()=>s.value.telephone?/^1[3-9]\d{9}$/.test(s.value.telephone)?(l.value.phone="",!0):(l.value.phone="手机号格式不正确",!1):(l.value.phone="手机号不能为空",!1),v=async()=>{if(r())try{const o=await e.index.request({url:`${a.websiteUrl}/send-sms-code`,method:"POST",data:{tel_phone:s.value.telephone}});"success"===o.data.status?(p(),e.index.showToast({title:"验证码已发送",icon:"none"})):e.index.showToast({title:o.data.msg||"发送失败",icon:"none"})}catch(o){e.index.showToast({title:"网络请求失败",icon:"none"})}},w=()=>s.value.newPassword.length<6?(l.value.newPassword="密码至少需要6位",!1):(l.value.newPassword="",!0),c=()=>s.value.newPassword!==s.value.reNewPassword?(l.value.reNewPassword="两次密码输入不一致",!1):(l.value.reNewPassword="",!0),i=()=>s.value.code?6!==s.value.code.length?(l.value.code="验证码格式不正确",!1):(l.value.code="",!0):(l.value.code="验证码不能为空",!1),h=async()=>{if([r(),i(),w(),c()].every((e=>e)))try{d.value=!0;const o=await e.index.request({url:`${a.websiteUrl}/reset-password`,method:"POST",data:{telephone:s.value.telephone,code:s.value.code,password:s.value.newPassword,re_password:s.value.reNewPassword}});"success"===o.data.status?e.index.showToast({title:"密码重置成功",icon:"success",complete:()=>{setTimeout((()=>{e.index.navigateBack()}),1500)}}):e.index.showToast({title:o.data.msg||"重置失败",icon:"none"})}catch(o){e.index.showToast({title:"网络请求失败",icon:"none"})}finally{d.value=!1}},p=()=>{t.value=60;const e=setInterval((()=>{t.value<=0?clearInterval(e):t.value--}),1e3)},P=()=>{e.index.navigateBack()};return(a,o)=>e.e({a:e.o(r),b:s.value.telephone,c:e.o((e=>s.value.telephone=e.detail.value)),d:l.value.phone},l.value.phone?{e:e.t(l.value.phone)}:{},{f:e.o(i),g:s.value.code,h:e.o((e=>s.value.code=e.detail.value)),i:e.t(n.value),j:u.value,k:e.o(v),l:u.value?1:"",m:l.value.code},l.value.code?{n:e.t(l.value.code)}:{},{o:e.o(w),p:s.value.newPassword,q:e.o((e=>s.value.newPassword=e.detail.value)),r:l.value.newPassword},l.value.newPassword?{s:e.t(l.value.newPassword)}:{},{t:e.o(c),v:s.value.reNewPassword,w:e.o((e=>s.value.reNewPassword=e.detail.value)),x:l.value.reNewPassword},l.value.reNewPassword?{y:e.t(l.value.reNewPassword)}:{},{z:e.t(d.value?"提交中...":"重置密码"),A:d.value,B:e.o(h),C:d.value?1:"",D:e.o(P)})}},s=e._export_sfc(o,[["__scopeId","data-v-418709da"]]);wx.createPage(s);
