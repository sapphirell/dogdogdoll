"use strict";const e=require("./vendor.js"),t=require("./config.js");exports.chooseImage=function(){return new Promise((t=>{e.index.chooseImage({count:1,success:e=>{t(e.tempFilePaths[0])}})}))},exports.getQiniuToken=function(){return new Promise(((o,n)=>{let i=e.index.getStorageSync("token");e.index.request({url:t.websiteUrl+"/with-state/qiniu-token",method:"POST",header:{Authorization:i},success:t=>{t.data.data&&t.data.data.token?(console.log("获取到的七牛token："+t.data.data.token),o(t.data.data)):(e.index.showToast({title:"获取上传凭证失败",icon:"none"}),n("获取上传凭证失败"))},fail:t=>{e.index.showToast({title:"获取上传凭证失败",icon:"none"}),n("获取上传凭证失败")}})}))},exports.uploadImageToQiniu=function(t,o,n){return new Promise(((i,a)=>{e.index.uploadFile({url:"https://up-cn-east-2.qiniup.com",name:"file",method:"POST",filePath:t,fileType:"image",formData:{token:o,key:n,scope:"hobby-box:"+n},success:e=>{console.log("上传成功"),i(e)},fail:t=>{e.index.showToast({title:"上传失败",icon:"none"}),a("上传失败")}})}))};
