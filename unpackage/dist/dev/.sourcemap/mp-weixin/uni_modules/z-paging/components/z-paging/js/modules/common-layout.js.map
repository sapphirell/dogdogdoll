{"version":3,"file":"common-layout.js","sources":["uni_modules/z-paging/components/z-paging/js/modules/common-layout.js"],"sourcesContent":["// [z-paging]通用布局相关模块\nimport u from '.././z-paging-utils'\n\n// #ifdef APP-NVUE\nconst weexDom = weex.requireModule('dom');\n// #endif\n\nexport default {\n\tdata() {\n\t\treturn {\n\t\t\tsystemInfo: null,\n\t\t\tcssSafeAreaInsetBottom: -1,\n\t\t\tisReadyDestroy: false,\n\t\t}\n\t},\n\tcomputed: {\n\t\t// 顶部可用距离\n\t\twindowTop() {\n\t\t\tif (!this.systemInfo) return 0;\n\t\t\t// 暂时修复vue3中隐藏系统导航栏后windowTop获取不正确的问题，具体bug详见https://ask.dcloud.net.cn/question/141634\n\t\t\t// 感谢litangyu！！https://github.com/SmileZXLee/uni-z-paging/issues/25\n\t\t\t// #ifdef VUE3 && H5\n\t\t\tconst pageHeadNode = document.getElementsByTagName(\"uni-page-head\");\n\t\t\tif (!pageHeadNode.length) return 0;\n\t\t\t// #endif\n\t\t\treturn this.systemInfo.windowTop || 0;\n\t\t},\n\t\t// 底部安全区域高度\n\t\tsafeAreaBottom() {\n\t\t\tif (!this.systemInfo) return 0;\n\t\t\tlet safeAreaBottom = 0;\n\t\t\t// #ifdef APP-PLUS\n\t\t\tsafeAreaBottom = this.systemInfo.safeAreaInsets.bottom || 0 ;\n\t\t\t// #endif\n\t\t\t// #ifndef APP-PLUS\n\t\t\tsafeAreaBottom = Math.max(this.cssSafeAreaInsetBottom, 0);\n\t\t\t// #endif\n\t\t\treturn safeAreaBottom;\n\t\t},\n\t\t// 是否是比较老的webview，在一些老的webview中，需要进行一些特殊处理\n\t\tisOldWebView() {\n\t\t\t// #ifndef APP-NVUE || MP-KUAISHOU\n\t\t\ttry {\n\t\t\t\tconst systemInfos = u.getSystemInfoSync(true).system.split(' ');\n\t\t\t\tconst deviceType = systemInfos[0];\n\t\t\t\tconst version = parseInt(systemInfos[1]);\n\t\t\t\tif ((deviceType === 'iOS' && version <= 10) || (deviceType === 'Android' && version <= 6)) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t} catch(e) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\t// #endif\n\t\t\treturn false;\n\t\t},\n\t\t// 当前组件的$slots，兼容不同平台\n\t\tzSlots() {\n\t\t\t// #ifdef VUE2\n\t\t\t\n\t\t\t// #ifdef MP-ALIPAY\n\t\t\treturn this.$slots;\n\t\t\t// #endif\n\t\t\t\n\t\t\treturn this.$scopedSlots || this.$slots;\n\t\t\t// #endif\n\t\t\t\n\t\t\treturn this.$slots;\n\t\t},\n\t},\n\tbeforeDestroy() {\n\t\tthis.isReadyDestroy = true;\n\t},\n\t// #ifdef VUE3\n\tunmounted() {\n\t\tthis.isReadyDestroy = true;\n\t},\n\t// #endif\n\tmethods: {\n\t\t// 更新fixed模式下z-paging的布局\n\t\tupdateFixedLayout() {\n\t\t\tthis.fixed && this.$nextTick(() => {\n\t\t\t\tthis.systemInfo = u.getSystemInfoSync();\n\t\t\t})\n\t\t},\n\t\t// 获取节点尺寸\n\t\t_getNodeClientRect(select, inDom = true, scrollOffset = false) {\n\t\t\tif (this.isReadyDestroy) {\n\t\t\t\treturn Promise.resolve(false);\n\t\t\t};\n\t\t\t// nvue中获取节点信息\n\t\t\t// #ifdef APP-NVUE\n\t\t\tselect = select.replace(/[.|#]/g, '');\n\t\t\tconst ref = this.$refs[select];\n\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\tif (ref) {\n\t\t\t\t\tweexDom.getComponentRect(ref, option => {\n\t\t\t\t\t\tresolve(option && option.result ? [option.size] : false);\n\t\t\t\t\t})\n\t\t\t\t} else {\n\t\t\t\t\tresolve(false);\n\t\t\t\t}\n\t\t\t});\n\t\t\treturn;\n\t\t\t// #endif\n\t\t\t\n\t\t\t// vue中获取节点信息\n\t\t\t//#ifdef MP-ALIPAY\n\t\t\tinDom = false;\n\t\t\t//#endif\n\t\t\t\n\t\t\t/*\n\t\t\tinDom可能是true、false，也可能是具体的dom节点\n\t\t\t如果inDom不为false，则使用uni.createSelectorQuery().in()进行查询，如果inDom为true，则in中的是this，否则in中的为具体的dom\n\t\t\t如果inDom为false，则使用uni.createSelectorQuery()进行查询\n\t\t\t*/\n\t\t\tlet res = !!inDom ? uni.createSelectorQuery().in(inDom === true ? this : inDom) : uni.createSelectorQuery();\n\t\t\tscrollOffset ? res.select(select).scrollOffset() : res.select(select).boundingClientRect();\n\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\tres.exec(data => {\n\t\t\t\t\tresolve((data && data != '' && data != undefined && data.length) ? data : false);\n\t\t\t\t});\n\t\t\t});\n\t\t},\n\t\t// 获取slot=\"left\"和slot=\"right\"宽度并且更新布局\n\t\t_updateLeftAndRightWidth(targetStyle, parentNodePrefix) {\n\t\t\tthis.$nextTick(() => {\n\t\t\t\tlet delayTime = 0;\n\t\t\t\t// #ifdef MP-BAIDU\n\t\t\t\tdelayTime = 10;\n\t\t\t\t// #endif\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t['left','right'].map(position => {\n\t\t\t\t\t\tthis._getNodeClientRect(`.${parentNodePrefix}-${position}`).then(res => {\n\t\t\t\t\t\t\tthis.$set(targetStyle, position, res ? res[0].width + 'px' : '0px');\n\t\t\t\t\t\t});\n\t\t\t\t\t})\n\t\t\t\t}, delayTime)\n\t\t\t})\n\t\t},\n\t\t// 通过获取css设置的底部安全区域占位view高度设置bottom距离（直接通过systemInfo在部分平台上无法获取到底部安全区域）\n\t\t_getCssSafeAreaInsetBottom(success) {\n\t\t\tthis._getNodeClientRect('.zp-safe-area-inset-bottom').then(res => {\n\t\t\t\tthis.cssSafeAreaInsetBottom = res ? res[0].height : -1;\n\t\t\t\tres && success && success();\n\t\t\t});\n\t\t},\n\t\t// 同步获取系统信息，兼容不同平台（供z-paging-swiper使用）\n\t\t_getSystemInfoSync(useCache = false) {\n\t\t\treturn u.getSystemInfoSync(useCache);\n\t\t}\n\t}\n}\n"],"names":["u","uni"],"mappings":";;;AAOA,MAAe,qBAAA;AAAA,EACd,OAAO;AACN,WAAO;AAAA,MACN,YAAY;AAAA,MACZ,wBAAwB;AAAA,MACxB,gBAAgB;AAAA,IAChB;AAAA,EACD;AAAA,EACD,UAAU;AAAA;AAAA,IAET,YAAY;AACX,UAAI,CAAC,KAAK;AAAY,eAAO;AAO7B,aAAO,KAAK,WAAW,aAAa;AAAA,IACpC;AAAA;AAAA,IAED,iBAAiB;AAChB,UAAI,CAAC,KAAK;AAAY,eAAO;AAC7B,UAAI,iBAAiB;AAKrB,uBAAiB,KAAK,IAAI,KAAK,wBAAwB,CAAC;AAExD,aAAO;AAAA,IACP;AAAA;AAAA,IAED,eAAe;AAEd,UAAI;AACH,cAAM,cAAcA,uDAAC,EAAC,kBAAkB,IAAI,EAAE,OAAO,MAAM,GAAG;AAC9D,cAAM,aAAa,YAAY,CAAC;AAChC,cAAM,UAAU,SAAS,YAAY,CAAC,CAAC;AACvC,YAAK,eAAe,SAAS,WAAW,MAAQ,eAAe,aAAa,WAAW,GAAI;AAC1F,iBAAO;AAAA,QACP;AAAA,MACD,SAAO,GAAG;AACV,eAAO;AAAA,MACP;AAED,aAAO;AAAA,IACP;AAAA;AAAA,IAED,SAAS;AAUR,aAAO,KAAK;AAAA,IACZ;AAAA,EACD;AAAA,EACD,gBAAgB;AACf,SAAK,iBAAiB;AAAA,EACtB;AAAA,EAED,YAAY;AACX,SAAK,iBAAiB;AAAA,EACtB;AAAA,EAED,SAAS;AAAA;AAAA,IAER,oBAAoB;AACnB,WAAK,SAAS,KAAK,UAAU,MAAM;AAClC,aAAK,aAAaA,yDAAE;MACxB,CAAI;AAAA,IACD;AAAA;AAAA,IAED,mBAAmB,QAAQ,QAAQ,MAAM,eAAe,OAAO;AAC9D,UAAI,KAAK,gBAAgB;AACxB,eAAO,QAAQ,QAAQ,KAAK;AAAA,MAEhC;AA0BG,UAAI,MAAM,CAAC,CAAC,QAAQC,cAAG,MAAC,oBAAmB,EAAG,GAAG,UAAU,OAAO,OAAO,KAAK,IAAIA,cAAG,MAAC,oBAAmB;AACzG,qBAAe,IAAI,OAAO,MAAM,EAAE,iBAAiB,IAAI,OAAO,MAAM,EAAE,mBAAkB;AACxF,aAAO,IAAI,QAAQ,CAAC,SAAS,WAAW;AACvC,YAAI,KAAK,UAAQ;AAChB,kBAAS,QAAQ,QAAQ,MAAM,QAAQ,UAAa,KAAK,SAAU,OAAO,KAAK;AAAA,QACpF,CAAK;AAAA,MACL,CAAI;AAAA,IACD;AAAA;AAAA,IAED,yBAAyB,aAAa,kBAAkB;AACvD,WAAK,UAAU,MAAM;AACpB,YAAI,YAAY;AAIhB,mBAAW,MAAM;AAChB,WAAC,QAAO,OAAO,EAAE,IAAI,cAAY;AAChC,iBAAK,mBAAmB,IAAI,gBAAgB,IAAI,QAAQ,EAAE,EAAE,KAAK,SAAO;AACvE,mBAAK,KAAK,aAAa,UAAU,MAAM,IAAI,CAAC,EAAE,QAAQ,OAAO,KAAK;AAAA,YACzE,CAAO;AAAA,UACP,CAAM;AAAA,QACD,GAAE,SAAS;AAAA,MAChB,CAAI;AAAA,IACD;AAAA;AAAA,IAED,2BAA2B,SAAS;AACnC,WAAK,mBAAmB,4BAA4B,EAAE,KAAK,SAAO;AACjE,aAAK,yBAAyB,MAAM,IAAI,CAAC,EAAE,SAAS;AACpD,eAAO,WAAW;MACtB,CAAI;AAAA,IACD;AAAA;AAAA,IAED,mBAAmB,WAAW,OAAO;AACpC,aAAOD,uDAAC,EAAC,kBAAkB,QAAQ;AAAA,IACnC;AAAA,EACD;AACF;;"}