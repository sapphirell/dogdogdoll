{"version":3,"file":"pop_croper.js","sources":["pages/pop_croper/pop_croper.vue","pages/pop_croper/pop_croper.vue?type=page"],"sourcesContent":["<template>\r\n\t<view class=\"container\">\r\n\t\t<!-- <image v-if=\"dist\" :src=\"dist\" class=\"dist\" mode=\"widthFix\"></image> -->\r\n\t\t<uni-popup ref=\"pop\">\r\n\t\t\t<view class=\"content\">\r\n\t\t\t\t<!-- <view @click=\"close\" class=\"close\">X</view> -->\r\n\t\t\t\t<bt-cropper ref=\"cropper\" :imageSrc=\"imageSrc\" :mask=\"mask\" :ratio=\"ratio\" :initPosition=\"initPosition\"\r\n\t\t\t\t\t:dWidth=\"800\" fileType=\"png\" :containerSize=\"containerSize\" @change=\"onChange\"></bt-cropper>\r\n\t\t\t\t<view class=\"btns\">\r\n\t\t\t\t\t<!-- <button class=\"button\" @click=\"change\">换张图</button> -->\r\n\t\t\t\t\t<button class=\"button\" @click=\"crop\">裁剪</button>\r\n\t\t\t\t\t<button class=\"button\" @click=\"undo\">撤销</button>\r\n\t\t\t\t\t<!-- <button class=\"button\" @click=\"resume\">重做</button> -->\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t</uni-popup>\r\n\t\t<!-- <button @click=\"openPopup\">打开编辑器</button> -->\r\n\t</view>\r\n</template>\r\n\r\n<script>\r\n\texport default {\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\timageSrc: '',\r\n\t\t\t\t// mask: \"https://vkceyugu.cdn.bspapp.com/VKCEYUGU-a3b890b4-7cb2-4b29-aa78-e652572bdef6/d6bc69ee-cdc0-4a13-a744-d79db42e0dbe.png\",\r\n\t\t\t\tdist: '',\r\n\t\t\t\tmask: \"\",\r\n\t\t\t\tratio: 1,\r\n\t\t\t\t// 如果在弹窗中使用，必须手动指定裁剪器的大小\r\n\t\t\t\tcontainerSize: {\r\n\t\t\t\t\twidth: 600,\r\n\t\t\t\t\theight: 600\r\n\t\t\t\t},\r\n\t\t\t\t// 保存操作后的状态以供下次编辑\r\n\t\t\t\tinitPosition: null\r\n\t\t\t};\r\n\t\t},\r\n\t\tonLoad(options) {\r\n\t\t\tthis.imageSrc = decodeURIComponent(options.src)\r\n\r\n\t\t},\r\n\t\tonPullDownRefresh() {\r\n\t\t\t// 阻止下拉刷新\r\n\t\t\tuni.stopPullDownRefresh();\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\topenPopup() {\r\n\t\t\t\tthis.$refs.pop.open();\r\n\t\t\t},\r\n\t\t\tchange() {\r\n\t\t\t\tuni.chooseImage({\r\n\t\t\t\t\tcount: 1,\r\n\t\t\t\t\tsizeType: ['original'],\r\n\t\t\t\t\tsuccess: res => {\r\n\t\t\t\t\t\tlet tempFilePaths = res.tempFilePaths[0];\r\n\t\t\t\t\t\tthis.src = tempFilePaths;\r\n\t\t\t\t\t\tthis.initPosition = null;\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tclose() {\r\n\t\t\t\tthis.$refs.pop.close();\r\n\t\t\t},\r\n\t\t\tonChange(ev) {\r\n\t\t\t\tthis.initPosition = ev;\r\n\t\t\t},\r\n\t\t\t// 撤销\r\n\t\t\tundo() {\r\n\t\t\t\tthis.$refs.cropper.undo();\r\n\t\t\t},\r\n\t\t\t// 重做\r\n\t\t\tresume() {\r\n\t\t\t\tthis.$refs.cropper.resume();\r\n\t\t\t},\r\n\t\t\tcrop() {\r\n\t\t\t\tthis.$refs.cropper.crop().then(res => {\r\n\t\t\t\t\tthis.dist = res;\r\n\t\t\t\t\t//返回\r\n\t\t\t\t\tconst pages = getCurrentPages(); // 获取页面栈\r\n\t\t\t\t\tconst parentPage = pages[pages.length - 2]; // 获取上一页面实例\r\n\t\t\t\t\tconsole.log(parentPage)\r\n\t\t\t\t\t// 将裁剪结果存到父页面的 `returnParam`\r\n\t\t\t\t\tparentPage.returnParam = res;\r\n\t\t\t\t\t// 携带参数 res \r\n\t\t\t\t\tuni.navigateBack({\r\n\t\t\t\t\t\tdelta: 1,\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t});\r\n\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\n\r\n\t.dist {\r\n\t\twidth: 600rpx;\r\n\t}\r\n\r\n\t.content {\r\n\t\tbackground-color: #fff;\r\n\t\tpadding: 20rpx;\r\n\t\tborder-radius: 20rpx;\r\n\t\tposition: relative;\r\n\r\n\t\t.title {\r\n\t\t\tfont-size: 36rpx;\r\n\t\t\tfont-weight: bold;\r\n\t\t\ttext-align: center;\r\n\t\t\tmargin-bottom: 20rpx;\r\n\t\t}\r\n\r\n\t\t.close {\r\n\t\t\tposition: absolute;\r\n\t\t\ttop: 0rpx;\r\n\t\t\tright: 0;\r\n\t\t\tpadding: 20rpx;\r\n\t\t}\r\n\t}\n\t.button {\n\t\tmargin: 20px;\n\t\tdisplay: block;\n\t}\r\n</style>","import MiniProgramPage from '/Users/sapphirell/Documents/git/dogdogdoll-uniapp/pages/pop_croper/pop_croper.vue'\nwx.createPage(MiniProgramPage)"],"names":["uni"],"mappings":";;AAqBC,MAAK,YAAU;AAAA,EACd,OAAO;AACN,WAAO;AAAA,MACN,UAAU;AAAA;AAAA,MAEV,MAAM;AAAA,MACN,MAAM;AAAA,MACN,OAAO;AAAA;AAAA,MAEP,eAAe;AAAA,QACd,OAAO;AAAA,QACP,QAAQ;AAAA,MACR;AAAA;AAAA,MAED,cAAc;AAAA;EAEf;AAAA,EACD,OAAO,SAAS;AACf,SAAK,WAAW,mBAAmB,QAAQ,GAAG;AAAA,EAE9C;AAAA,EACD,oBAAoB;AAEnBA,kBAAG,MAAC,oBAAmB;AAAA,EACvB;AAAA,EACD,SAAS;AAAA,IACR,YAAY;AACX,WAAK,MAAM,IAAI;IACf;AAAA,IACD,SAAS;AACRA,oBAAAA,MAAI,YAAY;AAAA,QACf,OAAO;AAAA,QACP,UAAU,CAAC,UAAU;AAAA,QACrB,SAAS,SAAO;AACf,cAAI,gBAAgB,IAAI,cAAc,CAAC;AACvC,eAAK,MAAM;AACX,eAAK,eAAe;AAAA,QACrB;AAAA,MACD,CAAC;AAAA,IACD;AAAA,IACD,QAAQ;AACP,WAAK,MAAM,IAAI;IACf;AAAA,IACD,SAAS,IAAI;AACZ,WAAK,eAAe;AAAA,IACpB;AAAA;AAAA,IAED,OAAO;AACN,WAAK,MAAM,QAAQ;IACnB;AAAA;AAAA,IAED,SAAS;AACR,WAAK,MAAM,QAAQ;IACnB;AAAA,IACD,OAAO;AACN,WAAK,MAAM,QAAQ,KAAI,EAAG,KAAK,SAAO;AACrC,aAAK,OAAO;AAEZ,cAAM,QAAQ;AACd,cAAM,aAAa,MAAM,MAAM,SAAS,CAAC;AACzCA,sBAAAA,MAAA,MAAA,OAAA,yCAAY,UAAU;AAEtB,mBAAW,cAAc;AAEzBA,sBAAAA,MAAI,aAAa;AAAA,UAChB,OAAO;AAAA,QACR,CAAC;AAAA,MAEF,CAAC;AAAA,IAEF;AAAA,EACD;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC3FF,GAAG,WAAW,eAAe;"}