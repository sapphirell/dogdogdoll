{"version":3,"file":"tel_phone.js","sources":["pages/setting/tel_phone/tel_phone.vue","pages/setting/tel_phone/tel_phone.vue?type=page"],"sourcesContent":["<template>\n\t<view-logs />\r\n\t<view style=\"padding: 15px;\">\r\n\t\t<view v-if=\"global.userInfo.tel_phone\">\n\t\t\t<input type=\"text\" class=\"inputer\" :value=\"global.userInfo.tel_phone\" disabled=\"\"/>\n\t\t\t<text style=\"padding: 10px;font-size: 20px;color: rgb(190 190 190);\">已绑定，如需修改请联系管理员操作。</text>\r\n\t\t</view>\r\n\t\t<view v-else>\r\n\t\t\t<input class=\"inputer\" type=\"text\" placeholder=\"请输入手机号\" v-model=\"telPhone\" />\n\t\t\t<view style=\"position: relative;\" >\n\t\t\t\t<input class=\"inputer\" type=\"text\" placeholder=\"请输入验证码\" v-model=\"code\" />\n\t\t\t\t<button style=\"position: absolute;right: 0px;width: 110px;font-size: 16px;bottom: 10px;\"  @click=\"sendCode\">\n\t\t\t\t\t<text>{{buttonMsg}}</text>\n\t\t\t\t</button>\n\t\t\t</view>\r\n\t\r\n\r\n\t\t</view>\r\n\t\t<button class=\"light_button\" @click=\"updateTelPhone\" v-if=\"!global.userInfo.tel_phone\">提交</button>\n\r\n\t</view>\n\t\n\r\n</template>\r\n\r\n<script setup>\r\n\timport {\r\n\t\tref\r\n\t} from 'vue';\r\n\r\n\timport {\r\n\t\twebsiteUrl,\r\n\t\twechatSignLogin,\r\n\t\tgetUserInfo,\r\n\t\tglobal,\r\n\t} from \"../../../common/config.js\";\r\n\r\n\tuni.setNavigationBarTitle({\r\n\t\ttitle: '手机号'\r\n\t})\r\n\t// 关联表单\n\tlet telPhone = ref(\"\")\n\tlet code = ref(\"\")\n\tlet buttonMsg = ref(\"发送验证码\")\r\n\n\tfunction updateTelPhone() {\n\t\tuni.request({\n\t\t\turl: websiteUrl + '/with-state/update-profile',\n\t\t\tmethod: \"POST\",\n\t\t\theader: {\n\t\t\t\t'Authorization': uni.getStorageSync('token'),\n\t\t\t},\n\t\t\tdata: {\n\t\t\t\ttel_phone: telPhone.value,\n\t\t\t\tcode: code.value\n\t\t\t},\n\t\t\tsuccess: (res) => {\n\t\t\t\tconsole.log(res.data)\n\t\t\t\tif (res.data.status == \"success\") {\n\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\ttitle: '修改成功',\n\t\t\t\t\t\ticon: 'success'\n\t\t\t\t\t})\n\t\t\t\t\tgetUserInfo();\n\t\t\t\t} else {\n\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\ttitle: res.data.msg,\n\t\t\t\t\t\ticon: 'none'\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t}\n\t\t})\n\t}\n\t\n\t// 发送验证码\n\tfunction sendCode() {\n\t\tif (buttonMsg.value != \"发送验证码\") {\n\t\t\tuni.showToast({\n\t\t\t\ttitle: '请点击发送验证码',\n\t\t\t\ticon: 'none'\n\t\t\t})\n\t\t\treturn\n\t\t}\n\t\t//检测是否已经填写手机号\n\t\tif (telPhone.value == \"\" || telPhone.value == \"\") {\n\t\t\tuni.showToast({\n\t\t\t\ttitle: '请输入手机号和密码',\n\t\t\t\ticon: 'none',\n\t\t\t});\n\t\t\treturn\n\t\t}\n\t\t//检查手机号规则是否合法\n\t\tif (!(/^1[3456789]\\d{9}$/.test(telPhone.value))) {\n\t\t\tuni.showToast({\n\t\t\t\ttitle: '手机号格式错误',\n\t\t\t\ticon: 'none',\n\t\t\t});\n\t\t\treturn\n\t\t}\n\t\tbuttonMsg.value = \"发送中\"\n\t\tuni.request({\n\t\t\turl: websiteUrl + '/send-sms-code',\n\t\t\tmethod: \"POST\",\n\t\t\theader: {\n\t\t\t\t'Authorization': uni.getStorageSync('token'),\n\t\t\t},\n\t\t\tdata: {\n\t\t\t\ttel_phone: telPhone.value,\n\t\t\t},\n\t\t\tsuccess: (res) => {\n\t\t\t\tconsole.log(res.data)\n\t\t\t\tif (res.data.status == \"success\") {\n\t\t\t\t\tbuttonMsg.value = \"已发送\";\n\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\ttitle: '发送成功',\n\t\t\t\t\t\ticon: 'success'\n\t\t\t\t\t})\n\t\t\t\t} else {\n\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\ttitle: res.data.msg,\n\t\t\t\t\t\ticon: 'none'\n\t\t\t\t\t})\n\t\t\t\t\tbuttonMsg.value = \"发送验证码\"\n\t\t\t\t}\n\t\t\t}\n\t\t})\n\t}\r\n\r\n\r\n\tgetUserInfo();\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\n\ttext {\n\t\tfont-size: 26rpx;\n\t}\r\n\t.light_button {\r\n\t\tcolor: #fff;\r\n\t\tbackground: #65C3D6;\r\n\t\tbox-shadow: 0 0 3px #1ed1e1;\r\n\t\tborder: 0px;\r\n\t\tmargin: 20px 0px;\r\n\t\tborder-radius: 15px;\r\n\r\n\t}\n\t.light_button:active {\n\t\tbackground: #4e98a9;\n\t}\n\t\r\n\r\n\t.inputer {\r\n\t\t\tfont-size: 28rpx;\r\n\t\tborder-bottom: 1px #ddd solid;\r\n\t\tpadding: 10px;\r\n\t\tmargin: 40px 0px;\r\n\t}\r\n</style>","import MiniProgramPage from '/Users/sapphirell/Documents/git/dogdogdoll-uniapp/pages/setting/tel_phone/tel_phone.vue'\nwx.createPage(MiniProgramPage)"],"names":["uni","ref","websiteUrl","getUserInfo"],"mappings":";;;;;;;;;;;;;;AAqCCA,kBAAAA,MAAI,sBAAsB;AAAA,MACzB,OAAO;AAAA,IACT,CAAE;AAED,QAAI,WAAWC,cAAG,IAAC,EAAE;AACrB,QAAI,OAAOA,cAAG,IAAC,EAAE;AACjB,QAAI,YAAYA,cAAG,IAAC,OAAO;AAE3B,aAAS,iBAAiB;AACzBD,oBAAAA,MAAI,QAAQ;AAAA,QACX,KAAKE,cAAU,aAAG;AAAA,QAClB,QAAQ;AAAA,QACR,QAAQ;AAAA,UACP,iBAAiBF,cAAAA,MAAI,eAAe,OAAO;AAAA,QAC3C;AAAA,QACD,MAAM;AAAA,UACL,WAAW,SAAS;AAAA,UACpB,MAAM,KAAK;AAAA,QACX;AAAA,QACD,SAAS,CAAC,QAAQ;AACjBA,wBAAAA,MAAA,MAAA,OAAA,+CAAY,IAAI,IAAI;AACpB,cAAI,IAAI,KAAK,UAAU,WAAW;AACjCA,0BAAAA,MAAI,UAAU;AAAA,cACb,OAAO;AAAA,cACP,MAAM;AAAA,YACZ,CAAM;AACDG,0BAAAA;UACL,OAAW;AACNH,0BAAAA,MAAI,UAAU;AAAA,cACb,OAAO,IAAI,KAAK;AAAA,cAChB,MAAM;AAAA,YACZ,CAAM;AAAA,UACD;AAAA,QACD;AAAA,MACJ,CAAG;AAAA,IACD;AAGD,aAAS,WAAW;AACnB,UAAI,UAAU,SAAS,SAAS;AAC/BA,sBAAAA,MAAI,UAAU;AAAA,UACb,OAAO;AAAA,UACP,MAAM;AAAA,QACV,CAAI;AACD;AAAA,MACA;AAED,UAAI,SAAS,SAAS,MAAM,SAAS,SAAS,IAAI;AACjDA,sBAAAA,MAAI,UAAU;AAAA,UACb,OAAO;AAAA,UACP,MAAM;AAAA,QACV,CAAI;AACD;AAAA,MACA;AAED,UAAI,CAAE,oBAAoB,KAAK,SAAS,KAAK,GAAI;AAChDA,sBAAAA,MAAI,UAAU;AAAA,UACb,OAAO;AAAA,UACP,MAAM;AAAA,QACV,CAAI;AACD;AAAA,MACA;AACD,gBAAU,QAAQ;AAClBA,oBAAAA,MAAI,QAAQ;AAAA,QACX,KAAKE,cAAU,aAAG;AAAA,QAClB,QAAQ;AAAA,QACR,QAAQ;AAAA,UACP,iBAAiBF,cAAAA,MAAI,eAAe,OAAO;AAAA,QAC3C;AAAA,QACD,MAAM;AAAA,UACL,WAAW,SAAS;AAAA,QACpB;AAAA,QACD,SAAS,CAAC,QAAQ;AACjBA,wBAAAA,MAAA,MAAA,OAAA,gDAAY,IAAI,IAAI;AACpB,cAAI,IAAI,KAAK,UAAU,WAAW;AACjC,sBAAU,QAAQ;AAClBA,0BAAAA,MAAI,UAAU;AAAA,cACb,OAAO;AAAA,cACP,MAAM;AAAA,YACZ,CAAM;AAAA,UACN,OAAW;AACNA,0BAAAA,MAAI,UAAU;AAAA,cACb,OAAO,IAAI,KAAK;AAAA,cAChB,MAAM;AAAA,YACZ,CAAM;AACD,sBAAU,QAAQ;AAAA,UAClB;AAAA,QACD;AAAA,MACJ,CAAG;AAAA,IACD;AAGDG,kBAAAA;;;;;;;;;;;;;;;;;;;;;;AChID,GAAG,WAAW,eAAe;"}