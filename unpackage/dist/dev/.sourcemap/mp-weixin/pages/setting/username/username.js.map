{"version":3,"file":"username.js","sources":["pages/setting/username/username.vue","pages/setting/username/username.vue?type=page"],"sourcesContent":["<template>\n  <view class=\"password-container\">\n    <view class=\"form-wrapper\">\n      <view class=\"input-group\">\n        <view class=\"input-item\">\n          <input \n            class=\"input\" \n            type=\"text\" \n            placeholder=\" \" \n            v-model=\"username\" \n            maxlength=\"20\"\n          />\n          <label class=\"floating-label\">用户名</label>\n          <uni-icons class=\"input-icon\" type=\"person\" size=\"18\" color=\"#999\" />\n        </view>\n      </view>\n\n      <button \n        class=\"submit-btn\" \n        :class=\"{active: isFormValid}\" \n        @click=\"updateUsername\"\n        :disabled=\"!isFormValid\"\n      >\n        {{ isLoading ? '提交中...' : '更新用户名' }}\n        <view class=\"loading\" v-if=\"isLoading\"></view>\n      </button>\n    </view>\n\n    <view class=\"security-tips\">\n      <uni-icons type=\"info\" size=\"16\" color=\"#666\" />\n      <text>用户名2-20个字符，支持中英文、数字和下划线</text>\n    </view>\n  </view>\n</template>\n\n<script setup>\nimport { ref, computed } from 'vue'\nimport { websiteUrl, global, getUserInfo } from \"../../../common/config.js\"\n\nuni.setNavigationBarTitle({\n  title: '修改用户名'\n})\n\nconst username = ref(global.userInfo.username || '')\nconst isLoading = ref(false)\n\n// 表单验证\nconst isFormValid = computed(() => {\n  return username.value.length >= 2 && \n         username.value !== global.userInfo.username\n})\n\n// 更新用户名\nasync function updateUsername() {\n  if (!isFormValid.value) return\n  \n  try {\n    isLoading.value = true\n    const res = await uni.request({\n      url: websiteUrl + '/with-state/update-profile',\n      method: 'POST',\n      header: {\n        'Authorization': uni.getStorageSync('token')\n      },\n      data: {\n        username: username.value\n      }\n    })\n\n    if (res.data.status === \"success\") {\n      uni.showToast({\n        title: '更新成功',\n        icon: 'success'\n      })\n      // 更新全局用户信息\n      await getUserInfo()\n      setTimeout(() => uni.navigateBack(), 1500)\n    } else {\n      uni.showToast({\n        title: res.data.msg || '更新失败',\n        icon: 'none'\n      })\n    }\n  } catch (error) {\n    uni.showToast({\n      title: '请求失败，请稍后重试',\n      icon: 'none'\n    })\n  } finally {\n    isLoading.value = false\n  }\n}\n</script>\n\n<style lang=\"less\" scoped>\n\t@primary-color: #65C3D6;\n\t@error-color: #ff5252;\n\t@success-color: #4CAF50;\n\t@bg-color: #f5f7fa;\n\t\n\t.password-container {\n\t\tpadding: 40rpx;\n\t\tbackground: @bg-color;\n\t\tmin-height: 100vh;\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t}\n\t\n\t.form-wrapper {\n\t\tbackground: #fff;\n\t\tborder-radius: 24rpx;\n\t\tpadding: 40rpx;\n\t\tbox-shadow: 0 8rpx 24rpx rgba(0, 0, 0, 0.04);\n\t}\n\t\n\t.input-group {\n\t\tmargin-bottom: 40rpx;\n\t}\n\t\n\t.input-item {\n\t\tmargin-bottom: 48rpx;\n\t\tposition: relative;\n\t\n\t\t&:last-child {\n\t\t\tmargin-bottom: 0;\n\t\t}\n\t}\n\t\n\t.input {\n\t\theight: 100rpx;\n\t\tpadding: 0 80rpx 0 40rpx;\n\t\tfont-size: 32rpx;\n\t\tborder: 2rpx solid #e0e0e0;\n\t\tborder-radius: 16rpx;\n\t\ttransition: all 0.3s ease;\n\t\n\t\t&:focus {\n\t\t\tborder-color: @primary-color;\n\t\t\tbox-shadow: 0 4rpx 12rpx rgba(101, 195, 214, 0.2);\n\t\n\t\t\t&+.floating-label {\n\t\t\t\ttransform: translateY(-220%);\n\t\t\t\tfont-size: 26rpx;\n\t\t\t\tcolor: @primary-color;\n\t\t\t}\n\t\t}\n\t}\n\t\n\t.floating-label {\n\t\tposition: absolute;\n\t\tleft: 40rpx;\n\t\ttop: 60%;\n\t\ttransform: translateY(-50%);\n\t\tcolor: #999;\n\t\tfont-size: 32rpx;\n\t\tpointer-events: none;\n\t\ttransition: all 0.3s ease;\n\t\tbackground: #fff;\n\t\n\t\t.input:not(:placeholder-shown)+&,\n\t\t.input:focus+& {\n\t\t\ttransform: translateY(-220%);\n\t\t\tfont-size: 26rpx;\n\t\t}\n\t}\n\t\n\t.input-icon {\n\t\tposition: absolute;\n\t\tright: 30rpx;\n\t\ttop: 50%;\n\t\ttransform: translateY(-50%);\n\t}\n\t\n\t.password-strength {\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tgap: 16rpx;\n\t\tmargin: 32rpx 0;\n\t\n\t\t.strength-bar {\n\t\t\theight: 8rpx;\n\t\t\tflex: 1;\n\t\t\tbackground: #eee;\n\t\t\tborder-radius: 4rpx;\n\t\t\ttransition: all 0.3s ease;\n\t\n\t\t\t&.weak {\n\t\t\t\tbackground: @error-color;\n\t\t\t}\n\t\n\t\t\t&.medium {\n\t\t\t\tbackground: #ffb300;\n\t\t\t}\n\t\n\t\t\t&.strong {\n\t\t\t\tbackground: @success-color;\n\t\t\t}\n\t\t}\n\t\n\t\t.strength-text {\n\t\t\tfont-size: 26rpx;\n\t\t\tcolor: #666;\n\t\t}\n\t}\n\t\n\t.submit-btn {\n\t\twidth: 100%;\n\t\theight: 96rpx;\n\t\tbackground: linear-gradient(135deg, #65C3D6 0%, #4CA1AF 100%);\n\t\tcolor: #fff;\n\t\tfont-size: 32rpx;\n\t\tborder-radius: 16rpx;\n\t\tborder: none;\n\t\tposition: relative;\n\t\toverflow: hidden;\n\t\ttransition: all 0.3s ease;\n\t\tline-height: 96rpx;\n\t\n\t\n\t\t&:active {\n\t\t\ttransform: scale(0.98);\n\t\t\topacity: 0.9;\n\t\t}\n\t\n\t\t&.active {\n\t\t\tbox-shadow: 0 8rpx 24rpx rgba(101, 195, 214, 0.3);\n\t\t}\n\t\n\t\t.loading {\n\t\t\tposition: absolute;\n\t\t\tright: 30rpx;\n\t\t\ttop: 50%;\n\t\t\ttransform: translateY(-50%);\n\t\t\twidth: 32rpx;\n\t\t\theight: 32rpx;\n\t\t\tborder: 3rpx solid #fff;\n\t\t\tborder-top-color: transparent;\n\t\t\tborder-radius: 50%;\n\t\t\tanimation: spin 0.8s linear infinite;\n\t\t}\n\t}\n\t\n\t.security-tips {\n\t\tmargin-top: 40rpx;\n\t\tpadding: 24rpx;\n\t\tbackground: #fff;\n\t\tborder-radius: 16rpx;\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tgap: 12rpx;\n\t\tfont-size: 26rpx;\n\t\tcolor: #666;\n\t\t\n\t\t.uni-icons {\n\t\t\tflex: 1;\n\t\t}\n\t\n\t\ttext {\n\t\t\tflex: 6;\n\t\t}\n\t}\n\t\n\t@keyframes spin {\n\t\tto {\n\t\t\ttransform: translateY(-50%) rotate(360deg);\n\t\t}\n\t}\n\n/* 新增用户名输入样式 */\n.input-item {\n  position: relative;\n  margin-bottom: 60rpx;\n}\n\n.input {\n  &[type=\"text\"] {\n    letter-spacing: 0.5rpx;\n  }\n}\n</style>\n","import MiniProgramPage from '/Users/sapphirell/Documents/git/dogdogdoll-uniapp/pages/setting/username/username.vue'\nwx.createPage(MiniProgramPage)"],"names":["uni","ref","global","computed","websiteUrl","getUserInfo"],"mappings":";;;;;;;;;;;;;;AAuCAA,kBAAG,MAAC,sBAAsB;AAAA,MACxB,OAAO;AAAA,IACT,CAAC;AAED,UAAM,WAAWC,cAAAA,IAAIC,cAAAA,OAAO,SAAS,YAAY,EAAE;AACnD,UAAM,YAAYD,cAAG,IAAC,KAAK;AAG3B,UAAM,cAAcE,cAAQ,SAAC,MAAM;AACjC,aAAO,SAAS,MAAM,UAAU,KACzB,SAAS,UAAUD,qBAAO,SAAS;AAAA,IAC5C,CAAC;AAGD,mBAAe,iBAAiB;AAC9B,UAAI,CAAC,YAAY;AAAO;AAExB,UAAI;AACF,kBAAU,QAAQ;AAClB,cAAM,MAAM,MAAMF,cAAG,MAAC,QAAQ;AAAA,UAC5B,KAAKI,cAAU,aAAG;AAAA,UAClB,QAAQ;AAAA,UACR,QAAQ;AAAA,YACN,iBAAiBJ,cAAAA,MAAI,eAAe,OAAO;AAAA,UAC5C;AAAA,UACD,MAAM;AAAA,YACJ,UAAU,SAAS;AAAA,UACpB;AAAA,QACP,CAAK;AAED,YAAI,IAAI,KAAK,WAAW,WAAW;AACjCA,wBAAAA,MAAI,UAAU;AAAA,YACZ,OAAO;AAAA,YACP,MAAM;AAAA,UACd,CAAO;AAED,gBAAMK,0BAAa;AACnB,qBAAW,MAAML,cAAAA,MAAI,aAAY,GAAI,IAAI;AAAA,QAC/C,OAAW;AACLA,wBAAAA,MAAI,UAAU;AAAA,YACZ,OAAO,IAAI,KAAK,OAAO;AAAA,YACvB,MAAM;AAAA,UACd,CAAO;AAAA,QACF;AAAA,MACF,SAAQ,OAAO;AACdA,sBAAAA,MAAI,UAAU;AAAA,UACZ,OAAO;AAAA,UACP,MAAM;AAAA,QACZ,CAAK;AAAA,MACL,UAAY;AACR,kBAAU,QAAQ;AAAA,MACnB;AAAA,IACH;;;;;;;;;;;;;;;;;;;;;;;;;;AC1FA,GAAG,WAAW,eAAe;"}