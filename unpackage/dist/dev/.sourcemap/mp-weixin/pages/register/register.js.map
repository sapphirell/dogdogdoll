{"version":3,"file":"register.js","sources":["pages/register/register.vue","pages/register/register.vue?type=page"],"sourcesContent":["<template>\r\n\t<view-logs />\r\n\t<view class=\"container\">\r\n\t\t<view class=\"header\">\r\n\t\t\t<text class=\"title\">手机号注册</text>\r\n\t\t</view>\r\n\r\n\t\t<view class=\"form-box\">\r\n\t\t\t<!-- 手机号输入 -->\r\n\t\t\t<view class=\"input-item\">\r\n\t\t\t\t<view class=\"input-wrapper\">\r\n\t\t\t\t\t<text class=\"prefix\">+86</text>\r\n\t\t\t\t\t<input v-model=\"formData.telephone\" type=\"number\" placeholder=\"请输入手机号\" maxlength=\"11\" class=\"input\"\r\n\t\t\t\t\t\tplaceholder-class=\"placeholder\" @blur=\"validatePhone\" />\r\n\t\t\t\t</view>\r\n\t\t\t\t<text v-if=\"errors.phone\" class=\"error-text\">{{ errors.phone }}</text>\r\n\t\t\t</view>\r\n\r\n\t\t\t<!-- 验证码输入 -->\r\n\t\t\t<view class=\"input-item\">\r\n\t\t\t\t<view class=\"code-wrapper\">\r\n\t\t\t\t\t<input v-model=\"formData.code\" type=\"number\" autocomplete=\"new-password\" placeholder=\"请输入验证码\"\r\n\t\t\t\t\t\tmaxlength=\"6\" class=\"input\" placeholder-class=\"placeholder\" @blur=\"validateCode\" />\r\n\t\t\t\t\t<button class=\"code-btn\" :disabled=\"codeBtnDisabled\" @click=\"sendSmsCode\"\r\n\t\t\t\t\t\t:class=\"{ disabled: codeBtnDisabled }\">\r\n\t\t\t\t\t\t{{ codeBtnText }}\r\n\t\t\t\t\t</button>\r\n\t\t\t\t</view>\r\n\t\t\t\t<text v-if=\"errors.code\" class=\"error-text\">{{ errors.code }}</text>\r\n\t\t\t</view>\r\n\r\n\t\t\t<!-- 密码输入 -->\r\n\t\t\t<view class=\"input-item\">\r\n\t\t\t\t<view class=\"input-wrapper\">\r\n\t\t\t\t\t<input v-model=\"formData.password\" autocomplete=\"new-password\" type=\"password\"\r\n\t\t\t\t\t\tplaceholder=\"请输入密码（至少6位）\" class=\"input\" placeholder-class=\"placeholder\"\r\n\t\t\t\t\t\t@blur=\"validatePassword\" />\r\n\t\t\t\t</view>\r\n\t\t\t\t<text v-if=\"errors.password\" class=\"error-text\">{{ errors.password }}</text>\r\n\t\t\t</view>\r\n\r\n\t\t\t<!-- 确认密码 -->\r\n\t\t\t<view class=\"input-item\">\r\n\t\t\t\t<view class=\"input-wrapper\">\r\n\t\t\t\t\t<input v-model=\"formData.rePassword\" type=\"password\" placeholder=\"请再次输入密码\" class=\"input\"\r\n\t\t\t\t\t\tplaceholder-class=\"placeholder\" @blur=\"validateRePassword\" />\r\n\t\t\t\t</view>\r\n\t\t\t\t<text v-if=\"errors.rePassword\" class=\"error-text\">{{ errors.rePassword }}</text>\r\n\t\t\t</view>\r\n\r\n\t\t\t<!-- 注册按钮 -->\r\n\t\t\t<button class=\"submit-btn\" :disabled=\"loading\" @click=\"handleRegister\" :class=\"{ loading: loading }\">\r\n\t\t\t\t{{ loading ? '注册中...' : '立即注册' }}\r\n\t\t\t</button>\r\n\r\n\t\t\t<!-- 已有账号 -->\r\n\t\t\t<view class=\"bottom-tips\">\r\n\t\t\t\t已有账号？\r\n\t\t\t\t<text class=\"link-text\" @click=\"navigateToLogin\">去登录</text>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t</view>\r\n</template>\r\n<script setup>\r\n\timport {\r\n\t\tref,\r\n\t\tcomputed\r\n\t} from 'vue'\r\n\timport {\r\n\t\twebsiteUrl\r\n\t} from '@/common/config.js'\r\n\r\n\tconst formData = ref({\r\n\t\ttelephone: '',\r\n\t\tcode: '',\r\n\t\tpassword: '',\r\n\t\trePassword: ''\r\n\t})\r\n\r\n\tconst errors = ref({\r\n\t\tphone: '',\r\n\t\tcode: '',\r\n\t\tpassword: '',\r\n\t\trePassword: ''\r\n\t})\r\n\r\n\t// 验证码按钮状态\r\n\tconst codeCountdown = ref(0)\r\n\tconst codeBtnDisabled = computed(() => codeCountdown.value > 0)\r\n\tconst codeBtnText = computed(() =>\r\n\t\tcodeCountdown.value > 0 ? `${codeCountdown.value}秒后重发` : '获取验证码'\r\n\t)\r\n\r\n\t// 加载状态\r\n\tconst loading = ref(false)\r\n\r\n\t// 验证手机号\r\n\tconst validatePhone = () => {\r\n\t\tif (!formData.value.telephone) {\r\n\t\t\terrors.value.phone = '手机号不能为空'\r\n\t\t\treturn false\r\n\t\t}\r\n\t\tif (!/^1[3-9]\\d{9}$/.test(formData.value.telephone)) {\r\n\t\t\terrors.value.phone = '手机号格式不正确'\r\n\t\t\treturn false\r\n\t\t}\r\n\t\terrors.value.phone = ''\r\n\t\treturn true\r\n\t}\r\n\r\n\t// 发送验证码\r\n\tconst sendSmsCode = async () => {\r\n\t\tif (!validatePhone()) return\r\n\r\n\t\ttry {\r\n\t\t\tconst res = await uni.request({\r\n\t\t\t\turl: `${websiteUrl}/send-sms-code`,\r\n\t\t\t\tmethod: 'POST',\r\n\t\t\t\tdata: {\r\n\t\t\t\t\ttel_phone: formData.value.telephone\r\n\t\t\t\t}\r\n\t\t\t})\r\n\r\n\t\t\tif (res.data.status === 'success') {\r\n\t\t\t\tstartCountdown()\r\n\t\t\t\tuni.showToast({\r\n\t\t\t\t\ttitle: '验证码已发送',\r\n\t\t\t\t\ticon: 'none'\r\n\t\t\t\t})\r\n\t\t\t} else {\r\n\t\t\t\tuni.showToast({\r\n\t\t\t\t\ttitle: res.data.msg || '发送失败',\r\n\t\t\t\t\ticon: 'none'\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t} catch (err) {\r\n\t\t\tuni.showToast({\r\n\t\t\t\ttitle: '网络请求失败',\r\n\t\t\t\ticon: 'none'\r\n\t\t\t})\r\n\t\t}\r\n\t}\r\n\r\n\t// 倒计时处理\r\n\tconst startCountdown = () => {\r\n\t\tcodeCountdown.value = 60\r\n\t\tconst timer = setInterval(() => {\r\n\t\t\tif (codeCountdown.value <= 0) {\r\n\t\t\t\tclearInterval(timer)\r\n\t\t\t\treturn\r\n\t\t\t}\r\n\t\t\tcodeCountdown.value--\r\n\t\t}, 1000)\r\n\t}\r\n\r\n\t// 验证密码\r\n\tconst validatePassword = () => {\r\n\t\tif (formData.value.password.length < 6) {\r\n\t\t\terrors.value.password = '密码至少需要6位'\r\n\t\t\treturn false\r\n\t\t}\r\n\t\terrors.value.password = ''\r\n\t\treturn true\r\n\t}\r\n\r\n\t// 验证确认密码\r\n\tconst validateRePassword = () => {\r\n\t\tif (formData.value.password !== formData.value.rePassword) {\r\n\t\t\terrors.value.rePassword = '两次密码输入不一致'\r\n\t\t\treturn false\r\n\t\t}\r\n\t\terrors.value.rePassword = ''\r\n\t\treturn true\r\n\t}\r\n\r\n\t// 验证验证码\r\n\tconst validateCode = () => {\r\n\t\tif (!formData.value.code) {\r\n\t\t\terrors.value.code = '验证码不能为空'\r\n\t\t\treturn false\r\n\t\t}\r\n\t\tif (formData.value.code.length !== 6) {\r\n\t\t\terrors.value.code = '验证码格式不正确'\r\n\t\t\treturn false\r\n\t\t}\r\n\t\terrors.value.code = ''\r\n\t\treturn true\r\n\t}\r\n\r\n\t// 注册处理\r\n\tconst handleRegister = async () => {\r\n\t\tconst validations = [\r\n\t\t\tvalidatePhone(),\r\n\t\t\tvalidateCode(),\r\n\t\t\tvalidatePassword(),\r\n\t\t\tvalidateRePassword()\r\n\t\t]\r\n\r\n\t\tif (!validations.every(v => v)) return\r\n\r\n\t\ttry {\r\n\t\t\tloading.value = true\r\n\t\t\tconst res = await uni.request({\r\n\t\t\t\turl: `${websiteUrl}/register`,\r\n\t\t\t\tmethod: 'POST',\r\n\t\t\t\tdata: {\r\n\t\t\t\t\ttelephone: formData.value.telephone,\r\n\t\t\t\t\tcode: formData.value.code,\r\n\t\t\t\t\tpassword: formData.value.password,\r\n\t\t\t\t\tre_password: formData.value.rePassword\r\n\t\t\t\t}\r\n\t\t\t})\r\n\r\n\t\t\tif (res.data.status === 'success') {\r\n\t\t\t\tuni.setStorageSync('token', res.data.data.jwt_token)\r\n\t\t\t\tuni.showToast({\r\n\t\t\t\t\ttitle: '注册成功',\r\n\t\t\t\t\ticon: 'success',\r\n\t\t\t\t\tcomplete: () => {\r\n\t\t\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\t\t\tuni.switchTab({\r\n\t\t\t\t\t\t\t\turl: '/pages/mine/mine'\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t}, 1500)\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t} else {\r\n\t\t\t\tuni.showToast({\r\n\t\t\t\t\ttitle: res.data.msg || '注册失败',\r\n\t\t\t\t\ticon: 'none'\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t} catch (err) {\r\n\t\t\tuni.showToast({\r\n\t\t\t\ttitle: '网络请求失败',\r\n\t\t\t\ticon: 'none'\r\n\t\t\t})\r\n\t\t} finally {\r\n\t\t\tloading.value = false\r\n\t\t}\r\n\t}\r\n\r\n\t// 跳转登录\r\n\tconst navigateToLogin = () => {\r\n\t\tuni.navigateTo({\r\n\t\t\turl: '/pages/login/login'\r\n\t\t})\r\n\t}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n\t$primary-color: #a6e9f7;\r\n\t$hover-color: #1ed1e1;\r\n\t$border-color: #e6e6e6;\r\n\t$radius: 8px;\r\n\r\n\t.container {\r\n\t\tpadding: 60rpx 48rpx;\r\n\t\tmin-height: 100vh;\r\n\t\tbackground: #f8f9fa;\r\n\t}\r\n\r\n\t.header {\r\n\t\tmargin-bottom: 96rpx;\r\n\r\n\t\t.title {\r\n\t\t\tfont-size: 56rpx;\r\n\t\t\tfont-weight: 600;\r\n\t\t\tcolor: #333;\r\n\t\t\tline-height: 1.4;\r\n\t\t}\r\n\t}\r\n\r\n\t.form-box {\r\n\t\t.input-item {\r\n\t\t\tmargin-bottom: 48rpx;\r\n\r\n\t\t\t.item-label {\r\n\t\t\t\tdisplay: block;\r\n\t\t\t\tfont-size: 28rpx;\r\n\t\t\t\tcolor: #666;\r\n\t\t\t\tmargin-bottom: 24rpx;\r\n\t\t\t}\r\n\r\n\t\t\t/* 统一输入框容器样式 */\r\n\t\t\t.input-wrapper,\r\n\t\t\t.code-wrapper {\r\n\t\t\t\tposition: relative;\r\n\t\t\t\theight: 96rpx;\r\n\t\t\t\tbackground: #ffffff;\r\n\t\t\t\tborder-radius: 16rpx;\r\n\t\t\t\t// border: 2rpx solid #e5e5e5;\r\n\t\t\t\tpadding: 0 24rpx;\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\talign-items: center;\r\n\t\t\t}\r\n\r\n\t\t\t/* 手机号前缀样式 */\r\n\t\t\t.prefix {\r\n\t\t\t\tfont-size: 28rpx;\r\n\t\t\t\tcolor: #666;\r\n\t\t\t\tmargin-right: 16rpx;\r\n\t\t\t}\r\n\r\n\t\t\t/* 输入框通用样式 */\r\n\t\t\t.input {\r\n\t\t\t\tflex: 1;\r\n\t\t\t\theight: 100%;\r\n\t\t\t\tfont-size: 28rpx;\r\n\t\t\t\tcolor: #333;\r\n\t\t\t}\r\n\r\n\t\t\t/* 验证码容器特殊处理 */\r\n\t\t\t.code-wrapper {\r\n\t\t\t\tpadding: 0;\r\n\t\t\t\toverflow: hidden;\r\n\r\n\t\t\t\t.input {\r\n\t\t\t\t\tpadding: 0 24rpx;\r\n\t\t\t\t\tborder-right: 2rpx solid #e5e5e5;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t/* 验证码按钮样式 */\r\n\t\t\t.code-btn {\r\n\t\t\t\twidth: 220rpx;\r\n\t\t\t\theight: 100%;\r\n\t\t\t\tline-height: 90rpx;\r\n\t\t\t\t// background: #81ffff;\r\n\t\t\t\tbackground: linear-gradient(135deg, $primary-color, $hover-color);\r\n\t\t\t\tborder-radius: 0;\r\n\t\t\t\tfont-size: 28rpx;\r\n\t\t\t\tcolor: #fff;\r\n\t\t\t\tpadding: 0;\r\n\t\t\t\ttransition: all 0.3s;\r\n\r\n\t\t\t\t&::after {\r\n\t\t\t\t\tborder: none;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t&.disabled {\r\n\t\t\t\t\tbackground: #c8c9cc;\r\n\t\t\t\t\tcolor: #fff;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t.placeholder {\r\n\t\t\t\tcolor: #cccccc;\r\n\t\t\t\tfont-size: 28rpx;\r\n\t\t\t}\r\n\r\n\t\t\t.error-text {\r\n\t\t\t\tdisplay: block;\r\n\t\t\t\tmargin-top: 16rpx;\r\n\t\t\t\tcolor: #ff4d4f;\r\n\t\t\t\tfont-size: 24rpx;\r\n\t\t\t\tline-height: 1.4;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t.submit-btn {\r\n\t\t\tmargin-top: 60rpx;\r\n\t\t\tbackground: linear-gradient(135deg, $primary-color, $hover-color);\r\n\t\t\tcolor: white;\r\n\t\t\tborder: none;\r\n\t\t\tborder-radius: 50rpx;\r\n\t\t\tfont-size: 32rpx;\r\n\t\t\theight: 90rpx;\r\n\t\t\tline-height: 90rpx;\r\n\t\t\tbox-shadow: 0 6rpx 20rpx rgba($primary-color, 0.3);\r\n\t\t\ttransition: all 0.3s;\r\n\t\t\twidth: 100%;\r\n\r\n\t\t\t&::after {\r\n\t\t\t\tborder: none;\r\n\t\t\t}\r\n\r\n\t\t\t&.loading {\r\n\t\t\t\topacity: 0.7;\r\n\t\t\t\tbackground: #007aff;\r\n\t\t\t}\r\n\r\n\t\t\t&[disabled] {\r\n\t\t\t\tbackground: #c8c9cc;\r\n\t\t\t\tcolor: #fff;\r\n\t\t\t}\r\n\r\n\t\t\t&:active {\r\n\t\t\t\ttransform: translateY(2rpx);\r\n\t\t\t\tbox-shadow: 0 4rpx 12rpx rgba($primary-color, 0.3);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t.bottom-tips {\r\n\t\t\ttext-align: center;\r\n\t\t\tmargin-top: 48rpx;\r\n\t\t\tfont-size: 28rpx;\r\n\t\t\tcolor: #666;\r\n\r\n\t\t\t.link-text {\r\n\t\t\t\tcolor: #007aff;\r\n\t\t\t\tmargin-left: 16rpx;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t.submit-button {}\r\n</style>","import MiniProgramPage from '/Users/sapphirell/Documents/git/dogdogdoll-uniapp/pages/register/register.vue'\nwx.createPage(MiniProgramPage)"],"names":["ref","computed","uni","websiteUrl"],"mappings":"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"}