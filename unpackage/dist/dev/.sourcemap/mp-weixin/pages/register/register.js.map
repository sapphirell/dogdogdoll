{"version":3,"file":"register.js","sources":["pages/register/register.vue","pages/register/register.vue?type=page"],"sourcesContent":["<template>\n  <view class=\"container\">\n    <view class=\"header\">\n      <text class=\"title\">手机号注册</text>\n    </view>\n\n    <view class=\"form-box\">\n      <!-- 手机号输入 -->\n      <view class=\"input-item\">\n        <view class=\"input-wrapper\">\n          <text class=\"prefix\">+86</text>\n          <input\n            v-model=\"formData.telephone\"\n            type=\"number\"\n            placeholder=\"请输入手机号\"\n            maxlength=\"11\"\n            class=\"input\"\n            placeholder-class=\"placeholder\"\n            @blur=\"validatePhone\"\n          />\n        </view>\n        <text v-if=\"errors.phone\" class=\"error-text\">{{ errors.phone }}</text>\n      </view>\n\n      <!-- 验证码输入 -->\n      <view class=\"input-item\">\n        <view class=\"code-wrapper\">\n          <input\n            v-model=\"formData.code\"\n            type=\"number\"\n\t\t\tautocomplete=\"new-password\" \n            placeholder=\"请输入验证码\"\n            maxlength=\"6\"\n            class=\"input\"\n            placeholder-class=\"placeholder\"\n            @blur=\"validateCode\"\n          />\n          <button \n            class=\"code-btn\" \n            :disabled=\"codeBtnDisabled\"\n            @click=\"sendSmsCode\"\n            :class=\"{ disabled: codeBtnDisabled }\"\n          >\n            {{ codeBtnText }}\n          </button>\n        </view>\n        <text v-if=\"errors.code\" class=\"error-text\">{{ errors.code }}</text>\n      </view>\n\n      <!-- 密码输入 -->\n      <view class=\"input-item\">\n        <view class=\"input-wrapper\">\n          <input\n            v-model=\"formData.password\"\n\t\t\tautocomplete=\"new-password\" \n            type=\"password\"\n            placeholder=\"请输入密码（至少6位）\"\n            class=\"input\"\n            placeholder-class=\"placeholder\"\n            @blur=\"validatePassword\"\n          />\n        </view>\n        <text v-if=\"errors.password\" class=\"error-text\">{{ errors.password }}</text>\n      </view>\n\n      <!-- 确认密码 -->\n      <view class=\"input-item\">\n        <view class=\"input-wrapper\">\n          <input\n            v-model=\"formData.rePassword\"\n            type=\"password\"\n            placeholder=\"请再次输入密码\"\n            class=\"input\"\n            placeholder-class=\"placeholder\"\n            @blur=\"validateRePassword\"\n          />\n        </view>\n        <text v-if=\"errors.rePassword\" class=\"error-text\">{{ errors.rePassword }}</text>\n      </view>\n\n      <!-- 注册按钮 -->\n      <button \n        class=\"submit-btn\" \n        :disabled=\"loading\" \n        @click=\"handleRegister\"\n        :class=\"{ loading: loading }\"\n      >\n        {{ loading ? '注册中...' : '立即注册' }}\n      </button>\n\n      <!-- 已有账号 -->\n      <view class=\"bottom-tips\">\n        已有账号？\n        <text class=\"link-text\" @click=\"navigateToLogin\">去登录</text>\n      </view>\n    </view>\n  </view>\n</template>\n<script setup>\nimport { ref, computed } from 'vue'\nimport { websiteUrl } from '@/common/config.js'\n\nconst formData = ref({\n  telephone: '',\n  code: '',\n  password: '',\n  rePassword: ''\n})\n\nconst errors = ref({\n  phone: '',\n  code: '',\n  password: '',\n  rePassword: ''\n})\n\n// 验证码按钮状态\nconst codeCountdown = ref(0)\nconst codeBtnDisabled = computed(() => codeCountdown.value > 0)\nconst codeBtnText = computed(() => \n  codeCountdown.value > 0 ? `${codeCountdown.value}秒后重发` : '获取验证码'\n)\n\n// 加载状态\nconst loading = ref(false)\n\n// 验证手机号\nconst validatePhone = () => {\n  if (!formData.value.telephone) {\n    errors.value.phone = '手机号不能为空'\n    return false\n  }\n  if (!/^1[3-9]\\d{9}$/.test(formData.value.telephone)) {\n    errors.value.phone = '手机号格式不正确'\n    return false\n  }\n  errors.value.phone = ''\n  return true\n}\n\n// 发送验证码\nconst sendSmsCode = async () => {\n  if (!validatePhone()) return\n  \n  try {\n    const res = await uni.request({\n      url: `${websiteUrl}/send-sms-code`,\n      method: 'POST',\n      data: { tel_phone: formData.value.telephone }\n    })\n\n    if (res.data.status === 'success') {\n      startCountdown()\n      uni.showToast({ title: '验证码已发送', icon: 'none' })\n    } else {\n      uni.showToast({ title: res.data.msg || '发送失败', icon: 'none' })\n    }\n  } catch (err) {\n    uni.showToast({ title: '网络请求失败', icon: 'none' })\n  }\n}\n\n// 倒计时处理\nconst startCountdown = () => {\n  codeCountdown.value = 60\n  const timer = setInterval(() => {\n    if (codeCountdown.value <= 0) {\n      clearInterval(timer)\n      return\n    }\n    codeCountdown.value--\n  }, 1000)\n}\n\n// 验证密码\nconst validatePassword = () => {\n  if (formData.value.password.length < 6) {\n    errors.value.password = '密码至少需要6位'\n    return false\n  }\n  errors.value.password = ''\n  return true\n}\n\n// 验证确认密码\nconst validateRePassword = () => {\n  if (formData.value.password !== formData.value.rePassword) {\n    errors.value.rePassword = '两次密码输入不一致'\n    return false\n  }\n  errors.value.rePassword = ''\n  return true\n}\n\n// 验证验证码\nconst validateCode = () => {\n  if (!formData.value.code) {\n    errors.value.code = '验证码不能为空'\n    return false\n  }\n  if (formData.value.code.length !== 6) {\n    errors.value.code = '验证码格式不正确'\n    return false\n  }\n  errors.value.code = ''\n  return true\n}\n\n// 注册处理\nconst handleRegister = async () => {\n  const validations = [\n    validatePhone(),\n    validateCode(),\n    validatePassword(),\n    validateRePassword()\n  ]\n\n  if (!validations.every(v => v)) return\n\n  try {\n    loading.value = true\n    const res = await uni.request({\n      url: `${websiteUrl}/register`,\n      method: 'POST',\n      data: {\n        telephone: formData.value.telephone,\n        code: formData.value.code,\n        password: formData.value.password,\n        re_password: formData.value.rePassword\n      }\n    })\n\n    if (res.data.status === 'success') {\n      uni.setStorageSync('token', res.data.data.jwt_token)\n      uni.showToast({\n        title: '注册成功',\n        icon: 'success',\n        complete: () => {\n          setTimeout(() => {\n            uni.switchTab({ url: '/pages/mine/mine' })\n          }, 1500)\n        }\n      })\n    } else {\n      uni.showToast({ title: res.data.msg || '注册失败', icon: 'none' })\n    }\n  } catch (err) {\n    uni.showToast({ title: '网络请求失败', icon: 'none' })\n  } finally {\n    loading.value = false\n  }\n}\n\n// 跳转登录\nconst navigateToLogin = () => {\n  uni.navigateTo({ url: '/pages/login/login' })\n}\n\n</script>\n\n<style lang=\"scss\" scoped>\n\t$primary-color: #a6e9f7;\n\t$hover-color: #1ed1e1;\n\t$border-color: #e6e6e6;\n\t$radius: 8px;\n.container {\n  padding: 60rpx 48rpx;\n  min-height: 100vh;\n  background: #f8f9fa;\n}\n\n.header {\n  margin-bottom: 96rpx;\n  .title {\n    font-size: 56rpx;\n    font-weight: 600;\n    color: #333;\n    line-height: 1.4;\n  }\n}\n\n.form-box {\n  .input-item {\n    margin-bottom: 48rpx;\n    .item-label {\n      display: block;\n      font-size: 28rpx;\n      color: #666;\n      margin-bottom: 24rpx;\n    }\n\n    /* 统一输入框容器样式 */\n    .input-wrapper, .code-wrapper {\n      position: relative;\n      height: 96rpx;\n      background: #ffffff;\n      border-radius: 16rpx;\n      // border: 2rpx solid #e5e5e5;\n      padding: 0 24rpx;\n      display: flex;\n      align-items: center;\n    }\n\n    /* 手机号前缀样式 */\n    .prefix {\n      font-size: 28rpx;\n      color: #666;\n      margin-right: 16rpx;\n    }\n\n    /* 输入框通用样式 */\n    .input {\n      flex: 1;\n      height: 100%;\n      font-size: 28rpx;\n      color: #333;\n    }\n\n    /* 验证码容器特殊处理 */\n    .code-wrapper {\n      padding: 0;\n      overflow: hidden;\n      .input {\n        padding: 0 24rpx;\n        border-right: 2rpx solid #e5e5e5;\n      }\n    }\n\n    /* 验证码按钮样式 */\n    .code-btn {\n      width: 220rpx;\n      height: 100%;\n\t  line-height: 90rpx;\n      // background: #81ffff;\n\t  \tbackground: linear-gradient(135deg, $primary-color, $hover-color);\n      border-radius: 0;\n      font-size: 28rpx;\n      color: #fff;\n      padding: 0;\n      transition: all 0.3s;\n      \n      &::after {\n        border: none;\n      }\n      \n      &.disabled {\n        background: #c8c9cc;\n        color: #fff;\n      }\n    }\n\n    .placeholder {\n      color: #cccccc;\n      font-size: 28rpx;\n    }\n\n    .error-text {\n      display: block;\n      margin-top: 16rpx;\n      color: #ff4d4f;\n      font-size: 24rpx;\n      line-height: 1.4;\n    }\n  }\n\n  .submit-btn {\n\tmargin-top: 60rpx;\n\tbackground: linear-gradient(135deg, $primary-color, $hover-color);\n\tcolor: white;\n\tborder: none;\n\tborder-radius: 50rpx;\n\tfont-size: 32rpx;\n\theight: 90rpx;\n\tline-height: 90rpx;\n\tbox-shadow: 0 6rpx 20rpx rgba($primary-color, 0.3);\n\ttransition: all 0.3s;\n\twidth: 100%;\n\n    &::after {\n      border: none;\n    }\n    \n    &.loading {\n      opacity: 0.7;\n      background: #007aff;\n    }\n    \n    &[disabled] {\n      background: #c8c9cc;\n      color: #fff;\n    }\n\t\n\t&:active {\n\t\ttransform: translateY(2rpx);\n\t\tbox-shadow: 0 4rpx 12rpx rgba($primary-color, 0.3);\n\t}\n  }\n\n  .bottom-tips {\n    text-align: center;\n    margin-top: 48rpx;\n    font-size: 28rpx;\n    color: #666;\n    .link-text {\n      color: #007aff;\n      margin-left: 16rpx;\n    }\n  }\n}\n\n\t.submit-button {\n\n\t\t\n\n\t}\n</style>","import MiniProgramPage from '/Users/sapphirell/Documents/git/dogdogdoll-uniapp/pages/register/register.vue'\nwx.createPage(MiniProgramPage)"],"names":["ref","computed","uni","websiteUrl"],"mappings":";;;;;;AAsGA,UAAM,WAAWA,cAAAA,IAAI;AAAA,MACnB,WAAW;AAAA,MACX,MAAM;AAAA,MACN,UAAU;AAAA,MACV,YAAY;AAAA,IACd,CAAC;AAED,UAAM,SAASA,cAAAA,IAAI;AAAA,MACjB,OAAO;AAAA,MACP,MAAM;AAAA,MACN,UAAU;AAAA,MACV,YAAY;AAAA,IACd,CAAC;AAGD,UAAM,gBAAgBA,cAAG,IAAC,CAAC;AAC3B,UAAM,kBAAkBC,cAAAA,SAAS,MAAM,cAAc,QAAQ,CAAC;AAC9D,UAAM,cAAcA,cAAAA;AAAAA,MAAS,MAC3B,cAAc,QAAQ,IAAI,GAAG,cAAc,KAAK,SAAS;AAAA,IAC3D;AAGA,UAAM,UAAUD,cAAG,IAAC,KAAK;AAGzB,UAAM,gBAAgB,MAAM;AAC1B,UAAI,CAAC,SAAS,MAAM,WAAW;AAC7B,eAAO,MAAM,QAAQ;AACrB,eAAO;AAAA,MACR;AACD,UAAI,CAAC,gBAAgB,KAAK,SAAS,MAAM,SAAS,GAAG;AACnD,eAAO,MAAM,QAAQ;AACrB,eAAO;AAAA,MACR;AACD,aAAO,MAAM,QAAQ;AACrB,aAAO;AAAA,IACT;AAGA,UAAM,cAAc,YAAY;AAC9B,UAAI,CAAC,cAAa;AAAI;AAEtB,UAAI;AACF,cAAM,MAAM,MAAME,cAAG,MAAC,QAAQ;AAAA,UAC5B,KAAK,GAAGC,cAAU,UAAA;AAAA,UAClB,QAAQ;AAAA,UACR,MAAM,EAAE,WAAW,SAAS,MAAM,UAAW;AAAA,QACnD,CAAK;AAED,YAAI,IAAI,KAAK,WAAW,WAAW;AACjC,yBAAgB;AAChBD,wBAAG,MAAC,UAAU,EAAE,OAAO,UAAU,MAAM,QAAQ;AAAA,QACrD,OAAW;AACLA,8BAAI,UAAU,EAAE,OAAO,IAAI,KAAK,OAAO,QAAQ,MAAM,QAAQ;AAAA,QAC9D;AAAA,MACF,SAAQ,KAAK;AACZA,sBAAG,MAAC,UAAU,EAAE,OAAO,UAAU,MAAM,QAAQ;AAAA,MAChD;AAAA,IACH;AAGA,UAAM,iBAAiB,MAAM;AAC3B,oBAAc,QAAQ;AACtB,YAAM,QAAQ,YAAY,MAAM;AAC9B,YAAI,cAAc,SAAS,GAAG;AAC5B,wBAAc,KAAK;AACnB;AAAA,QACD;AACD,sBAAc;AAAA,MACf,GAAE,GAAI;AAAA,IACT;AAGA,UAAM,mBAAmB,MAAM;AAC7B,UAAI,SAAS,MAAM,SAAS,SAAS,GAAG;AACtC,eAAO,MAAM,WAAW;AACxB,eAAO;AAAA,MACR;AACD,aAAO,MAAM,WAAW;AACxB,aAAO;AAAA,IACT;AAGA,UAAM,qBAAqB,MAAM;AAC/B,UAAI,SAAS,MAAM,aAAa,SAAS,MAAM,YAAY;AACzD,eAAO,MAAM,aAAa;AAC1B,eAAO;AAAA,MACR;AACD,aAAO,MAAM,aAAa;AAC1B,aAAO;AAAA,IACT;AAGA,UAAM,eAAe,MAAM;AACzB,UAAI,CAAC,SAAS,MAAM,MAAM;AACxB,eAAO,MAAM,OAAO;AACpB,eAAO;AAAA,MACR;AACD,UAAI,SAAS,MAAM,KAAK,WAAW,GAAG;AACpC,eAAO,MAAM,OAAO;AACpB,eAAO;AAAA,MACR;AACD,aAAO,MAAM,OAAO;AACpB,aAAO;AAAA,IACT;AAGA,UAAM,iBAAiB,YAAY;AACjC,YAAM,cAAc;AAAA,QAClB,cAAe;AAAA,QACf,aAAc;AAAA,QACd,iBAAkB;AAAA,QAClB,mBAAoB;AAAA,MACrB;AAED,UAAI,CAAC,YAAY,MAAM,OAAK,CAAC;AAAG;AAEhC,UAAI;AACF,gBAAQ,QAAQ;AAChB,cAAM,MAAM,MAAMA,cAAG,MAAC,QAAQ;AAAA,UAC5B,KAAK,GAAGC,cAAU,UAAA;AAAA,UAClB,QAAQ;AAAA,UACR,MAAM;AAAA,YACJ,WAAW,SAAS,MAAM;AAAA,YAC1B,MAAM,SAAS,MAAM;AAAA,YACrB,UAAU,SAAS,MAAM;AAAA,YACzB,aAAa,SAAS,MAAM;AAAA,UAC7B;AAAA,QACP,CAAK;AAED,YAAI,IAAI,KAAK,WAAW,WAAW;AACjCD,wBAAG,MAAC,eAAe,SAAS,IAAI,KAAK,KAAK,SAAS;AACnDA,wBAAAA,MAAI,UAAU;AAAA,YACZ,OAAO;AAAA,YACP,MAAM;AAAA,YACN,UAAU,MAAM;AACd,yBAAW,MAAM;AACfA,8BAAAA,MAAI,UAAU,EAAE,KAAK,mBAAkB,CAAE;AAAA,cAC1C,GAAE,IAAI;AAAA,YACR;AAAA,UACT,CAAO;AAAA,QACP,OAAW;AACLA,8BAAI,UAAU,EAAE,OAAO,IAAI,KAAK,OAAO,QAAQ,MAAM,QAAQ;AAAA,QAC9D;AAAA,MACF,SAAQ,KAAK;AACZA,sBAAG,MAAC,UAAU,EAAE,OAAO,UAAU,MAAM,QAAQ;AAAA,MACnD,UAAY;AACR,gBAAQ,QAAQ;AAAA,MACjB;AAAA,IACH;AAGA,UAAM,kBAAkB,MAAM;AAC5BA,oBAAAA,MAAI,WAAW,EAAE,KAAK,qBAAoB,CAAE;AAAA,IAC9C;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC/PA,GAAG,WAAW,eAAe;"}