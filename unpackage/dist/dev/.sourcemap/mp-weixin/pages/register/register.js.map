{"version":3,"file":"register.js","sources":["pages/register/register.vue","pages/register/register.vue?type=page"],"sourcesContent":["<template>\n\t<view-logs />\n\t<view class=\"container\">\n\t\t<view class=\"header\">\n\t\t\t<text class=\"title\">手机号注册</text>\n\t\t</view>\n\n\t\t<view class=\"form-box\">\n\t\t\t<!-- 手机号输入 -->\n\t\t\t<view class=\"input-item\">\n\t\t\t\t<view class=\"input-wrapper\">\n\t\t\t\t\t<text class=\"prefix\">+86</text>\n\t\t\t\t\t<input v-model=\"formData.telephone\" type=\"number\" placeholder=\"请输入手机号\" maxlength=\"11\" class=\"input\"\n\t\t\t\t\t\tplaceholder-class=\"placeholder\" @blur=\"validatePhone\" />\n\t\t\t\t</view>\n\t\t\t\t<text v-if=\"errors.phone\" class=\"error-text\">{{ errors.phone }}</text>\n\t\t\t</view>\n\n\t\t\t<!-- 验证码输入 -->\n\t\t\t<view class=\"input-item\">\n\t\t\t\t<view class=\"code-wrapper\">\n\t\t\t\t\t<input v-model=\"formData.code\" type=\"number\" autocomplete=\"new-password\" placeholder=\"请输入验证码\"\n\t\t\t\t\t\tmaxlength=\"6\" class=\"input\" placeholder-class=\"placeholder\" @blur=\"validateCode\" />\n\t\t\t\t\t<button class=\"code-btn\" :disabled=\"codeBtnDisabled\" @click=\"sendSmsCode\"\n\t\t\t\t\t\t:class=\"{ disabled: codeBtnDisabled }\">\n\t\t\t\t\t\t{{ codeBtnText }}\n\t\t\t\t\t</button>\n\t\t\t\t</view>\n\t\t\t\t<text v-if=\"errors.code\" class=\"error-text\">{{ errors.code }}</text>\n\t\t\t</view>\n\n\t\t\t<!-- 密码输入 -->\n\t\t\t<view class=\"input-item\">\n\t\t\t\t<view class=\"input-wrapper\">\n\t\t\t\t\t<input v-model=\"formData.password\" autocomplete=\"new-password\" type=\"password\"\n\t\t\t\t\t\tplaceholder=\"请输入密码（至少6位）\" class=\"input\" placeholder-class=\"placeholder\"\n\t\t\t\t\t\t@blur=\"validatePassword\" />\n\t\t\t\t</view>\n\t\t\t\t<text v-if=\"errors.password\" class=\"error-text\">{{ errors.password }}</text>\n\t\t\t</view>\n\n\t\t\t<!-- 确认密码 -->\n\t\t\t<view class=\"input-item\">\n\t\t\t\t<view class=\"input-wrapper\">\n\t\t\t\t\t<input v-model=\"formData.rePassword\" type=\"password\" placeholder=\"请再次输入密码\" class=\"input\"\n\t\t\t\t\t\tplaceholder-class=\"placeholder\" @blur=\"validateRePassword\" />\n\t\t\t\t</view>\n\t\t\t\t<text v-if=\"errors.rePassword\" class=\"error-text\">{{ errors.rePassword }}</text>\n\t\t\t</view>\n\n\t\t\t<!-- 注册按钮 -->\n\t\t\t<button class=\"submit-btn\" :disabled=\"loading\" @click=\"handleRegister\" :class=\"{ loading: loading }\">\n\t\t\t\t{{ loading ? '注册中...' : '立即注册' }}\n\t\t\t</button>\n\n\t\t\t<!-- 已有账号 -->\n\t\t\t<view class=\"bottom-tips\">\n\t\t\t\t已有账号？\n\t\t\t\t<text class=\"link-text\" @click=\"navigateToLogin\">去登录</text>\n\t\t\t</view>\n\t\t</view>\n\t</view>\n</template>\n<script setup>\n\timport {\n\t\tref,\n\t\tcomputed\n\t} from 'vue'\n\timport {\n\t\twebsiteUrl\n\t} from '@/common/config.js'\n\n\tconst formData = ref({\n\t\ttelephone: '',\n\t\tcode: '',\n\t\tpassword: '',\n\t\trePassword: ''\n\t})\n\n\tconst errors = ref({\n\t\tphone: '',\n\t\tcode: '',\n\t\tpassword: '',\n\t\trePassword: ''\n\t})\n\n\t// 验证码按钮状态\n\tconst codeCountdown = ref(0)\n\tconst codeBtnDisabled = computed(() => codeCountdown.value > 0)\n\tconst codeBtnText = computed(() =>\n\t\tcodeCountdown.value > 0 ? `${codeCountdown.value}秒后重发` : '获取验证码'\n\t)\n\n\t// 加载状态\n\tconst loading = ref(false)\n\n\t// 验证手机号\n\tconst validatePhone = () => {\n\t\tif (!formData.value.telephone) {\n\t\t\terrors.value.phone = '手机号不能为空'\n\t\t\treturn false\n\t\t}\n\t\tif (!/^1[3-9]\\d{9}$/.test(formData.value.telephone)) {\n\t\t\terrors.value.phone = '手机号格式不正确'\n\t\t\treturn false\n\t\t}\n\t\terrors.value.phone = ''\n\t\treturn true\n\t}\n\n\t// 发送验证码\n\tconst sendSmsCode = async () => {\n\t\tif (!validatePhone()) return\n\n\t\ttry {\n\t\t\tconst res = await uni.request({\n\t\t\t\turl: `${websiteUrl.value}/send-sms-code`,\n\t\t\t\tmethod: 'POST',\n\t\t\t\tdata: {\n\t\t\t\t\ttel_phone: formData.value.telephone\n\t\t\t\t}\n\t\t\t})\n\n\t\t\tif (res.data.status === 'success') {\n\t\t\t\tstartCountdown()\n\t\t\t\tuni.showToast({\n\t\t\t\t\ttitle: '验证码已发送',\n\t\t\t\t\ticon: 'none'\n\t\t\t\t})\n\t\t\t} else {\n\t\t\t\tuni.showToast({\n\t\t\t\t\ttitle: res.data.msg || '发送失败',\n\t\t\t\t\ticon: 'none'\n\t\t\t\t})\n\t\t\t}\n\t\t} catch (err) {\n\t\t\tuni.showToast({\n\t\t\t\ttitle: '网络请求失败',\n\t\t\t\ticon: 'none'\n\t\t\t})\n\t\t}\n\t}\n\n\t// 倒计时处理\n\tconst startCountdown = () => {\n\t\tcodeCountdown.value = 60\n\t\tconst timer = setInterval(() => {\n\t\t\tif (codeCountdown.value <= 0) {\n\t\t\t\tclearInterval(timer)\n\t\t\t\treturn\n\t\t\t}\n\t\t\tcodeCountdown.value--\n\t\t}, 1000)\n\t}\n\n\t// 验证密码\n\tconst validatePassword = () => {\n\t\tif (formData.value.password.length < 6) {\n\t\t\terrors.value.password = '密码至少需要6位'\n\t\t\treturn false\n\t\t}\n\t\terrors.value.password = ''\n\t\treturn true\n\t}\n\n\t// 验证确认密码\n\tconst validateRePassword = () => {\n\t\tif (formData.value.password !== formData.value.rePassword) {\n\t\t\terrors.value.rePassword = '两次密码输入不一致'\n\t\t\treturn false\n\t\t}\n\t\terrors.value.rePassword = ''\n\t\treturn true\n\t}\n\n\t// 验证验证码\n\tconst validateCode = () => {\n\t\tif (!formData.value.code) {\n\t\t\terrors.value.code = '验证码不能为空'\n\t\t\treturn false\n\t\t}\n\t\tif (formData.value.code.length !== 6) {\n\t\t\terrors.value.code = '验证码格式不正确'\n\t\t\treturn false\n\t\t}\n\t\terrors.value.code = ''\n\t\treturn true\n\t}\n\n\t// 注册处理\n\tconst handleRegister = async () => {\n\t\tconst validations = [\n\t\t\tvalidatePhone(),\n\t\t\tvalidateCode(),\n\t\t\tvalidatePassword(),\n\t\t\tvalidateRePassword()\n\t\t]\n\n\t\tif (!validations.every(v => v)) return\n\n\t\ttry {\n\t\t\tloading.value = true\n\t\t\tconst res = await uni.request({\n\t\t\t\turl: `${websiteUrl.value}/register`,\n\t\t\t\tmethod: 'POST',\n\t\t\t\tdata: {\n\t\t\t\t\ttelephone: formData.value.telephone,\n\t\t\t\t\tcode: formData.value.code,\n\t\t\t\t\tpassword: formData.value.password,\n\t\t\t\t\tre_password: formData.value.rePassword\n\t\t\t\t}\n\t\t\t})\n\n\t\t\tif (res.data.status === 'success') {\n\t\t\t\tuni.setStorageSync('token', res.data.data.jwt_token)\n\t\t\t\tuni.showToast({\n\t\t\t\t\ttitle: '注册成功',\n\t\t\t\t\ticon: 'success',\n\t\t\t\t\tcomplete: () => {\n\t\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\t\tuni.switchTab({\n\t\t\t\t\t\t\t\turl: '/pages/mine/mine'\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t}, 1500)\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t} else {\n\t\t\t\tuni.showToast({\n\t\t\t\t\ttitle: res.data.msg || '注册失败',\n\t\t\t\t\ticon: 'none'\n\t\t\t\t})\n\t\t\t}\n\t\t} catch (err) {\n\t\t\tuni.showToast({\n\t\t\t\ttitle: '网络请求失败',\n\t\t\t\ticon: 'none'\n\t\t\t})\n\t\t} finally {\n\t\t\tloading.value = false\n\t\t}\n\t}\n\n\t// 跳转登录\n\tconst navigateToLogin = () => {\n\t\tuni.navigateTo({\n\t\t\turl: '/pages/login/login'\n\t\t})\n\t}\n</script>\n\n<style lang=\"scss\" scoped>\n\t$primary-color: #a6e9f7;\n\t$hover-color: #1ed1e1;\n\t$border-color: #e6e6e6;\n\t$radius: 8px;\n\n\t.container {\n\t\tpadding: 60rpx 48rpx;\n\t\tmin-height: 100vh;\n\t\tbackground: #f8f9fa;\n\t}\n\n\t.header {\n\t\tmargin-bottom: 96rpx;\n\n\t\t.title {\n\t\t\tfont-size: 56rpx;\n\t\t\tfont-weight: 600;\n\t\t\tcolor: #333;\n\t\t\tline-height: 1.4;\n\t\t}\n\t}\n\n\t.form-box {\n\t\t.input-item {\n\t\t\tmargin-bottom: 48rpx;\n\n\t\t\t.item-label {\n\t\t\t\tdisplay: block;\n\t\t\t\tfont-size: 28rpx;\n\t\t\t\tcolor: #666;\n\t\t\t\tmargin-bottom: 24rpx;\n\t\t\t}\n\n\t\t\t/* 统一输入框容器样式 */\n\t\t\t.input-wrapper,\n\t\t\t.code-wrapper {\n\t\t\t\tposition: relative;\n\t\t\t\theight: 96rpx;\n\t\t\t\tbackground: #ffffff;\n\t\t\t\tborder-radius: 16rpx;\n\t\t\t\t// border: 2rpx solid #e5e5e5;\n\t\t\t\tpadding: 0 24rpx;\n\t\t\t\tdisplay: flex;\n\t\t\t\talign-items: center;\n\t\t\t}\n\n\t\t\t/* 手机号前缀样式 */\n\t\t\t.prefix {\n\t\t\t\tfont-size: 28rpx;\n\t\t\t\tcolor: #666;\n\t\t\t\tmargin-right: 16rpx;\n\t\t\t}\n\n\t\t\t/* 输入框通用样式 */\n\t\t\t.input {\n\t\t\t\tflex: 1;\n\t\t\t\theight: 100%;\n\t\t\t\tfont-size: 28rpx;\n\t\t\t\tcolor: #333;\n\t\t\t}\n\n\t\t\t/* 验证码容器特殊处理 */\n\t\t\t.code-wrapper {\n\t\t\t\tpadding: 0;\n\t\t\t\toverflow: hidden;\n\n\t\t\t\t.input {\n\t\t\t\t\tpadding: 0 24rpx;\n\t\t\t\t\tborder-right: 2rpx solid #e5e5e5;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t/* 验证码按钮样式 */\n\t\t\t.code-btn {\n\t\t\t\twidth: 220rpx;\n\t\t\t\theight: 100%;\n\t\t\t\tline-height: 90rpx;\n\t\t\t\t// background: #81ffff;\n\t\t\t\tbackground: linear-gradient(135deg, $primary-color, $hover-color);\n\t\t\t\tborder-radius: 0;\n\t\t\t\tfont-size: 28rpx;\n\t\t\t\tcolor: #fff;\n\t\t\t\tpadding: 0;\n\t\t\t\ttransition: all 0.3s;\n\n\t\t\t\t&::after {\n\t\t\t\t\tborder: none;\n\t\t\t\t}\n\n\t\t\t\t&.disabled {\n\t\t\t\t\tbackground: #c8c9cc;\n\t\t\t\t\tcolor: #fff;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t.placeholder {\n\t\t\t\tcolor: #cccccc;\n\t\t\t\tfont-size: 28rpx;\n\t\t\t}\n\n\t\t\t.error-text {\n\t\t\t\tdisplay: block;\n\t\t\t\tmargin-top: 16rpx;\n\t\t\t\tcolor: #ff4d4f;\n\t\t\t\tfont-size: 24rpx;\n\t\t\t\tline-height: 1.4;\n\t\t\t}\n\t\t}\n\n\t\t.submit-btn {\n\t\t\tmargin-top: 60rpx;\n\t\t\tbackground: linear-gradient(135deg, $primary-color, $hover-color);\n\t\t\tcolor: white;\n\t\t\tborder: none;\n\t\t\tborder-radius: 50rpx;\n\t\t\tfont-size: 32rpx;\n\t\t\theight: 90rpx;\n\t\t\tline-height: 90rpx;\n\t\t\tbox-shadow: 0 6rpx 20rpx rgba($primary-color, 0.3);\n\t\t\ttransition: all 0.3s;\n\t\t\twidth: 100%;\n\n\t\t\t&::after {\n\t\t\t\tborder: none;\n\t\t\t}\n\n\t\t\t&.loading {\n\t\t\t\topacity: 0.7;\n\t\t\t\tbackground: #007aff;\n\t\t\t}\n\n\t\t\t&[disabled] {\n\t\t\t\tbackground: #c8c9cc;\n\t\t\t\tcolor: #fff;\n\t\t\t}\n\n\t\t\t&:active {\n\t\t\t\ttransform: translateY(2rpx);\n\t\t\t\tbox-shadow: 0 4rpx 12rpx rgba($primary-color, 0.3);\n\t\t\t}\n\t\t}\n\n\t\t.bottom-tips {\n\t\t\ttext-align: center;\n\t\t\tmargin-top: 48rpx;\n\t\t\tfont-size: 28rpx;\n\t\t\tcolor: #666;\n\n\t\t\t.link-text {\n\t\t\t\tcolor: #007aff;\n\t\t\t\tmargin-left: 16rpx;\n\t\t\t}\n\t\t}\n\t}\n\n\t.submit-button {}\n</style>","import MiniProgramPage from '/Users/sapphirell/Documents/git/dogdogdoll-uniapp/pages/register/register.vue'\nwx.createPage(MiniProgramPage)"],"names":["ref","computed","uni","websiteUrl"],"mappings":"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"}