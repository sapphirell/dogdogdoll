{"version":3,"file":"account_book_form.js","sources":["pages/stock/account_book_form/account_book_form.vue","pages/stock/account_book_form/account_book_form.vue?type=page"],"sourcesContent":["<template>\r\n\t<view class=\"container\">\r\n\t\t<meta name=\"theme-color\" content=\"#F8F8F8\">\r\n\t\t</meta>\r\n\t\t<!-- 分类管理弹窗 -->\r\n\t\t<common-modal :visible=\"typeModalVisible\" @update:visible=\"val => typeModalVisible = val\" top=\"100rpx\" height=\"60%\">\r\n\t\t\t<view class=\"type-modal\">\r\n\t\t\t\t<view class=\"add-type-form\">\r\n\t\t\t\t\t<input v-model=\"newTypeName\" placeholder=\"输入新分类名称\" class=\"type-input\" />\r\n\t\t\t\t\t<button class=\"add-btn\" @tap=\"addNewType\">添加分类</button>\r\n\t\t\t\t</view>\r\n\t\t\t\t<view class=\"type-list\">\r\n\t\t\t\t\t<view v-for=\"(type, index) in customTypes\" :key=\"type.id\" class=\"type-item\">\r\n\t\t\t\t\t\t<text>{{ type.name }}</text>\r\n\t\t\t\t\t\t<uni-icons type=\"trash\" size=\"22\" color=\"#ff6666\" @tap=\"deleteType(type.id)\"></uni-icons>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t</common-modal>\r\n\t\t<!-- 表单卡片容器 -->\r\n\t\t<view class=\"form-card\">\r\n\t\t\t<!-- 分类选择 -->\r\n\t\t\t<view class=\"form-item\">\r\n\t\t\t\t<text class=\"form-label\">分类</text>\r\n\t\t\t\t<view class=\"type-selector\">\r\n\t\t\t\t\t<picker mode=\"selector\" class=\"form-input\" :value=\"selectedType\" :range=\"typeOptions\"\r\n\t\t\t\t\t\t@change=\"updateSelectedType\">\r\n\t\t\t\t\t\t<view class=\"picker-content\">\r\n\t\t\t\t\t\t\t{{ typeOptions[selectedType] || '请选择分类' }}\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t</picker>\r\n\t\t\t\t\t<text class=\"manage-type\" @tap=\"typeModalVisible = true\">管理分类</text>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\r\n\t\t\t<!-- 名称 -->\r\n\t\t\t<view class=\"form-item\">\r\n\t\t\t\t<text class=\"form-label\">名称</text>\r\n\t\t\t\t<view class=\"form-input\" style=\"padding: 0;\">\r\n\t\t\t\t\t<goods-search :font-size=\"'24rpx'\" mode=\"fill\" @select=\"handleGoodsSelect\" v-model=\"name\"\r\n\t\t\t\t\t\t:background=\"'#fff'\" :width=\"'640rpx'\" :show-icon=\"false\" class=\"custom-search\" />\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\r\n\t\t\t<!-- 价值 -->\r\n\t\t\t<view class=\"form-item\">\r\n\t\t\t\t<text class=\"form-label\">价值</text>\r\n\t\t\t\t<input class=\"form-input\" type=\"digit\" placeholder=\"请输入价值\" placeholder-class=\"placeholder-style\"\r\n\t\t\t\t\tv-model=\"price\" />\r\n\t\t\t</view>\r\n\r\n\t\t\t<!-- 图片上传 -->\r\n\t\t\t<view class=\"form-item\">\r\n\t\t\t\t<text class=\"form-label\">物品图片</text>\r\n\t\t\t\t<view class=\"upload-wrapper\">\r\n\t\t\t\t\t<view v-if=\"accountImage\" class=\"preview-image\" @click.stop=\"selectImage\">\r\n\t\t\t\t\t\t<image mode=\"aspectFill\" :src=\"accountImage\" class=\"image-preview\"></image>\r\n\t\t\t\t\t\t<text class=\"image-tip\">点击更换图片</text>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<button class=\"upload-button\" @click=\"selectImage\" v-else>\r\n\t\t\t\t\t\t<text class=\"iconfont icon-camera\"></text>\r\n\t\t\t\t\t\t选择图片\r\n\t\t\t\t\t</button>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\r\n\t\t\t<!-- 尺寸选择器 -->\n\t\t\t<view class=\"form-item\">\n\t\t\t    <text class=\"form-label\">尺寸</text>\n\t\t\t    <uni-data-picker placeholder=\"请选择尺寸\" :localdata=\"sizeOptions\" \n\t\t\t        :value=\"selectedSizePath\" @change=\"onSizeChange\" class=\"size-picker\">\n\t\t\t    </uni-data-picker>\n\t\t\t</view>\r\n\r\n\t\t\t<!-- 更多信息折叠区域 -->\r\n\t\t\t<view class=\"form-item\">\r\n\t\t\t\t<label class=\"remind-label\" @tap=\"toggleMoreInfo()\">\r\n\t\t\t\t\t<uni-icons type=\"right\" size=\"20\" v-if=\"!showMoreInfo\" color=\"#888\"></uni-icons>\r\n\t\t\t\t\t<uni-icons type=\"down\" size=\"20\" color=\"#888\" v-else></uni-icons>\r\n\t\t\t\t\t<text>更多信息</text>\r\n\t\t\t\t</label>\r\n\t\t\t</view>\r\n\r\n\t\t\t<view v-if=\"showMoreInfo\" class=\"more-info-form\">\r\n\t\t\t\t<!-- 尺寸详情 -->\r\n\t\t\t\t<view class=\"form-item size_detail\">\r\n\t\t\t\t\t<text class=\"form-label\">尺寸详情</text>\r\n\t\t\t\t\t<input v-model=\"moreInfo.sizeDetail\" placeholder=\"请输入尺寸详情\" class=\"form-input\" />\r\n\t\t\t\t</view>\r\n\r\n\t\t\t\t<!-- 颜色 -->\r\n\t\t\t\t<view class=\"form-item\">\r\n\t\t\t\t\t<text class=\"form-label\">颜色</text>\r\n\t\t\t\t\t<input v-model=\"moreInfo.color\" placeholder=\"请输入颜色\" class=\"form-input\" />\r\n\t\t\t\t</view>\r\n\r\n\t\t\t\t<!-- 备注 -->\r\n\t\t\t\t<view class=\"form-item\">\r\n\t\t\t\t\t<text class=\"form-label\">备注</text>\r\n\t\t\t\t\t<input v-model=\"moreInfo.remark\" placeholder=\"请输入备注\" class=\"form-input\" />\r\n\t\t\t\t</view>\r\n\r\n\t\t\t\t<!-- 购入时间 -->\r\n\t\t\t\t<view class=\"form-item\">\r\n\t\t\t\t\t<text class=\"form-label\">购入时间</text>\r\n\t\t\t\t\t<picker mode=\"date\" :value=\"moreInfo.buyDate\" @change=\"(e) => moreInfo.buyDate = e.detail.value\"\r\n\t\t\t\t\t\tclass=\"form-input\">\r\n\t\t\t\t\t\t<view class=\"picker-content\">\r\n\t\t\t\t\t\t\t{{ moreInfo.buyDate || '选择购入日期' }}\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t</picker>\r\n\t\t\t\t</view>\r\n\r\n\t\t\t\t<!-- 存放位置 -->\r\n\t\t\t\t<view class=\"form-item\">\r\n\t\t\t\t\t<text class=\"form-label\">存放位置</text>\r\n\t\t\t\t\t<input v-model=\"moreInfo.position\" placeholder=\"请输入存放位置\" class=\"form-input\" />\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\r\n\t\t\t<!-- 补款提醒 -->\r\n\t\t\t<view class=\"form-item\">\r\n\t\t\t\t<label class=\"remind-label\" @tap=\"toggleRemind()\">\r\n\t\t\t\t\t<uni-icons type=\"right\" size=\"20\" v-if=\"!form.isRemind\" color=\"#888\"></uni-icons>\r\n\t\t\t\t\t<uni-icons type=\"down\" size=\"20\" color=\"#888\" v-else></uni-icons>\r\n\t\t\t\t\t<text>需要补款提醒</text>\r\n\t\t\t\t\t<!-- 新增小红点 -->\r\n\t\t\t\t\t<view v-if=\"form.finalPrice > 0 \" class=\"remind-dot\"></view>\r\n\t\t\t\t</label>\r\n\t\t\t</view>\r\n\r\n\t\t\t<view v-if=\"form.isRemind\" class=\"remind-form\" style=\"margin-bottom: 40rpx;\">\r\n\t\t\t\t<view class=\"form-item\">\r\n\t\t\t\t\t<text class=\"form-label\">尾款金额</text>\r\n\t\t\t\t\t<input type=\"number\" v-model=\"form.finalPrice\" placeholder=\"请输入待补款金额\" class=\"form-input\" />\r\n\t\t\t\t</view>\r\n\r\n\t\t\t\t<view class=\"form-item\">\r\n\t\t\t\t\t<text class=\"form-label\">补款日期</text>\r\n\t\t\t\t\t<picker mode=\"date\" :value=\"form.finalTime\" @change=\"form.finalTime = $event.detail.value\"\r\n\t\t\t\t\t\tclass=\"form-input\">\r\n\t\t\t\t\t\t<view class=\"picker-content\">\r\n\t\t\t\t\t\t\t{{ form.finalTime || '选择截止日期' }}\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t</picker>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t\t<view style=\"overflow: hidden;\">\r\n\t\t\t\t<image src=\"/static/info-circle.png\" mode=\"aspectFill\"\r\n\t\t\t\t\tstyle=\"width: 28rpx;height: 28rpx;margin-right: 10rpx; position: relative;top: 3rpx;\"></image>\r\n\t\t\t\t<text style=\"color: #888;\">仅用于记录您所购买过的物品，其他人不会看到</text>\r\n\t\t\t</view>\r\n\r\n\t\t\t<!-- 操作按钮 -->\r\n\t\t\t<view class=\"button-group\">\r\n\t\t\t\t<button class=\"delete-button\" v-if=\"isEdit\" @click=\"handleDelete\">\r\n\t\t\t\t\t删除账本\r\n\t\t\t\t</button>\r\n\t\t\t\t<button class=\"submit-button\" @click=\"postSubmit\">\r\n\t\t\t\t\t记录{{ isEdit ? '修改' : '新增' }}\r\n\t\t\t\t</button>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\r\n\r\n\t</view>\r\n</template>\r\n<script setup>\r\n\timport {\r\n\t\tref,\r\n\t\tcomputed,\r\n\t\tonMounted\r\n\t} from 'vue';\r\n\timport {\r\n\t\tonShow\r\n\t} from '@dcloudio/uni-app';\r\n\timport {\r\n\t\twebsiteUrl,\r\n\t\timage1Url,\r\n\t\twechatSignLogin,\r\n\t\tgetUserInfo,\r\n\t\tglobal,\r\n\t\tasyncGetUserInfo,\r\n\t} from \"../../../common/config.js\";\r\n\r\n\timport {\r\n\t\tchooseImage,\r\n\t\tjumpToCroper,\r\n\t\tgetQiniuToken,\r\n\t\tuploadImageToQiniu\r\n\t} from \"../../../common/image.js\";\r\n\r\n\r\n\tconst props = defineProps([\"account_book_id\"])\r\n\t//判断页面是否有参数，如果有代表编辑，如果没有代表新增\r\n\tconst isEdit = props.account_book_id ? true : false;\r\n\r\n\r\n\t// 状态栏高度\r\n\tconst systemInfo = uni.getSystemInfoSync();\r\n\tconst statusBarHeight = ref(systemInfo.statusBarHeight);\r\n\r\n\t// 提交表单数据\r\n\tlet name = ref(\"\");\r\n\tlet price = ref(\"\");\r\n\t// 当前激活的 tab\r\n\tconst activeTab = ref(1);\r\n\r\n\tfunction switch_tab(index) {\r\n\t\tactiveTab.value = index; // 切换激活 tab\r\n\t\tconsole.log(`切换到 tab ${index}`);\r\n\t}\r\n\t// 新增状态\r\n\tconst typeModalVisible = ref(false);\r\n\tconst newTypeName = ref('');\r\n\tconst customTypes = ref([]);\r\n\tconst defaultTypes = ['请选择', '娃衣', '娃头', '眼珠', '假发', '娃鞋', '其它'];\r\n\r\n\t// 组合分类选项\r\n\tconst typeOptions = computed(() => [\r\n\t\t...defaultTypes,\r\n\t\t...customTypes.value.map(t => t.name)\r\n\t]);\r\n\r\n\t// 表单数据\r\n\tconst form = ref({\r\n\t\tisRemind: false,\r\n\t\tfinalPrice: 0,\r\n\t\tfinalTime: ''\r\n\t});\r\n\r\n\t// 更多信息折叠状态\r\n\tconst showMoreInfo = ref(false);\r\n\r\n\t// 尺寸选择器数据\r\n\tconst sizeOptions = ref([]);\r\n\tconst selectedSize = ref([]);\n\t// 存储用户选择的尺寸路径 [大分类, 小分类]\n\tconst selectedSizePath = ref([]);\r\n\r\n\t// 更多信息数据\r\n\tconst moreInfo = ref({\r\n\t\tsizeDetail: '',\r\n\t\tcolor: '',\r\n\t\tremark: '',\r\n\t\tbuyDate: '',\r\n\t\tposition: ''\r\n\t});\r\n\r\n\t// 获取尺寸数据\r\n\tconst fetchSizes = async () => {\n\t  try {\n\t    const res = await uni.request({\n\t      url: websiteUrl + '/sizes',\n\t      method: 'GET'\n\t    });\n\t\n\t    if (res.data.status === \"success\") {\n\t      const sizesData = res.data.data;\n\t      const formattedSizes = [];\n\t\n\t      // 转换为正确的层级结构\n\t      for (const [category, items] of Object.entries(sizesData)) {\n\t        formattedSizes.push({\n\t          text: category,   // 大分类名称 (如\"二分\")\n\t          value: category,  // 大分类值\n\t          children: items.map(item => ({\n\t            text: item,     // 小分类名称 (如\"普通二分\")\n\t            value: item     // 小分类值\n\t          }))\n\t        });\n\t      }\n\t\n\t      sizeOptions.value = formattedSizes;\n\t    }\n\t  } catch (err) {\n\t    console.error('获取尺寸数据失败:', err);\n\t    uni.showToast({\n\t      title: '获取尺寸数据失败',\n\t      icon: 'none'\n\t    });\n\t  }\n\t};\r\n\r\n// 尺寸选择变化 - 修复处理逻辑\nconst onSizeChange = (e) => {\n  const nodes = e.detail.value;\n  \n  // 确保选择了完整路径 [大分类, 小分类]\n  if (nodes.length === 2) {\n    selectedSizePath.value = [\n      nodes[0].value, // 大分类值\n      nodes[1].value  // 小分类值\n    ];\n    \n    // 自动填充尺寸详情\n    moreInfo.value.sizeDetail = nodes[1].value;\n  } else {\n    selectedSizePath.value = [];\n    moreInfo.value.sizeDetail = '';\n  }\n};\n\r\n\t// 切换更多信息折叠\r\n\tconst toggleMoreInfo = () => {\r\n\t\tshowMoreInfo.value = !showMoreInfo.value;\r\n\t};\r\n\r\n\t// 获取分类数据\r\n\tconst getAccountTypes = async () => {\r\n\t\tconst token = uni.getStorageSync('token');\r\n\t\ttry {\r\n\t\t\tconst res = await uni.request({\r\n\t\t\t\turl: websiteUrl + '/with-state/account-types',\r\n\t\t\t\tmethod: 'GET',\r\n\t\t\t\theader: {\r\n\t\t\t\t\t'Authorization': token\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tcustomTypes.value = res.data.data || [];\r\n\t\t} catch (err) {\r\n\t\t\tconsole.error('获取分类失败:', err);\r\n\t\t}\r\n\t};\r\n\r\n\t// 添加分类\r\n\tconst addNewType = async () => {\r\n\t\tif (!newTypeName.value.trim()) {\r\n\t\t\tuni.showToast({\r\n\t\t\t\ttitle: '请输入分类名称',\r\n\t\t\t\ticon: 'none'\r\n\t\t\t});\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst token = uni.getStorageSync('token');\r\n\t\ttry {\r\n\t\t\tawait uni.request({\r\n\t\t\t\turl: websiteUrl + '/with-state/add-account-type',\r\n\t\t\t\tmethod: 'POST',\r\n\t\t\t\theader: {\r\n\t\t\t\t\t'Authorization': token\r\n\t\t\t\t},\r\n\t\t\t\tdata: {\r\n\t\t\t\t\tname: newTypeName.value.trim()\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tawait getAccountTypes();\r\n\t\t\tnewTypeName.value = '';\r\n\t\t\tuni.showToast({\r\n\t\t\t\ttitle: '添加成功'\r\n\t\t\t});\r\n\t\t} catch (err) {\r\n\t\t\tuni.showToast({\r\n\t\t\t\ttitle: '添加失败',\r\n\t\t\t\ticon: 'none'\r\n\t\t\t});\r\n\t\t}\r\n\t};\r\n\r\n\t// 删除分类\r\n\tconst deleteType = async (id) => {\r\n\t\tuni.showModal({\r\n\t\t\ttitle: '确认删除',\r\n\t\t\t// content: '如果该分类下存在物品，则不可以直接删除分类',\r\n\t\t\tsuccess: async (res) => {\r\n\t\t\t\tif (res.confirm) {\r\n\t\t\t\t\tconst token = uni.getStorageSync('token');\r\n\t\t\t\t\ttry {\r\n\t\t\t\t\t\tconst response = await uni.request({\r\n\t\t\t\t\t\t\turl: websiteUrl + '/with-state/delete-account-type',\r\n\t\t\t\t\t\t\tmethod: 'POST',\r\n\t\t\t\t\t\t\theader: {\r\n\t\t\t\t\t\t\t\t'Authorization': token,\r\n\t\t\t\t\t\t\t\t'Content-Type': 'application/json' // 添加Content-Type\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\tdata: {\r\n\t\t\t\t\t\t\t\tid\r\n\t\t\t\t\t\t\t}, // 使用JSON格式传参\r\n\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\tconst resData = response.data;\r\n\r\n\t\t\t\t\t\tif (resData.status === \"success\") { // 严格判断状态\r\n\t\t\t\t\t\t\tawait getAccountTypes();\r\n\t\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\t\ttitle: '删除成功'\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\t\ttitle: resData.msg || '删除失败',\r\n\t\t\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} catch (err) {\r\n\t\t\t\t\t\tconsole.error('删除失败:', err);\r\n\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\ttitle: err.errMsg || '请求失败',\r\n\t\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t};\r\n\r\n\t// 切换补款提醒\r\n\tconst toggleRemind = () => {\r\n\r\n\t\tform.value.isRemind = !form.value.isRemind\r\n\t\tif (!form.value.isRemind) {\r\n\t\t\tform.value.finalPrice = 0;\r\n\t\t\tform.value.finalTime = '';\r\n\t\t}\r\n\t};\r\n\t// 账本下选择的下拉菜单按钮\r\n\tconst selectedType = ref(0);\r\n\r\n\t// 账本下选择的下拉菜单按钮\r\n\tconst accountBookTypeList = ref(['请选择', '娃衣', '娃头', '眼珠', '假发', '娃鞋', '其它', ]);\r\n\r\n\t// 账本数据\r\n\tconst accountBookData = ref({});\r\n\r\n\t// 上传的图片数据\r\n\tconst accountImage = ref(\"\");\r\n\r\n\r\n\r\n\t// 切换账本选择类型\r\n\tfunction updateSelectedType(e) {\r\n\t\tselectedType.value = e.detail.value\r\n\t}\r\n\r\n\t//以id获取账本详情\r\n\tfunction getAccountBookById(id) {\r\n\t\tlet token = uni.getStorageSync('token')\r\n\t\t// /with-state/account-book-detail\r\n\t\tuni.request({\r\n\t\t\turl: websiteUrl + '/with-state/account-book-detail',\r\n\t\t\tmethod: 'GET',\r\n\t\t\theader: {\r\n\t\t\t\t'Authorization': token,\r\n\t\t\t},\r\n\t\t\tdata: {\r\n\t\t\t\tid: id\r\n\t\t\t},\r\n\t\t\tsuccess: (res) => {\r\n\t\t\t\tconsole.log(res.data.data);\r\n\t\t\t\tname.value = res.data.data.name;\r\n\t\t\t\tprice.value = parseInt(res.data.data.price);\r\n\t\t\t\tselectedType.value = typeOptions.value.indexOf(res.data.data.type);\r\n\t\t\t\taccountImage.value = res.data.data.image_url;\r\n\t\t\t\tform.value = {\r\n\t\t\t\t\tisRemind: res.data.data.is_remind,\r\n\t\t\t\t\tfinalPrice: res.data.data.final_price,\r\n\t\t\t\t\tfinalTime: res.data.data.final_time\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// 设置更多信息字段\r\n\t\t\t\tmoreInfo.value = {\r\n\t\t\t\t\tsizeDetail: res.data.data.size_detail || '',\r\n\t\t\t\t\tcolor: res.data.data.color || '',\r\n\t\t\t\t\tremark: res.data.data.remark || '',\r\n\t\t\t\t\tbuyDate: res.data.data.buy_date ? new Date(res.data.data.buy_date).toISOString().split(\r\n\t\t\t\t\t\t'T')[0] : '',\r\n\t\t\t\t\tposition: res.data.data.position || ''\r\n\t\t\t\t};\r\n\r\n\t\t\t\t// 设置尺寸选择器\r\n\t\t\t\t  if (res.data.data.size) {\n\t\t\t\t\t// 正确设置尺寸路径 [大分类, 小分类]\n\t\t\t\t\tselectedSizePath.value = [\n\t\t\t\t\t  res.data.data.size, \n\t\t\t\t\t  res.data.data.size_detail || ''\n\t\t\t\t\t];\n\t\t\t\t  }\r\n\t\t\t\tconsole.log(\"f:\", form)\r\n\t\t\t},\r\n\t\t\tfail: (err) => {\r\n\t\t\t\tconsole.log(err);\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\t// 在script中添加商品选择处理\r\n\tconst handleGoodsSelect = async (goods) => {\r\n\t\ttry {\r\n\t\t\tconst res = await uni.request({\r\n\t\t\t\turl: websiteUrl + `/goods?id=${goods.id}`,\r\n\t\t\t\tmethod: 'GET'\r\n\t\t\t});\r\n\r\n\t\t\tif (res.data.status === \"success\") {\r\n\t\t\t\tconst detail = res.data.data;\r\n\t\t\t\t// 自动填充信息\r\n\t\t\t\tname.value = detail.name;\r\n\t\t\t\tprice.value = detail.fin_amount + detail.sub_amount;\r\n\t\t\t\tif (detail.goods_images?.[0]) {\r\n\t\t\t\t\taccountImage.value = detail.goods_images[0];\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error('获取商品详情失败:', error);\r\n\t\t\tuni.showToast({\r\n\t\t\t\ttitle: '获取商品信息失败',\r\n\t\t\t\ticon: 'none'\r\n\t\t\t});\r\n\t\t}\r\n\t};\r\n\r\n\r\n\t// 删除账本 /delete-account-book\r\n\tfunction handleDelete() {\r\n\t\tuni.showModal({\r\n\t\t\ttitle: '提示',\r\n\t\t\tcontent: '确定删除该账本吗？',\r\n\t\t\tsuccess: (res) => {\r\n\t\t\t\tif (res.confirm) {\r\n\t\t\t\t\t// 参数校验\r\n\t\t\t\t\tconst id = Number(props.account_book_id);\r\n\t\t\t\t\tif (isNaN(id) || id <= 0) {\r\n\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\ttitle: '参数错误',\r\n\t\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tuni.request({\r\n\t\t\t\t\t\turl: websiteUrl + '/with-state/delete-account-book',\r\n\t\t\t\t\t\tmethod: 'POST',\r\n\t\t\t\t\t\theader: {\r\n\t\t\t\t\t\t\t'Authorization': uni.getStorageSync('token'),\r\n\t\t\t\t\t\t\t'Content-Type': 'application/json' // 添加Content-Type\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tdata: {\r\n\t\t\t\t\t\t\tid\r\n\t\t\t\t\t\t}, // 改为JSON格式传参\r\n\t\t\t\t\t\tsuccess: (res) => {\r\n\t\t\t\t\t\t\t// 严格判断响应状态\r\n\t\t\t\t\t\t\tconsole.log(res.data.status)\r\n\t\t\t\t\t\t\tif (res.data.status === \"success\") {\r\n\t\t\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\t\t\ttitle: '删除成功',\r\n\t\t\t\t\t\t\t\t\ticon: 'success'\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\tsetTimeout(() => uni.navigateBack(), 500);\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\t\t\ttitle: res.data.msg || '删除失败',\r\n\t\t\t\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tfail: (err) => {\r\n\t\t\t\t\t\t\tconsole.error('请求失败:', err);\r\n\t\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\t\ttitle: '网络错误',\r\n\t\t\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\t//选择图片\r\n\tfunction selectImage() {\r\n\t\tchooseImage().then((res) => {\r\n\t\t\tgetQiniuToken().then((tokenData) => {\r\n\t\t\t\tconsole.log(tokenData)\r\n\r\n\t\t\t\tuploadImageToQiniu(res, tokenData.token, tokenData.path).then((uploadRes) => {\r\n\t\t\t\t\tif (uploadRes.statusCode != 200) {\r\n\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\ttitle: '上传失败',\r\n\t\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t}\r\n\t\t\t\t\tconsole.log(image1Url + tokenData.path)\r\n\t\t\t\t\taccountImage.value = image1Url + tokenData.path;\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: '上传成功',\r\n\t\t\t\t\t\ticon: 'success'\r\n\t\t\t\t\t})\r\n\t\t\t\t}) //uploadImageToQiniu\r\n\t\t\t}) //getQiniuToken\r\n\t\t}) //chooseImage\r\n\t}\r\n\r\n\t// 加载用户信息\r\n\tasyncGetUserInfo().then((userInfo) => {\r\n\t\tif (isEdit) {\r\n\t\t\t//编辑\r\n\t\t\tgetAccountBookById(props.account_book_id)\r\n\t\t\tuni.setNavigationBarTitle({\r\n\t\t\t\ttitle: '编辑账本'\r\n\t\t\t})\r\n\t\t} else {\r\n\t\t\tuni.setNavigationBarTitle({\r\n\t\t\t\ttitle: '新增账本'\r\n\t\t\t})\r\n\t\t}\r\n\r\n\t})\r\n\r\n\t//提交表单\r\n\tfunction postSubmit() {\r\n\t\tif (!validateForm()) return;\r\n\r\n\t\t// 区分是新增还是提交，新增 post /with-state/account-book  提交 post /with-state/update-account-book\r\n\t\tif (isEdit) {\r\n\t\t\t//编辑\r\n\t\t\tupdateAccountBook()\r\n\t\t} else {\r\n\t\t\t//新增\r\n\t\t\taddAccountBook()\r\n\t\t}\r\n\r\n\r\n\t}\r\n\r\n\t// 修改提交逻辑\r\n\tconst validateForm = () => {\r\n\t\tif (form.value.isRemind) {\r\n\t\t\tif (!form.value.finalPrice || form.value.finalPrice <= 0) {\r\n\t\t\t\tuni.showToast({\r\n\t\t\t\t\ttitle: '请输入正确的尾款金额',\r\n\t\t\t\t\ticon: 'none'\r\n\t\t\t\t});\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\t// if (!form.value.finalTime || new Date(form.value.finalTime) < new Date()) {\r\n\t\t\t// \tuni.showToast({\r\n\t\t\t// \t\ttitle: '请选择未来的日期',\r\n\t\t\t// \t\ticon: 'none'\r\n\t\t\t// \t});\r\n\t\t\t// \treturn false;\r\n\t\t\t// }\r\n\t\t}\r\n\t\treturn true;\r\n\t};\r\n\r\n\t//新增\r\n\tfunction addAccountBook() {\r\n\t\tlet postData = {\r\n\t\t\tname: name.value,\r\n\t\t\tprice: parseInt(price.value, 10),\r\n\t\t\ttype: typeOptions.value[selectedType.value], // 使用合并后的分类列表\r\n\t\t\timage_url: accountImage.value,\r\n\t\t\tis_remind: form.value.isRemind,\r\n\t\t\tfinal_price: parseInt(form.value.finalPrice, 10),\r\n\t\t\tfinal_time: form.value.finalTime,\r\n\t\t\t// 新增更多信息字段\r\n\t\t\tsize: selectedSizePath.value[0] || '', // 大分类\n\t\t\tsize_detail: moreInfo.value.sizeDetail || '', // 小分类/尺寸详情\r\n\t\t\tcolor: moreInfo.value.color,\r\n\t\t\tremark: moreInfo.value.remark,\r\n\t\t\tbuy_date: moreInfo.value.buyDate,\r\n\t\t\tposition: moreInfo.value.position\r\n\t\t}\r\n\r\n\t\tconsole.log('提交数据:', postData)\r\n\r\n\t\tuni.request({\r\n\t\t\turl: websiteUrl + '/with-state/add-account-book',\r\n\t\t\tmethod: \"POST\",\r\n\t\t\theader: {\r\n\t\t\t\t'Authorization': uni.getStorageSync('token'),\r\n\t\t\t},\r\n\t\t\tdata: postData,\r\n\t\t\tsuccess: (res) => {\r\n\t\t\t\tconsole.log(res.data)\r\n\t\t\t\tif (res.data.status == \"success\") {\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: '提交成功',\r\n\t\t\t\t\t\ticon: 'success'\r\n\t\t\t\t\t})\r\n\t\t\t\t\t//一秒后返回上级页面\r\n\t\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\t\tuni.navigateBack()\r\n\t\t\t\t\t}, 500)\r\n\t\t\t\t} else {\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: res.data.msg,\r\n\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t})\r\n\t}\r\n\t//修改\r\n\tfunction updateAccountBook() {\r\n\r\n\t\tlet postData = {\r\n\t\t\tname: name.value,\r\n\t\t\tprice: parseInt(price.value, 10),\r\n\t\t\ttype: typeOptions.value[selectedType.value], // 使用合并后的分类列表\r\n\t\t\timage_url: accountImage.value,\r\n\t\t\tid: parseInt(props.account_book_id, 10),\r\n\t\t\tis_remind: form.value.isRemind, // 转换为数据库需要的格式\r\n\t\t\tfinal_price: parseInt(form.value.finalPrice, 10),\r\n\t\t\tfinal_time: form.value.finalTime,\r\n\t\t\t// 新增更多信息字段\r\n\t\t\tsize: selectedSizePath.value[0] || '', // 大分类\n\t\t\tsize_detail: moreInfo.value.sizeDetail || '', // 小分类/尺寸详情\r\n\t\t\tcolor: moreInfo.value.color,\r\n\t\t\tremark: moreInfo.value.remark,\r\n\t\t\tbuy_date: moreInfo.value.buyDate,\r\n\t\t\tposition: moreInfo.value.position\r\n\t\t}\r\n\r\n\t\tuni.request({\r\n\t\t\turl: websiteUrl + '/with-state/update-account-book',\r\n\t\t\tmethod: \"POST\",\r\n\t\t\theader: {\r\n\t\t\t\t'Authorization': uni.getStorageSync('token'),\r\n\t\t\t},\r\n\t\t\tdata: postData,\r\n\t\t\tsuccess: (res) => {\r\n\t\t\t\tconsole.log(res.data)\r\n\t\t\t\tif (res.data.status == \"success\") {\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: '提交成功',\r\n\t\t\t\t\t\ticon: 'success'\r\n\t\t\t\t\t})\r\n\t\t\t\t\t//一秒后返回上级页面\r\n\t\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\t\tuni.navigateBack()\r\n\t\t\t\t\t}, 500)\r\n\t\t\t\t} else {\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: res.data.msg,\r\n\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t})\r\n\t}\r\n\r\n\r\n\t// 在原有onShow中添加\r\n\tonShow(() => {\r\n\t\tasyncGetUserInfo().then(() => {\r\n\t\t\tgetAccountTypes();\r\n\t\t\t// 获取尺寸数据\r\n\t\t\tfetchSizes();\r\n\t\t});\r\n\t});\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n\t$primary-color: #a6e9f7;\r\n\t$hover-color: #94a5f3;\r\n\t$border-color: #e6e6e6;\r\n\t$radius: 8px;\r\n\r\n\t.container {\r\n\t\tpadding: 20rpx;\r\n\t\tbackground-color: #f5f5f5;\r\n\t\tmin-height: 100vh;\r\n\t}\r\n\r\n\t.form-card {\r\n\t\tbackground: white;\r\n\t\tborder-radius: $radius;\r\n\t\tpadding: 30rpx;\r\n\t\tbox-shadow: 0 4rpx 12rpx rgba(0, 0, 0, 0.05);\r\n\t}\r\n\r\n\t.form-item {\r\n\t\tmargin-bottom: 40rpx;\r\n\t}\r\n\r\n\t.form-label {\r\n\t\tdisplay: block;\r\n\t\tfont-size: 28rpx;\r\n\t\tcolor: #666;\r\n\t\tmargin-bottom: 16rpx;\r\n\t\tfont-weight: 500;\r\n\t}\r\n\r\n\t.form-input {\r\n\t\theight: 80rpx;\r\n\t\tpadding: 0 20rpx;\r\n\t\tborder: 2rpx solid $border-color;\r\n\t\tborder-radius: $radius;\r\n\t\tfont-size: 28rpx;\r\n\t\ttransition: all 0.3s;\r\n\t\tline-height: 80rpx;\n\t\toverflow: hidden;\r\n\r\n\t\t&:focus {\r\n\t\t\tborder-color: $primary-color;\r\n\t\t\tbox-shadow: 0 0 8rpx rgba($primary-color, 0.2);\r\n\t\t}\r\n\t}\r\n\r\n\t.picker-content {\r\n\t\theight: 80rpx;\r\n\t\tline-height: 80rpx;\r\n\t\tcolor: #333;\r\n\t}\r\n\r\n\t.upload-wrapper {\r\n\t\tborder: 2rpx dashed $border-color;\r\n\t\tborder-radius: $radius;\r\n\t\tpadding: 30rpx;\r\n\t\ttext-align: center;\r\n\t}\r\n\r\n\t.preview-image {\r\n\t\tposition: relative;\r\n\t\tmargin: 0 auto;\r\n\t\tmax-width: 400rpx;\r\n\r\n\t\t.image-preview {\r\n\t\t\twidth: 100%;\r\n\t\t\theight: 300rpx;\r\n\t\t\tborder-radius: $radius;\r\n\t\t}\r\n\r\n\t\t.image-tip {\r\n\t\t\tposition: absolute;\r\n\t\t\tbottom: 20rpx;\r\n\t\t\tleft: 50%;\r\n\t\t\ttransform: translateX(-50%);\r\n\t\t\tcolor: white;\r\n\t\t\tfont-size: 24rpx;\r\n\t\t\tbackground: rgba(0, 0, 0, 0.5);\r\n\t\t\tpadding: 8rpx 20rpx;\r\n\t\t\tborder-radius: 20rpx;\r\n\t\t}\r\n\t}\r\n\r\n\t.upload-button {\r\n\t\tbackground: rgba($primary-color, 0.1);\r\n\t\tcolor: $primary-color;\r\n\t\tborder: none;\r\n\t\tfont-size: 28rpx;\r\n\t\theight: auto;\r\n\t\tline-height: 1.5;\r\n\t\tpadding: 20rpx;\r\n\t\tborder-radius: $radius;\r\n\t\ttransition: all 0.3s;\r\n\r\n\t\t.iconfont {\r\n\t\t\tmargin-right: 12rpx;\r\n\t\t}\r\n\r\n\t\t&:active {\r\n\t\t\tbackground: rgba($primary-color, 0.2);\r\n\t\t}\r\n\t}\r\n\r\n\t.submit-button {\r\n\t\tmargin-top: 60rpx;\r\n\t\tbackground: linear-gradient(135deg, $primary-color, $hover-color);\r\n\t\tcolor: white;\r\n\t\tborder: none;\r\n\t\tborder-radius: 50rpx;\r\n\t\tfont-size: 32rpx;\r\n\t\theight: 90rpx;\r\n\t\tline-height: 90rpx;\r\n\t\tbox-shadow: 0 6rpx 20rpx rgba($primary-color, 0.3);\r\n\t\ttransition: all 0.3s;\r\n\t\twidth: 100%;\r\n\r\n\t\t&:active {\r\n\t\t\ttransform: translateY(2rpx);\r\n\t\t\tbox-shadow: 0 4rpx 12rpx rgba($primary-color, 0.3);\r\n\t\t}\r\n\t}\r\n\r\n\t.placeholder-style {\r\n\t\tcolor: #ccc;\r\n\t\tfont-size: 28rpx;\r\n\t}\r\n\r\n\t.button-group {\r\n\t\tmargin-top: 60rpx;\r\n\t}\r\n\r\n\t.delete-button {\r\n\t\tbackground: linear-gradient(135deg, #adadad, #ffbdbb);\r\n\t\tcolor: white;\r\n\t\tborder: none;\r\n\t\tborder-radius: 50rpx;\r\n\t\tfont-size: 32rpx;\r\n\t\theight: 90rpx;\r\n\t\tline-height: 90rpx;\r\n\t\tbox-shadow: 0 6rpx 20rpx rgba(255, 77, 79, 0.3);\r\n\t\ttransition: all 0.3s;\r\n\t\tmargin-top: 30rpx;\r\n\r\n\t\t&:active {\r\n\t\t\ttransform: translateY(2rpx);\r\n\t\t\tbox-shadow: 0 4rpx 12rpx rgba(255, 77, 79, 0.3);\r\n\t\t}\r\n\t}\r\n\r\n\t.form-input {\r\n\t\t// 原有样式保持不变\r\n\t\t// padding: 0 !important;  // 移除内边距让搜索组件填满\r\n\r\n\t\t.custom-search {\r\n\t\t\tborder: none !important; // 移除组件自身边框\r\n\t\t\theight: 80rpx;\r\n\r\n\t\t\t.search_tab {\r\n\t\t\t\tborder: 2rpx solid $border-color;\r\n\t\t\t\tborder-radius: $radius;\r\n\t\t\t\theight: 100%;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t.type-selector {\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tgap: 20rpx;\r\n\t}\r\n\r\n\t.manage-type {\r\n\t\tfont-size: 24rpx;\r\n\t\tcolor: #74c9e5;\r\n\t\tpadding: 8rpx 20rpx;\r\n\t\tborder: 1rpx solid #74c9e5;\r\n\t\tborder-radius: 40rpx;\r\n\t\tflex-shrink: 0;\r\n\t}\r\n\r\n\t.type-modal {\r\n\t\tpadding: 30rpx;\n\t\tbox-sizing: border-box;\n\t\twidth: 80vw;\n\t\t// height: 50vh;\r\n\r\n\t\t.type-list {\r\n\t\t\tmax-height: 500rpx;\r\n\t\t\toverflow-y: auto;\r\n\t\t\tmargin-bottom: 40rpx;\r\n\t\t}\r\n\r\n\t\t.type-item {\r\n\t\t\tdisplay: flex;\r\n\t\t\tjustify-content: space-between;\r\n\t\t\talign-items: center;\r\n\t\t\tpadding: 25rpx;\r\n\t\t\tborder-bottom: 1rpx solid #eee;\r\n\r\n\t\t\ttext {\r\n\t\t\t\tfont-size: 26rpx;\r\n\t\t\t\tcolor: #333;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t.add-type-form {\r\n\t\t\tdisplay: flex;\r\n\t\t\tgap: 20rpx;\r\n\t\t\tmargin-bottom: 10rpx;\r\n\r\n\t\t\t.type-input {\r\n\t\t\t\tflex: 1;\r\n\t\t\t\tborder: 1rpx solid #ddd;\r\n\t\t\t\tborder-radius: 8rpx;\r\n\t\t\t\tpadding: 15rpx;\r\n\t\t\t\tfont-size: 26rpx;\r\n\t\t\t}\r\n\r\n\t\t\t.add-btn {\r\n\t\t\t\tbackground: #74c9e5;\r\n\t\t\t\tcolor: white;\r\n\t\t\t\tfont-size: 26rpx;\r\n\t\t\t\tpadding: 0 30rpx;\r\n\t\t\t\tborder-radius: 8rpx;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t.remind-label {\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tgap: 15rpx;\r\n\t\tfont-size: 28rpx;\r\n\t\tcolor: #666;\r\n\t}\r\n\r\n\t.remind-form {\r\n\t\tbackground: #f8f8f8;\r\n\t\tborder-radius: 16rpx;\r\n\t\tpadding: 20rpx;\r\n\t\tmargin-top: 20rpx;\r\n\t}\r\n\r\n\t.more-info-form {\r\n\t\tbackground: #f8f8f8;\r\n\t\tborder-radius: 16rpx;\r\n\t\tpadding: 20rpx;\r\n\t\tmargin-top: 20rpx;\r\n\t\tmargin-bottom: 20rpx;\r\n\t}\r\n\r\n\t.remind-label {\r\n\t\tposition: relative; // 添加相对定位\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tgap: 15rpx;\r\n\t\tfont-size: 28rpx;\r\n\t\tcolor: #666;\r\n\t\tpadding-right: 40rpx; // 为小红点留出空间\r\n\r\n\t\t.remind-dot {\r\n\t\t\tposition: relative;\r\n\t\t\tright: 0;\r\n\t\t\ttop: 7rpx;\r\n\t\t\ttransform: translateY(-50%);\r\n\t\t\twidth: 16rpx;\r\n\t\t\theight: 16rpx;\r\n\t\t\tbackground: #ff4444;\r\n\t\t\tborder-radius: 50%;\r\n\t\t\tbox-shadow: 0 2rpx 8rpx rgba(255, 68, 68, 0.2);\r\n\t\t}\r\n\t}\r\n\r\n\t.size-picker {\r\n\t\tpadding: 20rpx 0;\r\n\t}\n\t.size_detail {\n\t\tdisplay: none;\n\t}\n\tuni-button:after {\n\t\tborder: none;\n\t}\r\n</style>","import MiniProgramPage from '/Users/sapphirell/Documents/git/dogdogdoll-uniapp/pages/stock/account_book_form/account_book_form.vue'\nwx.createPage(MiniProgramPage)"],"names":["uni","ref","computed","websiteUrl","res","chooseImage","getQiniuToken","uploadImageToQiniu","image1Url","asyncGetUserInfo","onShow"],"mappings":"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"}