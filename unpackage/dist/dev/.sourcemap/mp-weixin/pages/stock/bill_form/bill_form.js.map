{"version":3,"file":"bill_form.js","sources":["pages/stock/bill_form/bill_form.vue","pages/stock/bill_form/bill_form.vue?type=page"],"sourcesContent":["<template>\n\t<view class=\"container\">\n\t\t<meta name=\"theme-color\" content=\"#F8F8F8\"></meta>\n\t\t<!-- 表单卡片容器 -->\n\t\t<view class=\"form-card\">\n\t\t\t<!-- 账单名称 -->\n\t\t\t<view class=\"form-item\">\n\t\t\t\t<text class=\"form-label\">账单名称</text>\n\t\t\t\t<input \n\t\t\t\t\tclass=\"form-input\" \n\t\t\t\t\ttype=\"text\" \n\t\t\t\t\tplaceholder=\"请输入名称\"\n\t\t\t\t\tplaceholder-class=\"placeholder-style\"\n\t\t\t\t\tv-model=\"name\" />\n\t\t\t</view>\n\n\t\t\t<!-- 账单金额 -->\n\t\t\t<view class=\"form-item\">\n\t\t\t\t<text class=\"form-label\">账单金额</text>\n\t\t\t\t<input \n\t\t\t\t\tclass=\"form-input\" \n\t\t\t\t\ttype=\"digit\" \n\t\t\t\t\tplaceholder=\"请输入金额\"\n\t\t\t\t\tplaceholder-class=\"placeholder-style\"\n\t\t\t\t\tv-model=\"price\" />\n\t\t\t</view>\n\n\t\t\t<!-- 账单日期 -->\n\t\t\t<view class=\"form-item\">\n\t\t\t\t<text class=\"form-label\">账单日期</text>\n\t\t\t\t<view style=\"padding: 0px 10px;border: 1px solid #e6e6e6; border-radius: 10px;\">\n\t\t\t\t\t<picker\n\t\t\t\t\t\tmode=\"date\" \n\t\t\t\t\t\t:value=\"formattedDate\" \n\t\t\t\t\t\t@change=\"updateDate\">\n\t\t\t\t\t\t<view class=\"picker-content\" style=\"color: #2c2c2c;font-size: 26rpx;\">\n\t\t\t\t\t\t\t{{ formattedDate || '请选择日期' }}\n\t\t\t\t\t\t</view>\n\t\t\t\t\t</picker>\n\t\t\t\t</view>\n\t\t\t\t\n\t\t\t</view>\n\t\t\t\n\t\t\t<!-- 账单状态 -->\n\t\t\t<view class=\"form-item\">\n\t\t\t\t<text class=\"form-label\">账单状态</text>\n\t\t\t\t<view style=\"padding: 0px 10px;border: 1px solid #e6e6e6; border-radius: 10px;\">\n\t\t\t\t\t<picker \n\t\t\t\t\t\tmode=\"selector\" \n\t\t\t\t\t\t:value=\"status\" \n\t\t\t\t\t\t:range=\"statusList\"\n\t\t\t\t\t\t@change=\"updateStatus\">\n\t\t\t\t\t\t<view class=\"picker-content\">\n\t\t\t\t\t\t\t{{ statusList[status] || '请选择状态' }}\n\t\t\t\t\t\t</view>\n\t\t\t\t\t</picker>\n\t\t\t\t</view>\n\t\t\t</view>\n\t\t\t\n\t\t\t\n\t\t\t\n\t\t\t<view style=\"overflow: hidden;\">\n\t\t\t\t<image src=\"/static/info-circle.png\" mode=\"aspectFill\" style=\"width: 28rpx;height: 28rpx;margin-right: 10rpx; position: relative;top: 3rpx;\"></image>\n\t\t\t\t<text style=\"color: #888;\">仅用于您的记账，其他人不会看到</text>\n\t\t\t</view>\n\t\t</view>\n\n\t\t<!-- 操作按钮 -->\n\t\t<view class=\"button-group\">\n\t\t\t<button \n\t\t\t\tclass=\"submit-button\" \n\t\t\t\t@click=\"postSubmit\">\n\t\t\t\t记录{{ isEdit ? '修改' : '新增' }}\n\t\t\t</button>\n\t\t\t<button \n\t\t\t\tclass=\"delete-button\" \n\t\t\t\tv-if=\"isEdit\"\n\t\t\t\t@click=\"handleDelete\">\n\t\t\t\t删除账单\n\t\t\t</button>\n\t\t</view>\n\t</view>\n</template>\n\n\n<script setup>\n\timport { ref, onMounted } from 'vue';\n\timport { websiteUrl } from \"../../../common/config.js\";\n\n\tconst props = defineProps([\"bill_id\"]);\n\n\t// 判断页面是否有参数，如果有代表编辑，如果没有代表新增\n\tconst isEdit = props.bill_id ? true : false;\n\n\t// 数据字段\n\tconst name = ref(\"\");\n\tconst price = ref(\"\");\n\tconst date = ref(\"\");  // 用于存储日期原始数据\n\tconst status = ref(0); // 默认未补款\n\tconst statusList = ['未补款', '已补款'];\n\n\t// 获取账单详情\n\tfunction getBillById(id) {\n\t\tlet token = uni.getStorageSync('token');\n\t\tuni.request({\n\t\t\turl: websiteUrl + '/with-state/tail-bill-detail',\n\t\t\tmethod: 'GET',\n\t\t\theader: { 'Authorization': token },\n\t\t\tdata: { id: id },\n\t\t\tsuccess: (res) => {\n\t\t\t\tname.value = res.data.data.name;\n\t\t\t\tprice.value = res.data.data.price;\n\t\t\t\tdate.value = res.data.data.ymd; // 获取日期并格式化\n\t\t\t\tstatus.value = res.data.data.status;\n\t\t\t\tformattedDate.value = formatDate(res.data.data.ymd);\n\t\t\t},\n\t\t\tfail: (err) => {\n\t\t\t\tconsole.log(err);\n\t\t\t}\n\t\t});\n\t}\n\n\t// 日期格式化为y-m-d\n\tconst formattedDate = ref(\"\");\n\tfunction updateDate(e) {\n\t\tconst selectedDate = e.detail.value;\n\t\tdate.value = selectedDate;  // 存储原始日期\n\t\tformattedDate.value = formatDate(selectedDate);\n\t}\n\t//handleDelete POST /delete-tail-bill\n\tfunction handleDelete() {\n\t\tuni.showModal({\n\t\t\ttitle: '提示',\n\t\t\tcontent: '确定删除该账单吗？',\n\t\t\tsuccess: (res) => {\n\t\t\t\tif (res.confirm) {\n\t\t\t\t\tuni.request({\n\t\t\t\t\t\turl: websiteUrl + '/with-state/delete-tail-bill?id=' + parseInt(props.bill_id, 10),\n\t\t\t\t\t\tmethod: 'POST',\n\t\t\t\t\t\theader: { 'Authorization': uni.getStorageSync('token') },\n\t\t\t\t\t\tsuccess: (res) => {\n\t\t\t\t\t\t\tif (res.data.status == \"success\") {\n\t\t\t\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\t\t\t\ttitle: '删除成功',\n\t\t\t\t\t\t\t\t\ticon: 'success'\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\t\t\t\tuni.navigateBack();\n\t\t\t\t\t\t\t\t}, 500);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\t\t\t\ttitle: res.data.msg,\n\t\t\t\t\t\t\t\t\ticon: 'none'\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\t\n\t\n\n\tfunction formatDate(dateStr) {\n\t\tlet date = new Date(dateStr);\n\t\tconst year = date.getFullYear();\n\t\tconst month = (date.getMonth() + 1).toString().padStart(2, '0');\n\t\tconst day = date.getDate().toString().padStart(2, '0');\n\t\treturn `${year}-${month}-${day}`;\n\t}\n\n\t// 更新账单状态\n\tfunction updateStatus(e) {\n\t\tstatus.value = e.detail.value;\n\t}\n\n\t// 页面加载时，判断是编辑还是新增\n\tonMounted(() => {\n\t\tif (isEdit) {\n\t\t\tgetBillById(props.bill_id);\n\t\t\tuni.setNavigationBarTitle({\n\t\t\t\ttitle: '编辑账单'\n\t\t\t});\n\t\t} else {\n\t\t\tuni.setNavigationBarTitle({\n\t\t\t\ttitle: '新增账单'\n\t\t\t});\n\t\t}\n\t});\n\n\t// 提交表单\n\tfunction postSubmit() {\n\t\tif (isEdit) {\n\t\t\tupdateBill();\n\t\t} else {\n\t\t\taddBill();\n\t\t}\n\t}\n\n\t// 新增账单\n\tfunction addBill() {\n\t\tlet postData = {\n\t\t\tname: name.value,\n\t\t\tprice: parseFloat(price.value),\n\t\t\tymd: date.value, // 原始日期\n\t\t\tstatus: status.value\n\t\t};\n\n\t\tuni.request({\n\t\t\turl: websiteUrl + '/with-state/add-tail-bill',\n\t\t\tmethod: \"POST\",\n\t\t\theader: {\n\t\t\t\t'Authorization': uni.getStorageSync('token')\n\t\t\t},\n\t\t\tdata: postData,\n\t\t\tsuccess: (res) => {\n\t\t\t\tif (res.data.status == \"success\") {\n\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\ttitle: '提交成功',\n\t\t\t\t\t\ticon: 'success'\n\t\t\t\t\t});\n\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\tuni.navigateBack();\n\t\t\t\t\t}, 500);\n\t\t\t\t} else {\n\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\ttitle: res.data.msg,\n\t\t\t\t\t\ticon: 'none'\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\t// 修改账单\n\tfunction updateBill() {\n\t\tlet postData = {\n\t\t\tid: parseInt(props.bill_id, 10),\n\t\t\tname: name.value,\n\t\t\tprice: parseFloat(price.value),\n\t\t\tymd: date.value, // 原始日期\n\t\t\tstatus: status.value\n\t\t};\n\n\t\tuni.request({\n\t\t\turl: websiteUrl + '/with-state/update-tail-bill',\n\t\t\tmethod: \"POST\",\n\t\t\theader: {\n\t\t\t\t'Authorization': uni.getStorageSync('token')\n\t\t\t},\n\t\t\tdata: postData,\n\t\t\tsuccess: (res) => {\n\t\t\t\tif (res.data.status == \"success\") {\n\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\ttitle: '提交成功',\n\t\t\t\t\t\ticon: 'success'\n\t\t\t\t\t});\n\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\tuni.navigateBack();\n\t\t\t\t\t}, 500);\n\t\t\t\t} else {\n\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\ttitle: res.data.msg,\n\t\t\t\t\t\ticon: 'none'\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n</script>\n\n<style lang=\"scss\" scoped>\n\t$primary-color: #a6e9f7;\n\t$hover-color: #94a5f3;\n\t$border-color: #e6e6e6;\n\t$radius: 8px;\n\n\t.container {\n\t\tpadding: 20rpx;\n\t\tbackground-color: #f5f5f5;\n\t\tmin-height: 100vh;\n\t}\n\n\t.form-card {\n\t\tbackground: white;\n\t\tborder-radius: $radius;\n\t\tpadding: 30rpx;\n\t\tbox-shadow: 0 4rpx 12rpx rgba(0,0,0,0.05);\n\t}\n\n\t.form-item {\n\t\tmargin-bottom: 40rpx;\n\t}\n\n\t.form-label {\n\t\tdisplay: block;\n\t\tfont-size: 28rpx;\n\t\tcolor: #666;\n\t\tmargin-bottom: 16rpx;\n\t\tfont-weight: 500;\n\t}\n\n\t.form-input {\n\t\theight: 80rpx;\n\t\tpadding: 0 20rpx;\n\t\tborder: 2rpx solid $border-color;\n\t\tborder-radius: $radius;\n\t\tfont-size: 28rpx;\n\t\ttransition: all 0.3s;\n\t\tline-height: 80rpx;\n\t\t\n\t\t&:focus {\n\t\t\tborder-color: $primary-color;\n\t\t\tbox-shadow: 0 0 8rpx rgba($primary-color, 0.2);\n\t\t}\n\t}\n\n\t.picker-content {\n\t\theight: 80rpx;\n\t\tline-height: 80rpx;\n\t\tcolor: #333;\n\t\tdisplay: inline-block;\n\t}\n\n\t.submit-button {\n\t\tmargin-top: 60rpx;\n\t\tbackground: linear-gradient(135deg, $primary-color, $hover-color);\n\t\tcolor: white;\n\t\tborder: none;\n\t\tborder-radius: 50rpx;\n\t\tfont-size: 32rpx;\n\t\theight: 90rpx;\n\t\tline-height: 90rpx;\n\t\tbox-shadow: 0 6rpx 20rpx rgba($primary-color, 0.3);\n\t\ttransition: all 0.3s;\n\t\twidth: 100%;\n\t\t\n\t\t&:active {\n\t\t\ttransform: translateY(2rpx);\n\t\t\tbox-shadow: 0 4rpx 12rpx rgba($primary-color, 0.3);\n\t\t}\n\t}\n\n\t.placeholder-style {\n\t\tcolor: #ccc;\n\t\tfont-size: 28rpx;\n\t}\n\n\t.button-group {\n\t\tmargin-top: 60rpx;\n\t}\n\n\t// 如果需要删除按钮\n\t.delete-button {\n\t\tbackground: linear-gradient(135deg, #adadad, #ffbdbb);\n\t\tcolor: white;\n\t\tborder: none;\n\t\tborder-radius: 50rpx;\n\t\tfont-size: 32rpx;\n\t\theight: 90rpx;\n\t\tline-height: 90rpx;\n\t\tbox-shadow: 0 6rpx 20rpx rgba(255,77,79,0.3);\n\t\ttransition: all 0.3s;\n\t\tmargin-top: 30rpx;\n\t\t\n\t\t&:active {\n\t\t\ttransform: translateY(2rpx);\n\t\t\tbox-shadow: 0 4rpx 12rpx rgba(255,77,79,0.3);\n\t\t}\n\t}\n\t.picker-content {\n\t\theight: 80rpx;\n\t\tline-height: 80rpx;\n\t\tcolor: #333;\n\t\t/* 添加以下关键属性 */\n\t\toverflow: hidden;\n\t\ttext-overflow: ellipsis;\n\t\twhite-space: nowrap;\n\t\tdisplay: block;\n\t\twidth: 100%;\n\t}\n\t\n\t/* 针对原生picker的特殊处理 */\n\t::v-deep uni-picker .picker-view {\n\t\theight: 80rpx !important;\n\t\tline-height: 80rpx !important;\n\t}\n\t\n\t::v-deep uni-picker .picker-view-column {\n\t\theight: 80rpx !important;\n\t\tline-height: 80rpx !important;\n\t}\n\t\n\t::v-deep .picker-item {\n\t\theight: 80rpx !important;\n\t\tline-height: 80rpx !important;\n\t\tfont-size: 28rpx !important;\n\t}\n</style>","import MiniProgramPage from '/Users/sapphirell/Documents/git/dogdogdoll-uniapp/pages/stock/bill_form/bill_form.vue'\nwx.createPage(MiniProgramPage)"],"names":["ref","uni","websiteUrl","res","date","onMounted"],"mappings":"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"}