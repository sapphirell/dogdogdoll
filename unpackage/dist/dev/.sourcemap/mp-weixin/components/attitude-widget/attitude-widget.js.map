{"version":3,"file":"attitude-widget.js","sources":["components/attitude-widget/attitude-widget.vue","/Users/sapphirell/Documents/git/dogdogdoll-uniapp/components/attitude-widget/attitude-widget.vue?type=component"],"sourcesContent":["<template>\r\n\t<view class=\"attitude-container\">\r\n\t\t<!-- Â∑≤ÈÄâÁä∂ÊÄÅÊòæÁ§∫ -->\r\n\t\t<view v-if=\"currentStatus > 0\" class=\"selected-attitude\">\r\n\t\t\t<view class=\"attitude-btn active\">\r\n\t\t\t\t<text class=\"emoji\">{{ getEmoji(currentStatus) }}</text>\r\n\t\t\t\t<text class=\"count\">{{ currentCounts[currentStatus] }}</text>\r\n\t\t\t\t<!-- Ê∑ªÂä†Â∑≤ÈÄâÁä∂ÊÄÅÊñáÂ≠ó -->\r\n\t\t\t\t<text class=\"label\">{{ (currentStatus) }}</text>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\r\n\t\t<!-- Â±ïÂºÄÊåâÈíÆ -->\r\n\t\t<view class=\"expand-btn\" @click.stop=\"togglePanel\">\r\n\t\t\t<uni-icons :type=\"showPanel ? 'arrowup' : 'plus'\" size=\"16\" color=\"#888\" />\r\n\t\t\t<!-- Ê∑ªÂä†ÊåâÈíÆÊñáÂ≠ó -->\r\n\t\t\t<text class=\"btn-text\">{{ showPanel ? 'Êî∂Ëµ∑' : 'Ë°®ÊÄÅ' }}</text>\r\n\t\t</view>\r\n\r\n\t\t<!-- Ë°®ÊÄÅÈù¢Êùø -->\r\n\t\t<view v-if=\"showPanel\" class=\"attitude-panel\">\r\n\t\t\t<view v-for=\"action in attitudeTypes\" :key=\"action.value\" class=\"attitude-btn\"\r\n\t\t\t\t:class=\"{ active: currentStatus === action.value }\" @click.stop=\"handleAction(action.value)\">\r\n\t\t\t\t<text class=\"emoji\">{{ action.emoji }}</text>\r\n\t\t\t\t<view class=\"text-container\">\r\n\t\t\t\t\t<text class=\"label\">{{ action.label }}</text>\r\n\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t</view>\r\n</template>\r\n\r\n<script setup>\r\n\timport {\r\n\t\tref,\r\n\t\tcomputed\r\n\t} from 'vue'\r\n\timport {\r\n\t\twebsiteUrl,\r\n\t\tasyncGetUserInfo,\r\n\t\twechatSignLogin,\r\n\t\tgetScene\r\n\t} from '../../common/config.js'\r\n\r\n\r\n\tconst props = defineProps({\r\n\t\ttargetId: {\r\n\t\t\ttype: Number,\r\n\t\t\trequired: true\r\n\t\t},\r\n\t\ttype: {\r\n\t\t\ttype: Number,\r\n\t\t\trequired: true\r\n\t\t},\r\n\t\tattitudeStatus: {\r\n\t\t\ttype: Number,\r\n\t\t\tdefault: 0\r\n\t\t},\r\n\t\tattitudeCounts: {\r\n\t\t\ttype: Object,\r\n\t\t\tdefault: () => ({})\r\n\t\t}\r\n\t})\r\n\r\n\tconst emit = defineEmits(['change'])\r\n\r\n\t// Êú¨Âú∞Áä∂ÊÄÅ\r\n\tconst showPanel = ref(false)\r\n\tconst currentStatus = ref(props.attitudeStatus)\r\n\tconst currentCounts = ref({\r\n\t\t...props.attitudeCounts\r\n\t})\r\n\r\n\t// ÈÖçÁΩÆÈ°π\r\n\tconst attitudeTypes = ref([{\r\n\t\t\temoji: 'üòù',\r\n\t\t\tvalue: 1,\r\n\t\t\tlabel: 'ÂæàÊúâË∂£'\r\n\t\t},\r\n\t\t{\r\n\t\t\temoji: 'üò®',\r\n\t\t\tvalue: 2,\r\n\t\t\tlabel: 'Ëøô‰∏™...'\r\n\t\t},\r\n\t\t{\r\n\t\t\temoji: 'ü§§',\r\n\t\t\tvalue: 3,\r\n\t\t\tlabel: 'Êàë‰πüÊÉ≥Ë¶Å'\r\n\t\t},\r\n\t\t{\r\n\t\t\temoji: 'ü§¶‚Äç‚ôÄÔ∏è',\r\n\t\t\tvalue: 4,\r\n\t\t\tlabel: 'Èöæ‰ª•Áõ¥ËßÜ'\r\n\t\t},\r\n\t\t{\r\n\t\t\temoji: 'ü§°',\r\n\t\t\tvalue: 5,\r\n\t\t\tlabel: 'Ë∞ÅÁöÑÈºªÂ≠êÊéâ‰∫Ü?'\r\n\t\t}\r\n\t])\r\n\tconst getLabel = (value) => {\r\n\t\treturn attitudeTypes.value.find(t => t.value === value)?.label || ''\r\n\t}\r\n\r\n\t// ÊñπÊ≥ï\r\n\tconst togglePanel = () => {\r\n\t\tshowPanel.value = !showPanel.value\r\n\t}\r\n\r\n\tconst getEmoji = (value) => {\r\n\t\treturn attitudeTypes.value.find(t => t.value === value)?.emoji || ''\r\n\t}\r\n\r\n\tconst handleAction = async (actionType) => {\r\n\t\ttry {\r\n\t\t\tconst token = uni.getStorageSync('token')\r\n\t\t\tif (!token) {\r\n\t\t\t\tuni.showToast({\r\n\t\t\t\t\ttitle: 'ËØ∑ÂÖàÁôªÂΩï',\r\n\t\t\t\t\ticon: 'none'\r\n\t\t\t\t})\r\n\t\t\t\treturn\r\n\t\t\t}\r\n\r\n\t\t\tconst isActive = currentStatus.value === actionType\r\n\t\t\tconst apiUrl = `${websiteUrl}/with-state/attitude/${isActive ? 'remove' : 'add'}`\r\n\r\n\t\t\tconst res = await uni.request({\r\n\t\t\t\turl: apiUrl,\r\n\t\t\t\tmethod: 'POST',\r\n\t\t\t\tdata: {\r\n\t\t\t\t\ttarget_id: props.targetId,\r\n\t\t\t\t\ttype: props.type,\r\n\t\t\t\t\taction_type: actionType // ËøôÊòØÂÖ≥ÈîÆ‰øÆÊîπ\r\n\t\t\t\t},\r\n\t\t\t\theader: {\r\n\t\t\t\t\tAuthorization: uni.getStorageSync('token')\r\n\t\t\t\t}\r\n\t\t\t})\r\n\r\n\t\t\tif (res.data.status === 'success') {\r\n\t\t\t\t// Êõ¥Êñ∞Êú¨Âú∞Áä∂ÊÄÅ\r\n\t\t\t\tif (isActive) {\r\n\t\t\t\t\tcurrentCounts.value[actionType]--\r\n\t\t\t\t\tcurrentStatus.value = 0\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif (currentStatus.value > 0) {\r\n\t\t\t\t\t\tcurrentCounts.value[currentStatus.value]--\r\n\t\t\t\t\t}\r\n\t\t\t\t\tcurrentStatus.value = actionType\r\n\t\t\t\t\tcurrentCounts.value[actionType] = (currentCounts.value[actionType] || 0) + 1\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Ëß¶Âèë‰∫ã‰ª∂\r\n\t\t\t\temit('change', {\r\n\t\t\t\t\tstatus: currentStatus.value,\r\n\t\t\t\t\tcounts: {\r\n\t\t\t\t\t\t...currentCounts.value\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\r\n\t\t\t\tshowPanel.value = false\r\n\t\t\t}\r\n\t\t} catch (err) {\r\n\t\t\tconsole.log(err)\r\n\t\t\tuni.showToast({\r\n\t\t\t\ttitle: 'Êìç‰ΩúÂ§±Ë¥•',\r\n\t\t\t\ticon: 'none'\r\n\t\t\t})\r\n\t\t}\r\n\t}\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n\t.attitude-container {\r\n\t\tposition: relative;\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tmargin-right: 20rpx;\r\n\r\n\t\t.selected-attitude {\r\n\t\t\tdisplay: flex;\r\n\t\t\tmargin-right: 10rpx;\r\n\t\t}\n\t\t\n\t\t\n\t\t .expand-btn {\n\t\t    display: flex;\n\t\t    align-items: center;\n\t\t    padding: 8rpx 16rpx;\n\t\t    border-radius: 0rpx;\n\t\t    width: auto;\n\t\t    height: auto;\n\t\t\n\t\t    .btn-text {\n\t\t      font-size: 22rpx;\n\t\t      color: #888;\n\t\t      margin-left: 8rpx;\n\t\t    }\n\t\t  }\n\t\t\n\t\t  .attitude-panel {\n\t\t    width: 300rpx;\n\t\t    gap: 12rpx;\n\t\t\tposition: absolute;\n\t\t\tbackground: #f5f5f5;\n\t\t\ttop: 50rpx;\n\t\t\tz-index: 10;\n\t\t\n\t\t    .attitude-btn {\n\t\t      flex: 0 0 100%;\n\t\t      justify-content: flex-start;\n\t\t      padding: 12rpx;\n\t\t      .text-container {\n\t\t        display: flex;\n\t\t        flex-direction: column;\n\t\t        margin-left: 12rpx;\n\t\t        \n\t\t        .label {\n\t\t          font-size: 22rpx;\n\t\t          color: #333;\n\t\t        }\n\t\t        \n\t\t        .count {\n\t\t          font-size: 20rpx;\n\t\t          color: #999;\n\t\t        }\n\t\t      }\n\t\t    }\n\t\t  }\r\n\r\n\t\t\r\n\t}\r\n\r\n\t.attitude-btn {\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tpadding: 6rpx 12rpx;\r\n\t\tborder-radius: 20rpx;\r\n\t\tbackground: #f5f5f5;\r\n\t\ttransition: all 0.3s;\r\n\r\n\t\t&.active {\r\n\t\t\tbackground: #e0f0ff;\r\n\r\n\t\t\t.emoji,\r\n\t\t\t.count {\r\n\t\t\t\tcolor: #007AFF;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t.emoji {\r\n\t\t\tfont-size: 28rpx;\r\n\t\t\tmargin-right: 4rpx;\r\n\t\t}\r\n\r\n\t\t.count {\r\n\t\t\tfont-size: 22rpx;\r\n\t\t\tcolor: #666;\r\n\t\t}\r\n\t}\r\n\r\n\t@media (max-width: 480px) {\r\n\t\t.attitude-panel {\r\n\t\t\twidth: 320rpx !important;\r\n\r\n\t\t\t.attitude-btn {\r\n\t\t\t\tflex: 0 0 calc(33.33% - 8rpx) !important;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\r\n\t.attitude-btn {\r\n\r\n\t\t// ‰øÆÊîπÂéüÊúâÊ†∑Âºè\r\n\t\t.label {\r\n\t\t\tfont-size: 24rpx;\r\n\t\t\tcolor: #333;\r\n\t\t\tmargin-left: 8rpx;\r\n\t\t}\r\n\r\n\t\t&.active {\r\n\t\t\t.label {\r\n\t\t\t\tcolor: #007AFF;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n</style>","import Component from '/Users/sapphirell/Documents/git/dogdogdoll-uniapp/components/attitude-widget/attitude-widget.vue'\nwx.createComponent(Component)"],"names":["ref","uni","websiteUrl"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8CC,UAAM,QAAQ;AAmBd,UAAM,OAAO;AAGb,UAAM,YAAYA,cAAG,IAAC,KAAK;AAC3B,UAAM,gBAAgBA,cAAAA,IAAI,MAAM,cAAc;AAC9C,UAAM,gBAAgBA,cAAAA,IAAI;AAAA,MACzB,GAAG,MAAM;AAAA,IACX,CAAE;AAGD,UAAM,gBAAgBA,cAAAA,IAAI;AAAA,MAAC;AAAA,QACzB,OAAO;AAAA,QACP,OAAO;AAAA,QACP,OAAO;AAAA,MACP;AAAA,MACD;AAAA,QACC,OAAO;AAAA,QACP,OAAO;AAAA,QACP,OAAO;AAAA,MACP;AAAA,MACD;AAAA,QACC,OAAO;AAAA,QACP,OAAO;AAAA,QACP,OAAO;AAAA,MACP;AAAA,MACD;AAAA,QACC,OAAO;AAAA,QACP,OAAO;AAAA,QACP,OAAO;AAAA,MACP;AAAA,MACD;AAAA,QACC,OAAO;AAAA,QACP,OAAO;AAAA,QACP,OAAO;AAAA,MACP;AAAA,IACH,CAAE;AAMD,UAAM,cAAc,MAAM;AACzB,gBAAU,QAAQ,CAAC,UAAU;AAAA,IAC7B;AAED,UAAM,WAAW,CAAC,UAAU;;AAC3B,eAAO,mBAAc,MAAM,KAAK,OAAK,EAAE,UAAU,KAAK,MAA/C,mBAAkD,UAAS;AAAA,IAClE;AAED,UAAM,eAAe,OAAO,eAAe;AAC1C,UAAI;AACH,cAAM,QAAQC,cAAAA,MAAI,eAAe,OAAO;AACxC,YAAI,CAAC,OAAO;AACXA,wBAAAA,MAAI,UAAU;AAAA,YACb,OAAO;AAAA,YACP,MAAM;AAAA,UACX,CAAK;AACD;AAAA,QACA;AAED,cAAM,WAAW,cAAc,UAAU;AACzC,cAAM,SAAS,GAAGC,cAAU,UAAA,wBAAwB,WAAW,WAAW,KAAK;AAE/E,cAAM,MAAM,MAAMD,cAAG,MAAC,QAAQ;AAAA,UAC7B,KAAK;AAAA,UACL,QAAQ;AAAA,UACR,MAAM;AAAA,YACL,WAAW,MAAM;AAAA,YACjB,MAAM,MAAM;AAAA,YACZ,aAAa;AAAA;AAAA,UACb;AAAA,UACD,QAAQ;AAAA,YACP,eAAeA,cAAAA,MAAI,eAAe,OAAO;AAAA,UACzC;AAAA,QACL,CAAI;AAED,YAAI,IAAI,KAAK,WAAW,WAAW;AAElC,cAAI,UAAU;AACb,0BAAc,MAAM,UAAU;AAC9B,0BAAc,QAAQ;AAAA,UAC3B,OAAW;AACN,gBAAI,cAAc,QAAQ,GAAG;AAC5B,4BAAc,MAAM,cAAc,KAAK;AAAA,YACvC;AACD,0BAAc,QAAQ;AACtB,0BAAc,MAAM,UAAU,KAAK,cAAc,MAAM,UAAU,KAAK,KAAK;AAAA,UAC3E;AAGD,eAAK,UAAU;AAAA,YACd,QAAQ,cAAc;AAAA,YACtB,QAAQ;AAAA,cACP,GAAG,cAAc;AAAA,YACjB;AAAA,UACN,CAAK;AAED,oBAAU,QAAQ;AAAA,QAClB;AAAA,MACD,SAAQ,KAAK;AACbA,sBAAAA,MAAA,MAAA,OAAA,yDAAY,GAAG;AACfA,sBAAAA,MAAI,UAAU;AAAA,UACb,OAAO;AAAA,UACP,MAAM;AAAA,QACV,CAAI;AAAA,MACD;AAAA,IACD;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC1KF,GAAG,gBAAgB,SAAS;"}