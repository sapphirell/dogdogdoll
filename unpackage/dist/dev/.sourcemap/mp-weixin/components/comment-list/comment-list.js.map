{"version":3,"file":"comment-list.js","sources":["components/comment-list/comment-list.vue","/Users/sapphirell/Documents/git/dogdogdoll-uniapp/components/comment-list/comment-list.vue?type=component"],"sourcesContent":["<!-- components/comment-list.vue -->\r\n<template>\r\n\t<view class=\"comment-container\">\r\n\t\t<view class=\"comment-count\" v-if=\"commentList.length > 0\">\r\n\t\t\t共{{ mainCommentsTotal }}条回复\r\n\t\t</view>\r\n\t\t<view class=\"empty-tips\" v-else>\r\n\t\t\t<text>-- 暂无回复 --</text>\r\n\t\t</view>\r\n\t\t<!-- 评论列表 -->\r\n\t\t<view v-for=\"comment in commentList\" :key=\"comment.id\" class=\"comment-card\">\r\n\t\t\t<!-- 主评论 -->\r\n\t\t\t<view class=\"main-comment\">\r\n\t\t\t\t<image @tap=\"jump2user(comment.uid)\" :src=\"comment.avatar\" class=\"avatar\" mode=\"aspectFill\" />\r\n\t\t\t\t<view class=\"content\">\r\n\t\t\t\t\t<view class=\"header\">\r\n\t\t\t\t\t\t<text class=\"username\"\r\n\t\t\t\t\t\t\t@tap=\"jump2user(comment.uid)\">{{ formatUsername(comment.username) }}</text>\r\n\t\t\t\t\t\t<text class=\"floor\">#{{ comment.floor }}</text>\r\n\t\t\t\t\t\t<report-button :report-type=\"5\" :relation-id=\"comment.id\" button-text=\"举报\" icon-color=\"#999\"\r\n\t\t\t\t\t\t\ttheme-color=\"#64c6dc\" />\r\n\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<text class=\"comment-text\" @click=\"handleReply(comment)\">{{ comment.comment }}</text>\r\n\r\n\r\n\t\t\t\t\t<view class=\"footer\">\r\n\t\t\t\t\t\t<view class=\"left-actions\">\r\n\t\t\t\t\t\t\t<text class=\"time\">{{ formatTime(comment.created_at) }}</text>\r\n\t\t\t\t\t\t\t<view class=\"like-container\">\r\n\t\t\t\t\t\t\t\t<view class=\"like-btn\" @click=\"handleLike(comment)\">\r\n\t\t\t\t\t\t\t\t\t<uni-icons :type=\"comment.user_like ? 'hand-up-filled' : 'hand-up'\" size=\"18\"\r\n\t\t\t\t\t\t\t\t\t\t:color=\"comment.user_like ? 'rgb(100 198 220)' : '#999'\" />\r\n\t\t\t\t\t\t\t\t\t<text class=\"like-count\" :class=\"{ liked: comment.user_like }\">\r\n\t\t\t\t\t\t\t\t\t\t{{ comment.like_count || 0 }}\r\n\t\t\t\t\t\t\t\t\t</text>\r\n\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t</view>\r\n\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t<view class=\"right-actions\">\n\t\t\t\t\t\t\t<!-- 新增表态按钮组 -->\n\t\t\t\t\t\t\t<attitude-widget :target-id=\"comment.id\" :type=\"6\" :attitude-status=\"comment.attitudeStatus\"\n\t\t\t\t\t\t\t\t:attitude-counts=\"comment.attitudeCounts\" @change=\"handleAttitudeChange(comment, $event)\" />\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t<text class=\"reply-btn\" @click=\"handleReply(comment)\">回复</text>\r\n\t\t\t\t\t\t</view>\r\n\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\r\n\t\t\t<!-- 子评论 -->\r\n\t\t\t<view v-if=\"comment.localChildren && comment.localChildren.length\" class=\"sub-comments\">\r\n\t\t\t\t<view v-for=\"(child, index) in visibleChildren(comment)\" :key=\"child.id\" class=\"sub-comment\">\r\n\t\t\t\t\t<image @tap=\"jump2user(child.uid)\" :src=\"child.avatar\" class=\"avatar\" mode=\"aspectFill\" />\r\n\t\t\t\t\t<view class=\"content\">\r\n\t\t\t\t\t\t<view class=\"header\">\r\n\t\t\t\t\t\t\t<text @tap=\"jump2user(child.uid)\"\r\n\t\t\t\t\t\t\t\tclass=\"username\">{{ formatUsername(child.username) }}</text>\r\n\t\t\t\t\t\t\t<text v-if=\"child.reply_for\" class=\"reply-to\">@{{ child.reply_for }}</text>\r\n\t\t\t\t\t\t\t<report-button :report-type=\"5\" :relation-id=\"child.id\" button-text=\"举报\" icon-color=\"#999\"\r\n\t\t\t\t\t\t\t\ttheme-color=\"#64c6dc\" />\r\n\t\t\t\t\t\t</view>\r\n\r\n\t\t\t\t\t\t<text class=\"comment-text\" @click=\"handleReply(comment)\">{{ child.comment }}</text>\r\n\r\n\t\t\t\t\t\t\r\n\r\n\r\n\t\t\t\t\t\t<view class=\"footer\">\r\n\t\t\t\t\t\t\t<view class=\"left-actions\">\r\n\t\t\t\t\t\t\t\t<text class=\"time\">{{ formatTime(child.created_at) }}</text>\r\n\t\t\t\t\t\t\t\t<view class=\"like-container\">\r\n\t\t\t\t\t\t\t\t\t<view class=\"like-btn\" @click=\"handleLike(child)\">\r\n\t\t\t\t\t\t\t\t\t\t<uni-icons :type=\"child.user_like ? 'hand-up-filled' : 'hand-up'\" size=\"18\"\r\n\t\t\t\t\t\t\t\t\t\t\t:color=\"child.user_like ? 'rgb(100 198 220)' : '#999'\" />\r\n\t\t\t\t\t\t\t\t\t\t<text class=\"like-count\" :class=\"{ liked: child.user_like }\">\r\n\t\t\t\t\t\t\t\t\t\t\t{{ child.like_count || 0 }}\r\n\t\t\t\t\t\t\t\t\t\t</text>\r\n\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t</view>\r\n\r\n\t\t\t\t\t\t\t<view class=\"right-actions\">\n\t\t\t\t\t\t\t\t<!-- 新增表态按钮组 -->\n\t\t\t\t\t\t\t\t<attitude-widget :target-id=\"child.id\" :type=\"6\" :attitude-status=\"comment.attitudeStatus\"\n\t\t\t\t\t\t\t\t\t:attitude-counts=\"comment.attitudeCounts\" @change=\"handleAttitudeChange(comment, $event)\" />\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t<text class=\"reply-btn\" @click=\"handleReply(comment, child)\">回复</text>\r\n\r\n\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\r\n\t\t\t\t<!-- 加载更多 -->\r\n\t\t\t\t<view v-if=\"shouldShowMore(comment)\" class=\"load-more\" @click=\"loadMore(comment)\">\r\n\t\t\t\t\t<text>展开{{ remainingCount(comment) }}条回复</text>\r\n\t\t\t\t\t<uni-icons type=\"arrow-down\" size=\"18\" color=\"#007AFF\" />\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\r\n\r\n\t\t<!-- 加载更多按钮 -->\r\n\t\t<view class=\"load-more-box\" v-if=\"commentList.length > 0\">\r\n\t\t\t<view v-if=\"hasMore\" class=\"load-more-btn\" @click=\"loadMoreMainComments\" :class=\"{loading: loading}\">\r\n\t\t\t\t<view v-if=\"!loading\">\r\n\t\t\t\t\t<text> 加载更多 </text>\r\n\t\t\t\t\t<uni-icons type=\"arrow-down\" size=\"18\" color=\"#007AFF\" />\r\n\t\t\t\t</view>\r\n\t\t\t\t<view v-else>\r\n\t\t\t\t\t<uni-icons type=\"spinner-cycle\" size=\"16\" color=\"#888\" />\r\n\t\t\t\t</view>\r\n\r\n\t\t\t</view>\r\n\t\t\t<view v-else class=\"no-more\">\r\n\t\t\t\t<text>-- 没有更多了 --</text>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\r\n\r\n\t</view>\r\n</template>\r\n\r\n<script setup>\r\n\timport {\r\n\t\tref,\r\n\t\tcomputed,\r\n\t\tonMounted,\r\n\t\treactive\r\n\t} from 'vue'\r\n\timport {\r\n\t\twebsiteUrl,\r\n\t\tasyncGetUserInfo,\r\n\t\twechatSignLogin,\r\n\t\tgetScene,\r\n\t\tglobal,\r\n\t} from '../../common/config.js'\r\n\r\n\r\n\tconst props = defineProps({\r\n\t\ttype: {\r\n\t\t\ttype: Number,\r\n\t\t\trequired: true\r\n\t\t},\r\n\t\trelationId: {\r\n\t\t\ttype: Number,\r\n\t\t\trequired: true\r\n\t\t},\r\n\t})\r\n\r\n\tconst commentList = ref([])\r\n\tconst currentPage = ref(1)\r\n\tconst mainCommentsTotal = ref(0)\r\n\t// 主贴是否有更多\r\n\tconst hasMore = ref(true)\r\n\r\n\tconst subCommentPages = reactive({})\r\n\tconst emit = defineEmits(['reply'])\r\n\r\n\tconst loading = ref(false)\r\n\r\n\t// 处理状态变化\r\n\tconst handleAttitudeChange = (comment, {\r\n\t\tstatus,\r\n\t\tcounts\r\n\t}) => {\r\n\t\tcomment.attitudeStatus = status\r\n\t\tcomment.attitudeCounts = counts\r\n\t}\r\n\r\n\r\n\t// 暴露给父组件的方法\r\n\tdefineExpose({\r\n\t\t// 添加主评论\r\n\t\taddNewComment: (comment) => {\r\n\t\t\tcommentList.value.unshift({\r\n\t\t\t\t...comment,\r\n\t\t\t\tshowAll: false,\r\n\t\t\t\tlocalChildren: [],\r\n\t\t\t\tchildTotal: 0\r\n\t\t\t})\r\n\t\t},\r\n\r\n\t\t// 添加子评论\r\n\t\taddReplyComment: (reply) => {\r\n\t\t\tconst parent = commentList.value.find(c => c.id === reply.parent_id)\r\n\t\t\tif (parent) {\r\n\t\t\t\t// 确保 localChildren 数组存在\r\n\t\t\t\tif (!parent.localChildren) {\r\n\t\t\t\t\tparent.localChildren = []\r\n\t\t\t\t}\r\n\t\t\t\t// 确保 childTotal 存在\r\n\t\t\t\tif (typeof parent.childTotal !== 'number') {\r\n\t\t\t\t\tparent.childTotal = 0\r\n\t\t\t\t}\r\n\r\n\t\t\t\tparent.localChildren.unshift(reply)\r\n\t\t\t\tparent.childTotal += 1\r\n\r\n\t\t\t\t// 自动展开子评论列表\r\n\t\t\t\tif (!parent.showAll && parent.childTotal <= 5) {\r\n\t\t\t\t\tparent.showAll = true\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\r\n\r\n\r\n\t})\r\n\r\n\t// 初始化加载评论\r\n\tonMounted(() => {\r\n\t\tloadMainComments()\r\n\t})\r\n\t// 增加缺失的visibleChildren计算属性\r\n\tconst visibleChildren = (comment) => {\r\n\t\tif (!comment.showAll && comment.localChildren.length > 5) {\r\n\t\t\treturn comment.localChildren.slice(0, 5)\r\n\t\t}\r\n\t\treturn comment.localChildren\r\n\t}\r\n\t// 加载更多主评论\r\n\tconst loadMoreMainComments = async () => {\r\n\t\tif (loading.value || !hasMore.value) {\r\n\t\t\treturn\r\n\t\t}\r\n\t\ttry {\r\n\t\t\tloading.value = true\r\n\t\t\tcurrentPage.value += 1\r\n\t\t\tawait loadMainComments()\r\n\t\t} finally {\r\n\t\t\tloading.value = false\r\n\t\t}\r\n\t}\r\n\r\n\t// 处理点赞\r\n\tconst handleLike = async (comment) => {\r\n\t\tif (!global.isLogin) {\r\n\t\t\tuni.showToast({\r\n\t\t\t\ttitle: '请先登录',\r\n\t\t\t\ticon: 'none'\r\n\t\t\t})\r\n\t\t\treturn\r\n\t\t}\r\n\r\n\t\ttry {\r\n\t\t\tconst token = uni.getStorageSync('token')\r\n\t\t\tconst url = `${websiteUrl}/with-state/${comment.user_like ? 'unlike' : 'add-like'}`\r\n\t\t\tconst res = await uni.request({\r\n\t\t\t\turl,\r\n\t\t\t\tmethod: 'POST',\r\n\t\t\t\theader: {\r\n\t\t\t\t\tAuthorization: token\r\n\t\t\t\t},\r\n\t\t\t\tdata: {\r\n\t\t\t\t\tid: comment.id,\r\n\t\t\t\t\ttype: 6 // 评论类型\r\n\t\t\t\t}\r\n\t\t\t})\r\n\r\n\t\t\tif (res.data.status === \"success\") {\r\n\t\t\t\t// 更新点赞状态和数量\r\n\t\t\t\tcomment.user_like = !comment.user_like\r\n\t\t\t\tif (comment.user_like) {\r\n\t\t\t\t\tcomment.like_count = (comment.like_count || 0) + 1\r\n\t\t\t\t} else {\r\n\t\t\t\t\tcomment.like_count = Math.max(0, (comment.like_count || 0) - 1)\r\n\t\t\t\t}\r\n\r\n\t\t\t\tuni.showToast({\r\n\t\t\t\t\ttitle: comment.user_like ? '点赞成功' : '已取消点赞',\r\n\t\t\t\t\ticon: 'none'\r\n\t\t\t\t})\r\n\t\t\t} else {\r\n\t\t\t\tuni.showToast({\r\n\t\t\t\t\ttitle: res.data.msg || '操作失败',\r\n\t\t\t\t\ticon: 'none'\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t} catch (err) {\r\n\t\t\tconsole.error('点赞失败:', err)\r\n\t\t\tuni.showToast({\r\n\t\t\t\ttitle: '操作失败',\r\n\t\t\t\ticon: 'none'\r\n\t\t\t})\r\n\t\t}\r\n\t}\r\n\r\n\tconst jump2user = (uid) => {\r\n\t\tuni.navigateTo({\r\n\t\t\turl: '/pages/user_page/user_page?uid=' + uid\r\n\t\t})\r\n\t}\r\n\t// 格式化显示\r\n\tconst formatTime = (timestamp) => {\r\n\t\tconst date = new Date(timestamp * 1000)\r\n\t\treturn `${date.getMonth()+1}-${date.getDate()} ${date.getHours()}:${date.getMinutes()}`\r\n\t}\r\n\r\n\tconst formatUsername = (name) => {\r\n\t\treturn name.length > 12 ? name.slice(0, 12) + '...' : name\r\n\t}\r\n\r\n\t// 加载主评论\r\n\tconst loadMainComments = async () => {\r\n\t\ttry {\r\n\t\t\tloading.value = true\r\n\t\t\tlet token = uni.getStorageSync('token');\r\n\t\t\tconst res = await uni.request({\r\n\t\t\t\turl: `${websiteUrl}/get-comments`,\r\n\t\t\t\tdata: {\r\n\t\t\t\t\trelation_id: props.relationId,\r\n\t\t\t\t\ttype: props.type,\r\n\t\t\t\t\tpage: currentPage.value,\r\n\t\t\t\t\tpage_size: 10 // 添加分页大小\r\n\t\t\t\t},\r\n\t\t\t\theader: {\r\n\t\t\t\t\t'Authorization': token\r\n\t\t\t\t},\r\n\t\t\t})\r\n\r\n\t\t\tif (res.data.status === 'success') {\r\n\t\t\t\tconst data = res.data.data\r\n\t\t\t\tconst newComments = data.comment_list.map(c => ({\r\n\t\t\t\t\t...c,\r\n\t\t\t\t\tshowAll: false,\r\n\t\t\t\t\tlocalChildren: c.children || [],\r\n\t\t\t\t\tchildTotal: c.childTotal || (c.children ? c.children.length : 0),\r\n\t\t\t\t\t// 新增表态相关字段\r\n\t\t\t\t\tattitudeStatus: c.user_attitude || 0, // 当前用户表态状态\r\n\t\t\t\t\tattitudeCounts: c.attitude_counts || {\r\n\t\t\t\t\t\t1: c.count_1 || 0,\r\n\t\t\t\t\t\t2: c.count_2 || 0,\r\n\t\t\t\t\t\t3: c.count_3 || 0,\r\n\t\t\t\t\t\t4: c.count_4 || 0,\r\n\t\t\t\t\t\t5: c.count_5 || 0\r\n\t\t\t\t\t},\r\n\t\t\t\t}))\r\n\r\n\t\t\t\t// 第一页替换，后续追加\r\n\t\t\t\tif (currentPage.value === 1) {\r\n\t\t\t\t\tcommentList.value = newComments\r\n\t\t\t\t} else {\r\n\t\t\t\t\tcommentList.value.push(...newComments)\r\n\t\t\t\t}\r\n\t\t\t\tconsole.log(\"total\", data.total)\r\n\t\t\t\t// 判断是否还有更多\r\n\t\t\t\thasMore.value = data.total > commentList.value.length\r\n\t\t\t\tmainCommentsTotal.value = data.total\r\n\t\t\t\tconsole.log(\"是否还有更多?\", hasMore.value)\r\n\t\t\t}\r\n\t\t} catch (err) {\r\n\t\t\tuni.showToast({\r\n\t\t\t\ttitle: '加载失败',\r\n\t\t\t\ticon: 'none'\r\n\t\t\t})\r\n\t\t} finally {\r\n\t\t\tloading.value = false\r\n\t\t}\r\n\t}\r\n\r\n\t// 处理回复\r\n\tconst handleReply = (parent, target = null) => {\r\n\t\temit('reply', {\r\n\t\t\tparent,\r\n\t\t\ttarget,\r\n\t\t\trelationId: props.relationId\r\n\t\t})\r\n\t}\r\n\r\n\r\n\r\n\tconst shouldShowMore = (comment) => {\r\n\t\treturn comment.childTotal > 5 && !comment.showAll\r\n\t}\r\n\t// 剩余数量计算\r\n\tconst remainingCount = (comment) => {\r\n\t\treturn comment.childTotal - Math.min(comment.localChildren.length, 5)\r\n\t}\r\n\r\n\t// 修正后的加载更多逻辑\r\n\tconst loadMore = async (comment) => {\r\n\t\tif (comment.localChildren.length < comment.childTotal) {\r\n\t\t\tconst nextPage = Math.ceil(comment.localChildren.length / 5) + 1\r\n\t\t\ttry {\r\n\t\t\t\tconst res = await uni.request({\r\n\t\t\t\t\turl: `${websiteUrl}/get-comments-by-parent-id`,\r\n\t\t\t\t\tdata: {\r\n\t\t\t\t\t\tparent_id: comment.id,\r\n\t\t\t\t\t\tpage: nextPage\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\r\n\t\t\t\tif (res.data.status === 'success') {\r\n\t\t\t\t\tcomment.localChildren = [\r\n\t\t\t\t\t\t...comment.localChildren,\r\n\t\t\t\t\t\t...res.data.data.comment_list\r\n\t\t\t\t\t]\r\n\t\t\t\t\tcomment.childTotal = res.data.data.total\r\n\r\n\t\t\t\t\t// 如果加载后仍然未完全展开，保持折叠状态\r\n\t\t\t\t\tif (comment.localChildren.length >= 5 && !comment.showAll) {\r\n\t\t\t\t\t\tcomment.showAll = true\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t} catch (err) {\r\n\t\t\t\tuni.showToast({\r\n\t\t\t\t\ttitle: '加载失败',\r\n\t\t\t\t\ticon: 'none'\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tcomment.showAll = !comment.showAll\r\n\t\t}\r\n\t}\r\n</script>\r\n\r\n<style lang=\"less\">\r\n\t.comment-container {\r\n\t\tpadding: 20rpx;\r\n\t\t// background: #f8f8f8;\r\n\r\n\t\t.comment-count {\r\n\t\t\tpadding: 20rpx 24rpx;\r\n\t\t\tfont-size: 24rpx;\r\n\t\t\tcolor: #999;\r\n\t\t\tmargin-bottom: 20rpx;\r\n\t\t}\r\n\r\n\t\t.empty-tips {\r\n\t\t\ttext-align: center;\r\n\t\t\tpadding: 100rpx 0;\r\n\r\n\t\t\ttext {\r\n\t\t\t\tcolor: #999;\r\n\t\t\t\tfont-size: 22rpx;\r\n\t\t\t}\r\n\r\n\t\t}\r\n\t}\r\n\r\n\t.comment-card {\r\n\t\tbackground: #fff;\r\n\t\tborder-radius: 16rpx;\r\n\t\tmargin-bottom: 24rpx;\r\n\t\tpadding: 24rpx;\r\n\t\tbox-shadow: 0 4rpx 22rpx rgba(0, 0, 0, 0.05);\r\n\t}\r\n\r\n\t.main-comment,\r\n\t.sub-comment {\r\n\t\tdisplay: flex;\r\n\r\n\t\t.avatar {\r\n\t\t\twidth: 72rpx;\r\n\t\t\theight: 72rpx;\r\n\t\t\tborder-radius: 50%;\r\n\t\t\tmargin-right: 24rpx;\r\n\t\t\tflex-shrink: 0;\r\n\t\t\tborder: 2rpx solid #f0f0f0;\r\n\t\t}\r\n\r\n\t\t.content {\r\n\t\t\tflex: 1;\r\n\t\t\tmin-height: 120rpx; // 添加最小高度\r\n\t\t\tdisplay: flex;\r\n\t\t\tflex-direction: column; // 改为纵向布局\r\n\r\n\t\t\t.header {\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\talign-items: center;\r\n\t\t\t\tmargin-bottom: 12rpx;\r\n\r\n\t\t\t\t.username {\r\n\t\t\t\t\tfont-size: 22rpx;\r\n\t\t\t\t\tcolor: #b2b8bc;\r\n\t\t\t\t\tfont-weight: 500;\r\n\t\t\t\t\tmax-width: 400rpx;\r\n\t\t\t\t\toverflow: hidden;\r\n\t\t\t\t\ttext-overflow: ellipsis;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t.floor {\r\n\t\t\t\t\tfont-size: 20rpx;\r\n\t\t\t\t\tcolor: #999;\r\n\t\t\t\t\tmargin-left: 16rpx;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t.comment-text {\r\n\t\t\t\tfont-size: 22rpx;\r\n\t\t\t\tcolor: #494b4b;\r\n\t\t\t\tline-height: 1.6;\r\n\t\t\t\tmargin-bottom: 16rpx;\r\n\t\t\t\tflex: 1; // 内容区域撑满空间\r\n\t\t\t\tmargin-bottom: 10rpx;\r\n\t\t\t\tmin-height: 60rpx; // 内容最小高度\r\n\t\t\t}\r\n\r\n\r\n\t\t}\r\n\t}\r\n\r\n\t.sub-comments {\r\n\t\tmargin-left: 72rpx;\r\n\t\tpadding-left: 24rpx;\r\n\t\tborder-left: 2rpx solid #eee;\r\n\r\n\t\t.sub-comment {\r\n\t\t\tmargin-top: 24rpx;\r\n\r\n\t\t\t.avatar {\r\n\t\t\t\twidth: 56rpx;\r\n\t\t\t\theight: 56rpx;\r\n\t\t\t}\r\n\r\n\t\t\t.header {\r\n\t\t\t\t.reply-to {\r\n\t\t\t\t\tcolor: #00aadb;\r\n\t\t\t\t\tmargin-left: 12rpx;\r\n\t\t\t\t\tfont-size: 20rpx;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t&.folded {\r\n\t\t\t\tdisplay: none;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t.load-more {\r\n\t\t\tdisplay: flex;\r\n\t\t\talign-items: center;\r\n\t\t\tjustify-content: center;\r\n\r\n\t\t\ttext {\r\n\t\t\t\tfont-size: 22rpx;\r\n\t\t\t}\r\n\r\n\t\t\tpadding: 16rpx;\r\n\t\t\tmargin-top: 16rpx;\r\n\t\t\tbackground: none;\r\n\t\t\tborder-radius: 8rpx;\r\n\r\n\t\t\tuni-icons {\r\n\t\t\t\tmargin-left: 8rpx;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t.load-more-box {\r\n\t\ttext-align: center;\r\n\t\tpadding: 30rpx 0;\r\n\r\n\t\t.load-more-btn {\r\n\t\t\tpadding: 12rpx 24rpx;\r\n\t\t\tborder-radius: 40rpx;\r\n\t\t}\r\n\r\n\t\t.no-more {\r\n\t\t\tcolor: #999;\r\n\t\t\tfont-size: 24rpx;\r\n\t\t}\r\n\t}\r\n\r\n\r\n\t// 优化子评论布局\r\n\t.sub-comment {\r\n\t\tdisplay: flex;\r\n\t\tmargin-top: 24rpx;\r\n\r\n\t\t.avatar {\r\n\t\t\twidth: 56rpx !important; // 强制覆盖\r\n\t\t\theight: 56rpx !important;\r\n\t\t\tmargin-right: 20rpx;\r\n\t\t\tflex-shrink: 0;\r\n\t\t}\r\n\r\n\t\t.header {\r\n\t\t\tdisplay: flex;\r\n\t\t\talign-items: center;\r\n\t\t\tmargin-bottom: 10rpx;\r\n\r\n\t\t\t.username {\r\n\t\t\t\tfont-size: 22rpx;\r\n\t\t\t\tcolor: #888;\r\n\t\t\t\tmax-width: 180rpx;\r\n\t\t\t}\r\n\r\n\t\t\t.reply-to {\r\n\t\t\t\tcolor: #007AFF;\r\n\t\t\t\tmargin-left: 12rpx;\r\n\t\t\t\tfont-size: 20rpx;\r\n\t\t\t\tmax-width: 200rpx;\r\n\t\t\t\toverflow: hidden;\r\n\t\t\t\ttext-overflow: ellipsis;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t.comment-text {\r\n\t\t\tfont-size: 22rpx !important;\r\n\t\t\tcolor: #666 !important;\r\n\t\t\tline-height: 1.5;\r\n\t\t}\r\n\r\n\t}\r\n\r\n\r\n\t// 加载更多样式优化\r\n\t.load-more {\r\n\t\tmargin-top: 24rpx !important;\r\n\t\t// background: rgba(0, 122, 255, 0.05) !important;\r\n\t\tborder-radius: 8rpx !important;\r\n\t}\r\n\r\n\t.load-more-box {\r\n\t\tpadding: 30rpx 0;\r\n\t\ttext-align: center;\r\n\r\n\t\ttext {\r\n\t\t\tfont-size: 22rpx;\r\n\t\t}\r\n\r\n\t\t.load-more-btn {\r\n\t\t\tdisplay: inline-flex;\r\n\t\t\talign-items: center;\r\n\t\t\tjustify-content: center;\r\n\t\t\theight: 64rpx;\r\n\t\t\tpadding: 0 40rpx;\r\n\t\t\tfont-size: 26rpx;\r\n\t\t\tborder-radius: 64rpx;\r\n\t\t\ttransition: all 0.3s;\r\n\r\n\r\n\r\n\t\t\t&.loading {\r\n\t\t\t\tcolor: #494b4b;\r\n\t\t\t\topacity: 0.8;\r\n\t\t\t\tpadding: 0 30rpx;\r\n\t\t\t}\r\n\r\n\t\t\tuni-icons {\r\n\t\t\t\tfont-size: 24rpx;\r\n\t\t\t\tmargin-left: 8rpx;\r\n\t\t\t\tanimation: rotating 1s linear infinite;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t.no-more {\r\n\t\t\tcolor: #999;\r\n\t\t\tfont-size: 24rpx;\r\n\t\t\tpadding: 20rpx 0;\r\n\t\t}\r\n\t}\r\n\r\n\t@keyframes rotating {\r\n\t\tfrom {\r\n\t\t\ttransform: rotate(0deg);\r\n\t\t}\r\n\r\n\t\tto {\r\n\t\t\ttransform: rotate(360deg);\r\n\t\t}\r\n\t}\r\n\r\n\r\n\t// 新增表态按钮样式\r\n\t.attitude-actions {\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tmargin-right: 20rpx;\r\n\r\n\t\t.attitude-btn {\r\n\t\t\tdisplay: flex;\r\n\t\t\talign-items: center;\r\n\t\t\tpadding: 6rpx 12rpx;\r\n\t\t\tmargin-right: 10rpx;\r\n\t\t\tborder-radius: 20rpx;\r\n\t\t\tbackground: #f5f5f5;\r\n\t\t\ttransition: all 0.3s;\r\n\r\n\t\t\t&.active {\r\n\t\t\t\tbackground: #e0f0ff;\r\n\r\n\t\t\t\t.emoji,\r\n\t\t\t\t.count {\r\n\t\t\t\t\tcolor: #fff;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t.emoji {\r\n\t\t\t\tfont-size: 28rpx;\r\n\t\t\t\tmargin-right: 4rpx;\r\n\t\t\t}\r\n\r\n\t\t\t.count {\r\n\t\t\t\tfont-size: 22rpx;\r\n\t\t\t\tcolor: #666;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t// 调整原有回复按钮位置\r\n\t.reply-btn {\r\n\t\tmargin-left: auto;\r\n\t}\r\n\r\n\t// 移动端适配\r\n\t@media (max-width: 480px) {\r\n\t\t.attitude-actions {\r\n\t\t\t.attitude-btn {\r\n\t\t\t\tpadding: 4rpx 8rpx;\r\n\t\t\t\tmargin-right: 6rpx;\r\n\r\n\t\t\t\t.emoji {\r\n\t\t\t\t\tfont-size: 24rpx;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t.count {\r\n\t\t\t\t\tfont-size: 18rpx;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\r\n\t.footer {\r\n\t\tdisplay: flex;\r\n\t\tjustify-content: space-between;\r\n\t\talign-items: center;\r\n\t\tmargin-top: 16rpx;\r\n\r\n\t\t.left-actions {\r\n\t\t\tdisplay: flex;\r\n\t\t\talign-items: center;\r\n\t\t\tgap: 20rpx;\r\n\r\n\t\t\t.time {\r\n\t\t\t\tfont-size: 20rpx;\r\n\t\t\t\tcolor: #999;\r\n\t\t\t}\r\n\r\n\t\t\t.like-container {\r\n\t\t\t\t.like-btn {\r\n\t\t\t\t\tdisplay: flex;\r\n\t\t\t\t\talign-items: center;\r\n\t\t\t\t\tgap: 8rpx;\r\n\t\t\t\t\tpadding: 6rpx 16rpx;\r\n\t\t\t\t\tborder-radius: 20rpx;\r\n\r\n\r\n\t\t\t\t\t.like-count {\r\n\t\t\t\t\t\tfont-size: 20rpx;\r\n\t\t\t\t\t\tcolor: #999;\r\n\r\n\t\t\t\t\t\t&.liked {\r\n\t\t\t\t\t\t\tcolor: rgb(100 198 220);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t.right-actions {\r\n\t\t\tdisplay: flex;\r\n\t\t\talign-items: center;\r\n\t\t\t/* 添加这行确保垂直居中 */\r\n\t\t\tgap: 10rpx;\r\n\t\t\t/* 添加间距使两个按钮分开 */\r\n\r\n\t\t\t.reply-btn {\r\n\t\t\t\tfont-size: 22rpx;\r\n\t\t\t\tcolor: #97b7df;\r\n\t\t\t\tpadding: 6rpx 20rpx;\r\n\t\t\t\tborder-radius: 24rpx;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t/* 子评论操作栏微调 */\r\n\t.sub-comment .footer {\r\n\t\tmargin-top: 10rpx;\r\n\r\n\t\t.like-btn {\r\n\t\t\tpadding: 4rpx 12rpx;\r\n\t\t}\r\n\t}\r\n</style>","import Component from '/Users/sapphirell/Documents/git/dogdogdoll-uniapp/components/comment-list/comment-list.vue'\nwx.createComponent(Component)"],"names":["ref","reactive","onMounted","global","uni","websiteUrl","Component"],"mappings":"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"}