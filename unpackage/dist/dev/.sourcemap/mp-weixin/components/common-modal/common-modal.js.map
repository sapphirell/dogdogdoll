{"version":3,"file":"common-modal.js","sources":["components/common-modal/common-modal.vue","/Users/sapphirell/Documents/git/dogdogdoll-uniapp/components/common-modal/common-modal.vue?type=component"],"sourcesContent":["<!-- components/common-modal.vue -->\n<template>\n\t<view class=\"modal-mask\" v-if=\"visible\" @tap.stop=\"closeModal\" @touchmove.stop.prevent=\"moveHandle\"\n\t:style=\"maskStyle\">  <!-- 修改：使用动态样式 -->\n\t\t<uni-transition :mode-class=\"modeClass\" :show=\"visible\">\n\t\t\t<view class=\"modal-container\" :style=\"containerStyle\" @tap.stop>\n\t\t\t\t<view class=\"modal-content\">\n\t\t\t\t\t<slot></slot>\n\t\t\t\t</view>\n\t\t\t</view>\n\t\t</uni-transition>\n\t</view>\n</template>\n\n<script setup>\n\timport {\n\t\tdefineProps,\n\t\tdefineEmits,\n\t\tcomputed,\n\t\tref,\n\t\tonMounted  // 新增生命周期钩子\n\t} from 'vue'\n\t\n\timport {\n\t\tgetScene\n\t} from \"../../common/config.js\";\n\t\n\tconst isApp = ref(false)\n\t\n\tconst props = defineProps({\n\t\tvisible: Boolean,\n\t\ttop: {\n\t\t\ttype: [String, Number],\n\t\t\tdefault: '30%'\n\t\t},\n\t\twidth: {\n\t\t\ttype: [String, Number],\n\t\t\tdefault: '80%'\n\t\t},\n\t\theight: {\n\t\t\ttype: [String, Number],\n\t\t\tdefault: 'auto'\n\t\t},\n\t\tcloseable: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: true\n\t\t},\n\t})\n\t\n\tlet modeClass = ref(['fade', 'zoom-in'])\n\n\tconst emit = defineEmits(['update:visible'])\n\n\t// 新增：计算遮罩层样式\n\tconst maskStyle = computed(() => {\n\t\t// App环境下完全透明，其他环境保持半透明遮罩\n\t\treturn {\n\t\t\tbackgroundColor: isApp.value ? 'rgba(0, 0, 0, 0)' : 'rgba(0, 0, 0, 0.5)'\n\t\t}\n\t})\n\n\tconst containerStyle = computed(() => ({\n\t\ttop: formatValue(props.top),\n\t\theight: formatValue(props.height)\n\t}))\n\t\n\tconst moveHandle = () => false;\n\n\tconst formatValue = (val) => {\n\t\tif (typeof val === 'number') return `${val}px`\n\t\tif (/\\d$/.test(val)) return `${val}px`\n\t\treturn val\n\t}\n\n\tconst closeModal = () => {\n\t\tif (props.closeable) {\n\t\t\temit('update:visible', false)\n\t\t}\n\t}\n\t\n\t// 新增：组件挂载时检测环境\n\tonMounted(() => {\n\t\tconst scene = getScene()\n\t\tisApp.value = scene === 2 || scene === 3  // 2或3表示App环境\n\t})\n</script>\n\n<style scoped>\n\t.modal-mask {\n\t\tposition: fixed;\n\t\ttop: 0;\n\t\tleft: 0;\n\t\tright: 0;\n\t\tbottom: 0;\n\t\tdisplay: flex;\n\t\tjustify-content: center;\n\t\tz-index: 1001;\n\t\t/* 移除背景色设置，改为动态绑定 */\n\t}\n\n\t.modal-container {\n\t\tposition: absolute;\n\t\tbackground-color: #fff;\n\t\tborder-radius: 8px;\n\t\tpadding: 20px;\n\t\tbox-shadow: 0 2px 8px rgba(0, 0, 0, 0.33);\n\t\tmin-width: 200px;\n\t\tmin-height: 100px;\n\t\tmax-width: 100vw;\n\t\tleft: 50%;\n\t\ttransform: translateX(-50%);\n\t}\n\n\t.modal-content {\n\t\t/* position: relative; */\n\t}\n</style>\n","import Component from '/Users/sapphirell/Documents/git/dogdogdoll-uniapp/components/common-modal/common-modal.vue'\nwx.createComponent(Component)"],"names":["ref","computed","onMounted","getScene"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA2BC,UAAM,QAAQA,cAAG,IAAC,KAAK;AAEvB,UAAM,QAAQ;AAoBd,QAAI,YAAYA,cAAG,IAAC,CAAC,QAAQ,SAAS,CAAC;AAEvC,UAAM,OAAO;AAGb,UAAM,YAAYC,cAAAA,SAAS,MAAM;AAEhC,aAAO;AAAA,QACN,iBAAiB,MAAM,QAAQ,qBAAqB;AAAA,MACpD;AAAA,IACH,CAAE;AAED,UAAM,iBAAiBA,cAAAA,SAAS,OAAO;AAAA,MACtC,KAAK,YAAY,MAAM,GAAG;AAAA,MAC1B,QAAQ,YAAY,MAAM,MAAM;AAAA,IAClC,EAAG;AAEF,UAAM,aAAa,MAAM;AAEzB,UAAM,cAAc,CAAC,QAAQ;AAC5B,UAAI,OAAO,QAAQ;AAAU,eAAO,GAAG,GAAG;AAC1C,UAAI,MAAM,KAAK,GAAG;AAAG,eAAO,GAAG,GAAG;AAClC,aAAO;AAAA,IACP;AAED,UAAM,aAAa,MAAM;AACxB,UAAI,MAAM,WAAW;AACpB,aAAK,kBAAkB,KAAK;AAAA,MAC5B;AAAA,IACD;AAGDC,kBAAAA,UAAU,MAAM;AACf,YAAM,QAAQC,cAAAA,SAAU;AACxB,YAAM,QAAQ,UAAU,KAAK,UAAU;AAAA,IACzC,CAAE;;;;;;;;;;;;;;;;;;;;ACnFF,GAAG,gBAAgB,SAAS;"}