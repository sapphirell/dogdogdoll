{"version":3,"file":"goods-search.js","sources":["components/goods-search/goods-search.vue","/Users/sapphirell/Documents/git/dogdogdoll-uniapp/components/goods-search/goods-search.vue?type=component"],"sourcesContent":["<template>\r\n\t<view class=\"search_tab\" :class=\"$attrs.class\" :style=\"{ background: background || '#fff' }\">\r\n\t\t<image v-if=\"!hiddenIcon\" class=\"icon_image\" src=\"../../static/search.png\"></image>\r\n\t\t<input class=\"common_search_input\" placeholder=\"请输入商品名称...\" :value=\"inputValue\" @input=\"onSearchInput\"\r\n\t\t\t:style=\"{ fontSize: fontSize || '22rpx' }\" />\r\n\t\t<image class=\"icon_image\" src=\"../../static/cancel.png\" @tap=\"cancel\" v-if=\"results.length > 0\"></image>\r\n\t</view>\r\n\r\n\t<!-- 商品搜索结果 -->\r\n\t<scroll-view v-if=\"results.length > 0\" class=\"search_results\" :style=\"{ width: width }\" scroll-y>\r\n\t\t<view v-for=\"item in results\" :key=\"item.id\" class=\"result_item\" @tap=\"onTap(item)\">\r\n\t\t\t<view class=\"brand-tag\" v-if=\"item.brand_name\">{{ item.brand_name }}</view>\r\n\t\t\t<text class=\"goods-name\">{{ item.name }}</text>\r\n\t\t</view>\r\n\t</scroll-view>\r\n</template>\r\n\r\n<script setup>\r\n\timport {\r\n\t\tref,computed\r\n\t} from 'vue';\r\n\timport {\r\n\t\twebsiteUrl\r\n\t} from \"../../common/config.js\";\r\n\r\n\tconst props = defineProps({\r\n\t\tmodelValue: {\r\n\t\t\ttype: String,\r\n\t\t\tdefault: ''\r\n\t\t},\r\n\t\twidth: {\r\n\t\t\ttype: String,\r\n\t\t\tdefault: '100%'\r\n\t\t},\r\n\t\tbackground: {\r\n\t\t\ttype: String,\r\n\t\t\tdefault: ''\r\n\t\t},\r\n\t\tfontSize: {\r\n\t\t\ttype: String,\r\n\t\t\tdefault: ''\r\n\t\t},\r\n\t\ttagColor: {\r\n\t\t\ttype: String,\r\n\t\t\tdefault: '#666' // 新增标签颜色控制\r\n\t\t},\r\n\t\tmode: {\r\n\t\t\ttype: String,\r\n\t\t\tdefault: 'jump',\r\n\t\t\tvalidator: (value) => ['jump', 'fill'].includes(value)\r\n\t\t},\r\n\t\thiddenIcon: {\r\n\t\t\ttype: Boolean,\r\n\t\t\tdefault: true\r\n\t\t},\r\n\r\n\t});\r\n\r\n\tconst emit = defineEmits(['select', 'update:modelValue']);\r\n\t// const searchTerm = ref('');\r\n\tconst results = ref([]);\r\n\r\n\t// 使用computed处理输入值\r\n\tconst inputValue = computed({\r\n\t\tget: () => props.modelValue,\r\n\t\tset: (val) => emit('update:modelValue', val)\r\n\t});\r\n\r\n\r\n\n// 修改onSearchInput方法\nconst onSearchInput = async (e) => {\n  inputValue.value = e.detail.value; // 更新双向绑定值\n  const searchValue = e.detail.value.trim();\n  \n  if (!searchValue) {\n    results.value = [];\n    return;\n  }\n\n  try {\n    const res = await uni.request({\n      url: websiteUrl + `/search-goods?search=${encodeURIComponent(searchValue)}`,\n      method: 'GET'\n    });\n\n    results.value = res.data?.status === \"success\" ? res.data.data || [] : [];\n  } catch (error) {\n    console.error('搜索失败:', error);\n    results.value = [];\n  }\n};\n\r\n\r\n\tconst onTap = (goods) => {\r\n\t\tif (props.mode === 'jump') {\r\n\t\t\tuni.navigateTo({\r\n\t\t\t\turl: `/pages/goods/goods?goods_id=${goods.id}`\r\n\t\t\t});\r\n\t\t}  if (props.mode === 'fill') {\n\t\t\temit('select', goods);\n\t\t\tinputValue.value = goods.name; // 直接更新双向绑定值\n\t\t\tresults.value = [];\n\t\t  }\r\n\t};\r\n\r\n\tconst cancel = () => {\r\n\t\t// searchTerm.value = '';\r\n\t\tresults.value = [];\r\n\t};\r\n</script>\r\n\r\n<style lang=\"less\">\r\n\t.search_tab {\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tpadding: 0 20rpx;\r\n\t\tborder-radius: 12rpx;\r\n\t\tbackground: #fff;\r\n\t\theight: 72rpx;\r\n\r\n\t\t.icon_image {\r\n\t\t\twidth: 36rpx;\r\n\t\t\theight: 36rpx;\r\n\t\t\tflex-shrink: 0;\r\n\r\n\t\t\t&:first-child {\r\n\t\t\t\tmargin-right: 16rpx;\r\n\t\t\t}\r\n\r\n\t\t\t&:last-child {\r\n\t\t\t\tmargin-left: 16rpx;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t.common_search_input {\r\n\t\t\tflex: 1;\r\n\t\t\theight: 100%;\r\n\t\t\tpadding: 0;\r\n\t\t\tfont-size: inherit;\r\n\t\t}\r\n\t}\r\n\r\n\t.search_results {\r\n\t\tmargin-top: 16rpx;\r\n\t\tbackground: #fff;\r\n\t\tborder-radius: 12rpx;\r\n\t\tbox-shadow: 0 8rpx 24rpx rgba(0, 0, 0, 0.08);\r\n\t\tmax-height: 60vh;\r\n\t\tposition: absolute;\r\n\t\tz-index: 10;\r\n\r\n\t\t.result_item {\r\n\t\t\tdisplay: flex;\r\n\t\t\talign-items: center;\r\n\t\t\tpadding: 24rpx;\r\n\t\t\tborder-bottom: 1rpx solid #f0f0f0;\r\n\r\n\t\t\t&:last-child {\r\n\t\t\t\tborder-bottom: none;\r\n\t\t\t}\r\n\r\n\t\t\t&:active {\r\n\t\t\t\tbackground: #f8f8f8;\r\n\t\t\t}\r\n\r\n\t\t\t.brand-tag {\r\n\t\t\t\tbackground: #f0f0f0;\r\n\t\t\t\tcolor: #666;\r\n\t\t\t\tfont-size: 20rpx;\r\n\t\t\t\tpadding: 4rpx 12rpx;\r\n\t\t\t\tborder-radius: 6rpx;\r\n\t\t\t\tmargin-right: 16rpx;\r\n\t\t\t\tline-height: 1.4;\r\n\t\t\t\tmax-width: 200rpx;\r\n\t\t\t\twhite-space: nowrap;\r\n\t\t\t\toverflow: hidden;\r\n\t\t\t\ttext-overflow: ellipsis;\r\n\t\t\t}\r\n\r\n\t\t\t.goods-name {\r\n\t\t\t\tflex: 1;\r\n\t\t\t\tcolor: #333;\r\n\t\t\t\tfont-size: 28rpx;\r\n\t\t\t\toverflow: hidden;\r\n\t\t\t\ttext-overflow: ellipsis;\r\n\t\t\t\twhite-space: nowrap;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n</style>","import Component from '/Users/sapphirell/Documents/git/dogdogdoll-uniapp/components/goods-search/goods-search.vue'\nwx.createComponent(Component)"],"names":["ref","computed","uni","websiteUrl","Component"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAyBC,UAAM,QAAQ;AAiCd,UAAM,OAAO;AAEb,UAAM,UAAUA,kBAAI,CAAA,CAAE;AAGtB,UAAM,aAAaC,cAAAA,SAAS;AAAA,MAC3B,KAAK,MAAM,MAAM;AAAA,MACjB,KAAK,CAAC,QAAQ,KAAK,qBAAqB,GAAG;AAAA,IAC7C,CAAE;AAKF,UAAM,gBAAgB,OAAO,MAAM;;AACjC,iBAAW,QAAQ,EAAE,OAAO;AAC5B,YAAM,cAAc,EAAE,OAAO,MAAM,KAAI;AAEvC,UAAI,CAAC,aAAa;AAChB,gBAAQ,QAAQ;AAChB;AAAA,MACD;AAED,UAAI;AACF,cAAM,MAAM,MAAMC,cAAG,MAAC,QAAQ;AAAA,UAC5B,KAAKC,cAAU,aAAG,wBAAwB,mBAAmB,WAAW,CAAC;AAAA,UACzE,QAAQ;AAAA,QACd,CAAK;AAED,gBAAQ,UAAQ,SAAI,SAAJ,mBAAU,YAAW,YAAY,IAAI,KAAK,QAAQ,CAAA,IAAK,CAAA;AAAA,MACxE,SAAQ,OAAO;AACdD,6FAAc,SAAS,KAAK;AAC5B,gBAAQ,QAAQ;MACjB;AAAA,IACH;AAGC,UAAM,QAAQ,CAAC,UAAU;AACxB,UAAI,MAAM,SAAS,QAAQ;AAC1BA,sBAAAA,MAAI,WAAW;AAAA,UACd,KAAK,+BAA+B,MAAM,EAAE;AAAA,QAChD,CAAI;AAAA,MACJ;AAAK,UAAI,MAAM,SAAS,QAAQ;AAC7B,aAAK,UAAU,KAAK;AACpB,mBAAW,QAAQ,MAAM;AACzB,gBAAQ,QAAQ;MACd;AAAA,IACL;AAEC,UAAM,SAAS,MAAM;AAEpB,cAAQ,QAAQ;IAClB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC5GA,GAAG,gBAAgBE,SAAS;"}