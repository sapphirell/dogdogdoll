{"version":3,"file":"common-search.js","sources":["components/common-search/common-search.vue","/Users/sapphirell/Documents/git/dogdogdoll-uniapp/components/common-search/common-search.vue?type=component"],"sourcesContent":["<template>\r\n\t<view class=\"search_tab\" :class=\"$attrs.class\" :style=\"{\n\t\t\tbackground: background || '#fff'\n\t\t}\">\r\n\t\t<image class=\"icon_image\" src=\"../../static/search.png\" v-if=\"props.mode == 'jump'\"></image>\r\n\t\t<input class=\"common_search_input\" placeholder=\"请输入品牌 …\" v-model=\"searchTerm\" @input=\"onSearchInput\"\r\n\t\t\t:ignoreCompositionEvent=\"false\" />\r\n\t\t<image class=\"icon_image\" src=\"../../static/cancel.png\" @tap=\"cancel\" v-if=\"results.length > 0\"></image>\r\n\t</view>\r\n\r\n\t<!-- 显示搜索结果 -->\r\n\t<scroll-view v-if=\"results.length > 0\" class=\"search_results\" :style=\"{width: width}\" scroll-y>\r\n\t\t<view v-for=\"item in results\" :key=\"item.id\" class=\"result_item\" @tap=\"onTap(item.id, item.name)\">\r\n\t\t\t{{ item.name }}\r\n\t\t</view>\r\n\t</scroll-view>\r\n</template>\r\n\r\n<script setup>\r\n\timport {\r\n\t\tref\r\n\t} from 'vue';\r\n\timport {\r\n\t\twebsiteUrl,\r\n\t} from \"../../common/config.js\";\r\n\r\n\t// 新增 props 接收父组件参数\r\n\tconst props = defineProps({\r\n\t\tmode: {\r\n\t\t\ttype: String,\r\n\t\t\tdefault: 'jump', // 默认跳转模式\r\n\t\t\tvalidator: (value) => ['jump', 'fill'].includes(value) // 参数校验\r\n\t\t},\r\n\t\twidth: {\r\n\t\t\ttype: String,\r\n\t\t\tdefault: '100%'\r\n\t\t},\n\t\tbackground: {\n\t\t\ttype: String,\n\t\t\tdefault: ''\n\t\t},\n\t\tfontSize: {\n\t\t\ttype: String,\n\t\t\tdefault: ''\n\t\t},\r\n\t});\r\n\tdefineOptions({\r\n\t\tinheritAttrs: false\r\n\t})\r\n\t// 新增事件定义\r\n\tconst emit = defineEmits(['select']);\r\n\r\n\tconst searchTerm = ref('');\r\n\tconst results = ref([]);\r\n\r\n\r\n\tconst onSearchInput = async () => {\r\n\t\tif (searchTerm.value.trim() === '') {\r\n\t\t\tresults.value = []; // 如果输入框为空，则清空结果\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\temit('select', 0, searchTerm.value); // 清空向父组件传递的id\r\n\r\n\t\t// 发起请求进行搜索\r\n\t\ttry {\r\n\t\t\tconst res = await uni.request({\r\n\t\t\t\turl: websiteUrl + `/search-brand?search=${searchTerm.value}`,\r\n\t\t\t\tmethod: 'GET',\r\n\t\t\t\theader: {\r\n\t\t\t\t\t'Content-Type': 'application/json'\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\tconsole.log('请求结果:', res.data);\r\n\t\t\tif (res.data.status == \"success\") {\r\n\t\t\t\t//判断res.data.data 是不是null\r\n\t\t\t\tif (res.data.data == null) {\r\n\t\t\t\t\tresults.value = [];\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tresults.value = res.data.data;\r\n\t\t\t\treturn\r\n\t\t\t} else {\r\n\t\t\t\tresults.value = [];\r\n\t\t\t\treturn\r\n\t\t\t}\r\n\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error('请求错误:', error);\r\n\t\t\tresults.value = []; // 请求失败时清空结果\r\n\t\t\treturn\r\n\t\t}\r\n\t};\r\n\r\n\tconst onTap = (brandId, brandName) => {\r\n\t\tif (props.mode === 'jump') {\r\n\t\t\t// 跳转模式\r\n\t\t\tuni.navigateTo({\r\n\t\t\t\turl: `/pages/brand/brand?brand_id=${brandId}`\r\n\t\t\t});\r\n\t\t} else if (props.mode === 'fill') {\r\n\t\t\t// 填充模式\r\n\t\t\tsearchTerm.value = brandName; // 填充品牌名称\r\n\t\t\tresults.value = []; // 清空搜索结果\r\n\t\t\temit('select', brandId, brandName); // 向父组件传递选中ID\r\n\t\t}\r\n\t};\r\n\r\n\tfunction cancel() {\r\n\t\tsearchTerm.value = '';\r\n\t\tresults.value = [];\r\n\t}\r\n</script>\r\n\r\n<style lang=\"less\">\r\n\t.search_tab {\r\n\t\t// padding: 3px 10px;\r\n\t\tbox-sizing: border-box;\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tbackground: #fff;\r\n\t\tborder-radius: 10px;\r\n\t\t// padding: 5px 0px 7px 5px;\r\n\r\n\t\timage {\r\n\t\t\tposition: relative;\r\n\t\t\tmargin-left: 5px;\r\n\t\t\t// top: 3px;\r\n\t\t}\r\n\r\n\t\t.common_search_input {\r\n\t\t\tdisplay: inline-block;\r\n\t\t\t// margin-left: 15px;\r\n\t\t\tpadding: 10px 15px;\r\n\t\t\twidth: calc(100% - 85px);\r\n\t\t\t// text-align: center;\r\n\t\t\ttop: 2rpx;\r\n\t\t\tposition: relative;\n\t\t\tfont-size: 22rpx;\r\n\t\t}\r\n\t}\r\n\r\n\t.search_results {\r\n\t\tmargin-top: 10px;\r\n\t\tpadding: 10px;\r\n\t\tbackground-color: #f8f8f8;\r\n\t\tborder-radius: 5px;\r\n\t\tposition: absolute;\r\n\t\tz-index: 12;\r\n\t\tbox-shadow: 0 0 15px #0000002b;\r\n\t\tmax-height: 400rpx;\r\n\t\tfont-size: 22rpx;\r\n\r\n\t\t.result_item {\n\t\t\tfont-size: 22rpx;\r\n\t\t\tpadding: 15px 0;\r\n\t\t\tcursor: pointer;\r\n\t\t\tcolor: #333;\r\n\t\t\tborder-bottom: 1px solid #ececec;\r\n\r\n\t\t\t&:last-child {\r\n\t\t\t\tborder-bottom: none;\r\n\t\t\t}\r\n\r\n\t\t\t&:hover {\r\n\t\t\t\tcolor: #007aff;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n</style>","import Component from '/Users/sapphirell/Documents/git/dogdogdoll-uniapp/components/common-search/common-search.vue'\nwx.createComponent(Component)"],"names":["ref","uni","websiteUrl","Component"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA2BC,UAAM,QAAQ;AAuBd,UAAM,OAAO;AAEb,UAAM,aAAaA,kBAAI,EAAE;AACzB,UAAM,UAAUA,kBAAI,CAAA,CAAE;AAGtB,UAAM,gBAAgB,YAAY;AACjC,UAAI,WAAW,MAAM,KAAI,MAAO,IAAI;AACnC,gBAAQ,QAAQ;AAChB;AAAA,MACA;AAED,WAAK,UAAU,GAAG,WAAW,KAAK;AAGlC,UAAI;AACH,cAAM,MAAM,MAAMC,cAAG,MAAC,QAAQ;AAAA,UAC7B,KAAKC,cAAAA,aAAa,wBAAwB,WAAW,KAAK;AAAA,UAC1D,QAAQ;AAAA,UACR,QAAQ;AAAA,YACP,gBAAgB;AAAA,UAChB;AAAA,QACL,CAAI;AAEDD,sBAAY,MAAA,MAAA,OAAA,oDAAA,SAAS,IAAI,IAAI;AAC7B,YAAI,IAAI,KAAK,UAAU,WAAW;AAEjC,cAAI,IAAI,KAAK,QAAQ,MAAM;AAC1B,oBAAQ,QAAQ;AAChB;AAAA,UACA;AACD,kBAAQ,QAAQ,IAAI,KAAK;AACzB;AAAA,QACJ,OAAU;AACN,kBAAQ,QAAQ;AAChB;AAAA,QACA;AAAA,MAED,SAAQ,OAAO;AACfA,sBAAA,MAAA,MAAA,SAAA,oDAAc,SAAS,KAAK;AAC5B,gBAAQ,QAAQ;AAChB;AAAA,MACA;AAAA,IACH;AAEC,UAAM,QAAQ,CAAC,SAAS,cAAc;AACrC,UAAI,MAAM,SAAS,QAAQ;AAE1BA,sBAAAA,MAAI,WAAW;AAAA,UACd,KAAK,+BAA+B,OAAO;AAAA,QAC/C,CAAI;AAAA,MACJ,WAAa,MAAM,SAAS,QAAQ;AAEjC,mBAAW,QAAQ;AACnB,gBAAQ,QAAQ;AAChB,aAAK,UAAU,SAAS,SAAS;AAAA,MACjC;AAAA,IACH;AAEC,aAAS,SAAS;AACjB,iBAAW,QAAQ;AACnB,cAAQ,QAAQ;IAChB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC/GF,GAAG,gBAAgBE,SAAS;"}