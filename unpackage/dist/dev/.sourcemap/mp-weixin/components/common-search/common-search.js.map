{"version":3,"file":"common-search.js","sources":["components/common-search/common-search.vue","/Users/sapphirell/Documents/git/dogdogdoll-uniapp/components/common-search/common-search.vue?type=component"],"sourcesContent":["<!-- common-search -->\r\n<template>\r\n\t<view style=\"width:100%\">\n\t\t<view class=\"search_tab\" :class=\"$attrs.class\" :style=\"{\n\t\t\t\tbackground: background || '#fff'\n\t\t\t}\">\n\t\t\t<image class=\"icon_image\" src=\"../../static/search.png\" v-if=\"props.mode == 'jump'\"></image>\n\t\t\t<input class=\"common_search_input\" placeholder=\"可以模糊搜索娃社 o( ❛ᴗ❛ )o …\" v-model=\"searchTerm\"\n\t\t\t\t@input=\"onSearchInput\" :ignoreCompositionEvent=\"false\" />\n\t\t\t<view class=\"search-info-tap\" v-if=\"results.length > 0\">\n\t\t\t\t<text v-if=\"results.length > 0 && searchTerm.length < 5\">拼音、缩写、别名都可以搜</text>\n\t\t\t\t<image class=\"icon_image\" src=\"../../static/cancel.png\" @tap=\"cancel\" ></image>\n\t\t\t</view>\n\t\t\n\t\t</view>\n\t\t\n\t\t<view style=\"position: relative;\">\n\t\t\t<!-- 显示搜索结果 -->\n\t\t\t<scroll-view v-if=\"results.length > 0\" class=\"search_results\" :style=\"{width: width}\" scroll-y>\n\t\t\t\t<view v-for=\"item in results\" :key=\"item.id\" class=\"result_item\" @tap=\"onTap(item.id, item.name)\">\n\t\t\t\t\t{{ item.name }}\n\t\t\t\t</view>\n\t\t\t</scroll-view>\n\t\t</view>\n\t\t\n\t</view>\r\n\r\n</template>\r\n\r\n<script setup>\r\n\timport {\r\n\t\tref\r\n\t} from 'vue';\r\n\timport {\r\n\t\twebsiteUrl,\r\n\t} from \"../../common/config.js\";\r\n\r\n\t// 新增 props 接收父组件参数\r\n\tconst props = defineProps({\r\n\t\tmode: {\r\n\t\t\ttype: String,\r\n\t\t\tdefault: 'jump', // 默认跳转模式\r\n\t\t\tvalidator: (value) => ['jump', 'fill'].includes(value) // 参数校验\r\n\t\t},\r\n\t\twidth: {\r\n\t\t\ttype: String,\r\n\t\t\tdefault: '100%'\r\n\t\t},\r\n\t\tbackground: {\r\n\t\t\ttype: String,\r\n\t\t\tdefault: ''\r\n\t\t},\r\n\t\tfontSize: {\r\n\t\t\ttype: String,\r\n\t\t\tdefault: ''\r\n\t\t},\r\n\t});\r\n\tdefineOptions({\r\n\t\tinheritAttrs: false\r\n\t})\r\n\t// 新增事件定义\r\n\tconst emit = defineEmits(['select']);\r\n\r\n\tconst searchTerm = ref('');\r\n\tconst results = ref([]);\r\n\r\n\r\n\tconst onSearchInput = async () => {\r\n\t\tif (searchTerm.value.trim() === '') {\r\n\t\t\tresults.value = []; // 如果输入框为空，则清空结果\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\temit('select', 0, searchTerm.value); // 清空向父组件传递的id\r\n\r\n\t\t// 发起请求进行搜索\r\n\t\ttry {\r\n\t\t\tconst res = await uni.request({\r\n\t\t\t\turl: websiteUrl + `/search-brand?search=${searchTerm.value}`,\r\n\t\t\t\tmethod: 'GET',\r\n\t\t\t\theader: {\r\n\t\t\t\t\t'Content-Type': 'application/json'\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\tconsole.log('请求结果:', res.data);\r\n\t\t\tif (res.data.status == \"success\") {\r\n\t\t\t\t//判断res.data.data 是不是null\r\n\t\t\t\tif (res.data.data == null) {\r\n\t\t\t\t\tresults.value = [];\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tresults.value = res.data.data;\r\n\t\t\t\treturn\r\n\t\t\t} else {\r\n\t\t\t\tresults.value = [];\r\n\t\t\t\treturn\r\n\t\t\t}\r\n\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error('请求错误:', error);\r\n\t\t\tresults.value = []; // 请求失败时清空结果\r\n\t\t\treturn\r\n\t\t}\r\n\t};\r\n\r\n\tconst onTap = (brandId, brandName) => {\r\n\t\tif (props.mode === 'jump') {\r\n\t\t\t// 跳转模式\r\n\t\t\tuni.navigateTo({\r\n\t\t\t\turl: `/pages/brand/brand?brand_id=${brandId}`\r\n\t\t\t});\r\n\t\t} else if (props.mode === 'fill') {\r\n\t\t\t// 填充模式\r\n\t\t\tsearchTerm.value = brandName; // 填充品牌名称\r\n\t\t\tresults.value = []; // 清空搜索结果\r\n\t\t\temit('select', brandId, brandName); // 向父组件传递选中ID\r\n\t\t}\r\n\t};\r\n\r\n\tfunction cancel() {\r\n\t\tsearchTerm.value = '';\r\n\t\tresults.value = [];\r\n\t}\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n\t.search_tab {\r\n\t\tbox-sizing: border-box;\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tbackground: #fff;\r\n\t\tborder-radius: 10px;\r\n\t\twidth: 100%;\n\t\tposition: relative;\r\n\r\n\t\timage {\r\n\t\t\tposition: relative;\r\n\t\t\tmargin-left: 5px;\r\n\t\t}\r\n\r\n\t\t.common_search_input {\r\n\t\t\tdisplay: inline-block;\r\n\t\t\t// margin-left: 15px;\r\n\t\t\tpadding: 10px 15px;\r\n\t\t\twidth: calc(100% - 85px);\r\n\t\t\t// text-align: center;\r\n\t\t\ttop: 2rpx;\r\n\t\t\tposition: relative;\r\n\t\t\tfont-size: 22rpx;\r\n\t\t}\r\n\t}\r\n\r\n\t.search_results {\r\n\t\tpadding: 10px;\r\n\t\tbackground-color: #f8f8f8;\r\n\t\tborder-radius: 5px;\r\n\t\tposition: absolute;\r\n\t\ttop: 0px;\r\n\t\tz-index: 12;\r\n\t\tbox-shadow: 0 0 15px #0000002b;\r\n\t\tmax-height: 400rpx;\r\n\t\tfont-size: 22rpx;\r\n\r\n\t\t.result_item {\r\n\t\t\tfont-size: 22rpx;\r\n\t\t\tpadding: 15px 0;\r\n\t\t\tcursor: pointer;\r\n\t\t\tcolor: #333;\r\n\t\t\tborder-bottom: 1px solid #ececec;\r\n\r\n\t\t\t&:last-child {\r\n\t\t\t\tborder-bottom: none;\r\n\t\t\t}\r\n\r\n\t\t\t&:hover {\r\n\t\t\t\tcolor: #007aff;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t.search-info-tap {\n\t\tposition: absolute;\n\t\tright: 10rpx;\n\t\tvertical-align: middle;\n\t\tbottom: 0px;\n\t\ttext {\n\t\t\tcolor: #fff;\n\t\t\tbackground: linear-gradient(135deg, #a494b2, #fad0c4);\n\t\t\tfont-size: 20rpx;\n\t\t\twidth: 260px;\n\t\t\tpadding: 3px 5px;\n\t\t\tborder-radius: 3px;\n\t\t\tfont-weight: 900;\n\t\t\tposition: relative;\n\t\t\tbottom: 15rpx;\n\t\t}\r\n\t\r\n\t}\r\n</style>","import Component from '/Users/sapphirell/Documents/git/dogdogdoll-uniapp/components/common-search/common-search.vue'\nwx.createComponent(Component)"],"names":["ref","uni","websiteUrl"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAsCC,UAAM,QAAQ;AAuBd,UAAM,OAAO;AAEb,UAAM,aAAaA,kBAAI,EAAE;AACzB,UAAM,UAAUA,kBAAI,CAAA,CAAE;AAGtB,UAAM,gBAAgB,YAAY;AACjC,UAAI,WAAW,MAAM,KAAI,MAAO,IAAI;AACnC,gBAAQ,QAAQ;AAChB;AAAA,MACA;AAED,WAAK,UAAU,GAAG,WAAW,KAAK;AAGlC,UAAI;AACH,cAAM,MAAM,MAAMC,cAAG,MAAC,QAAQ;AAAA,UAC7B,KAAKC,cAAAA,aAAa,wBAAwB,WAAW,KAAK;AAAA,UAC1D,QAAQ;AAAA,UACR,QAAQ;AAAA,YACP,gBAAgB;AAAA,UAChB;AAAA,QACL,CAAI;AAEDD,sBAAY,MAAA,MAAA,OAAA,oDAAA,SAAS,IAAI,IAAI;AAC7B,YAAI,IAAI,KAAK,UAAU,WAAW;AAEjC,cAAI,IAAI,KAAK,QAAQ,MAAM;AAC1B,oBAAQ,QAAQ;AAChB;AAAA,UACA;AACD,kBAAQ,QAAQ,IAAI,KAAK;AACzB;AAAA,QACJ,OAAU;AACN,kBAAQ,QAAQ;AAChB;AAAA,QACA;AAAA,MAED,SAAQ,OAAO;AACfA,sBAAA,MAAA,MAAA,SAAA,qDAAc,SAAS,KAAK;AAC5B,gBAAQ,QAAQ;AAChB;AAAA,MACA;AAAA,IACH;AAEC,UAAM,QAAQ,CAAC,SAAS,cAAc;AACrC,UAAI,MAAM,SAAS,QAAQ;AAE1BA,sBAAAA,MAAI,WAAW;AAAA,UACd,KAAK,+BAA+B,OAAO;AAAA,QAC/C,CAAI;AAAA,MACJ,WAAa,MAAM,SAAS,QAAQ;AAEjC,mBAAW,QAAQ;AACnB,gBAAQ,QAAQ;AAChB,aAAK,UAAU,SAAS,SAAS;AAAA,MACjC;AAAA,IACH;AAEC,aAAS,SAAS;AACjB,iBAAW,QAAQ;AACnB,cAAQ,QAAQ;IAChB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC1HF,GAAG,gBAAgB,SAAS;"}