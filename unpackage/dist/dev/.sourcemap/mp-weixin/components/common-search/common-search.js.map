{"version":3,"file":"common-search.js","sources":["components/common-search/common-search.vue","/Users/sapphirell/Documents/git/dogdogdoll-uniapp/components/common-search/common-search.vue?type=component"],"sourcesContent":["<!-- common-search -->\r\n<template>\r\n\t<view style=\"width:100%\">\n\t\t<view class=\"search_tab\" :class=\"$attrs.class\" :style=\"{\n\t\t\t\tbackground: background || '#fff'\n\t\t\t}\">\n\t\t\t<image class=\"icon_image\" src=\"../../static/search.png\" v-if=\"props.mode == 'jump'\"></image>\n\t\t\t<input class=\"common_search_input\" placeholder=\"可以模糊搜索娃社 o( ❛ᴗ❛ )o …\" v-model=\"searchTerm\"\n\t\t\t\t@input=\"onSearchInput\" :ignoreCompositionEvent=\"false\" />\n\t\t\t<view class=\"search-info-tap\" v-if=\"results.length > 0\">\n\t\t\t\t<text v-if=\"results.length > 0 && searchTerm.length < 5\">拼音、缩写、别名都可以搜</text>\n\t\t\t\t<image class=\"icon_image\" src=\"../../static/cancel.png\" @tap=\"cancel\" ></image>\n\t\t\t</view>\n\t\t\n\t\t</view>\n\t\t\n\t\t<view style=\"position: relative;\">\n\t\t\t<!-- 显示搜索结果 -->\n\t\t\t<scroll-view v-if=\"results.length > 0\" class=\"search_results\" style=\"height: 600rpx;\" :style=\"{width: width}\" scroll-y >\n\t\t\t\t<view v-for=\"item in results\" :key=\"item.id\" class=\"result_item\" @tap=\"onTap(item.id, item.name)\">\n\t\t\t\t\t{{ item.name }}\n\t\t\t\t</view>\n\t\t\t</scroll-view>\n\t\t</view>\n\t\t\n\t</view>\r\n\r\n</template>\r\n\r\n<script setup>\r\n\timport {\r\n\t\tref\r\n\t} from 'vue';\r\n\timport {\r\n\t\twebsiteUrl,\r\n\t} from \"../../common/config.js\";\r\n\r\n\t// 新增 props 接收父组件参数\r\n\tconst props = defineProps({\r\n\t\tmode: {\r\n\t\t\ttype: String,\r\n\t\t\tdefault: 'jump', // 默认跳转模式\r\n\t\t\tvalidator: (value) => ['jump', 'fill'].includes(value) // 参数校验\r\n\t\t},\r\n\t\twidth: {\r\n\t\t\ttype: String,\r\n\t\t\tdefault: '100%'\r\n\t\t},\r\n\t\tbackground: {\r\n\t\t\ttype: String,\r\n\t\t\tdefault: ''\r\n\t\t},\r\n\t\tfontSize: {\r\n\t\t\ttype: String,\r\n\t\t\tdefault: ''\r\n\t\t},\r\n\t});\r\n\tdefineOptions({\r\n\t\tinheritAttrs: false\r\n\t})\r\n\t// 新增事件定义\r\n\tconst emit = defineEmits(['select']);\r\n\r\n\tconst searchTerm = ref('');\r\n\tconst results = ref([]);\r\n\r\n\r\n\tconst onSearchInput = async () => {\r\n\t\tif (searchTerm.value.trim() === '') {\r\n\t\t\tresults.value = []; // 如果输入框为空，则清空结果\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\temit('select', 0, searchTerm.value); // 清空向父组件传递的id\r\n\r\n\t\t// 发起请求进行搜索\r\n\t\ttry {\r\n\t\t\tconst res = await uni.request({\r\n\t\t\t\turl: websiteUrl + `/search-brand?search=${searchTerm.value}`,\r\n\t\t\t\tmethod: 'GET',\r\n\t\t\t\theader: {\r\n\t\t\t\t\t'Content-Type': 'application/json'\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\tconsole.log('请求结果:', res.data);\r\n\t\t\tif (res.data.status == \"success\") {\r\n\t\t\t\t//判断res.data.data 是不是null\r\n\t\t\t\tif (res.data.data == null) {\r\n\t\t\t\t\tresults.value = [];\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tresults.value = res.data.data;\r\n\t\t\t\treturn\r\n\t\t\t} else {\r\n\t\t\t\tresults.value = [];\r\n\t\t\t\treturn\r\n\t\t\t}\r\n\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error('请求错误:', error);\r\n\t\t\tresults.value = []; // 请求失败时清空结果\r\n\t\t\treturn\r\n\t\t}\r\n\t};\r\n\r\n\tconst onTap = (brandId, brandName) => {\r\n\t\tif (props.mode === 'jump') {\r\n\t\t\t// 跳转模式\r\n\t\t\tuni.navigateTo({\r\n\t\t\t\turl: `/pages/brand/brand?brand_id=${brandId}`\r\n\t\t\t});\r\n\t\t} else if (props.mode === 'fill') {\r\n\t\t\t// 填充模式\r\n\t\t\tsearchTerm.value = brandName; // 填充品牌名称\r\n\t\t\tresults.value = []; // 清空搜索结果\r\n\t\t\temit('select', brandId, brandName); // 向父组件传递选中ID\r\n\t\t}\r\n\t};\r\n\r\n\tfunction cancel() {\r\n\t\tsearchTerm.value = '';\r\n\t\tresults.value = [];\r\n\t}\r\n</script>\r\n\r\n<!-- common-search -->\n<style lang=\"less\" scoped>\n.search_tab {\n  box-sizing: border-box;\n  display: flex;\n  align-items: center;\n  background: #fff;\n  border-radius: 10px;\n  width: 100%;\n  position: relative;\n  height: 72rpx; /* 统一高度 */\n  padding: 0 20rpx; /* 统一内边距 */\n\n  .icon_image {\n    width: 36rpx; /* 统一图标大小 */\n    height: 36rpx; /* 统一图标大小 */\n    margin-right: 16rpx; /* 统一图标间距 */\n  }\n\n  .common_search_input {\n    flex: 1;\n    height: 100%;\n    padding: 0; /* 统一内边距 */\n    font-size: 23rpx; /* 统一字体大小 */\n  }\n}\n\n.search_results {\n  padding: 10px;\n  background-color: #f8f8f8;\n  border-radius: 5px;\n  position: absolute;\n  z-index: 120;\n  box-shadow: 0 0 15px #0000002b;\n  max-height: 400rpx;\n  font-size: 22rpx;\n\n  .result_item {\n    font-size: 22rpx;\n    padding: 15px 0;\n    cursor: pointer;\n    color: #333;\n    border-bottom: 1px solid #ececec;\n\n    &:last-child {\n      border-bottom: none;\n    }\n\n    &:hover {\n      color: #007aff;\n    }\n  }\n}\n\n.search-info-tap {\n  display: flex;\n  align-items: center;\n  position: relative; /* 改为相对定位 */\n  margin-left: 10rpx; /* 添加左边距 */\n  \n  text {\n    color: #fff;\n    background: linear-gradient(135deg, #a494b2, #fad0c4);\n    font-size: 20rpx;\n    padding: 3px 5px;\n    border-radius: 3px;\n    font-weight: 900;\n    position: relative;\n    bottom: 0; /* 取消垂直偏移 */\n    margin-right: 8rpx; /* 添加右边距 */\n  }\n  \n  .icon_image {\n    width: 36rpx;\n    height: 36rpx;\n    margin-left: 0; /* 重置左边距 */\n  }\n}\n</style>\n","import Component from '/Users/sapphirell/Documents/git/dogdogdoll-uniapp/components/common-search/common-search.vue'\nwx.createComponent(Component)"],"names":["ref","uni","websiteUrl"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAsCC,UAAM,QAAQ;AAuBd,UAAM,OAAO;AAEb,UAAM,aAAaA,kBAAI,EAAE;AACzB,UAAM,UAAUA,kBAAI,CAAA,CAAE;AAGtB,UAAM,gBAAgB,YAAY;AACjC,UAAI,WAAW,MAAM,KAAI,MAAO,IAAI;AACnC,gBAAQ,QAAQ;AAChB;AAAA,MACA;AAED,WAAK,UAAU,GAAG,WAAW,KAAK;AAGlC,UAAI;AACH,cAAM,MAAM,MAAMC,cAAG,MAAC,QAAQ;AAAA,UAC7B,KAAKC,cAAAA,aAAa,wBAAwB,WAAW,KAAK;AAAA,UAC1D,QAAQ;AAAA,UACR,QAAQ;AAAA,YACP,gBAAgB;AAAA,UAChB;AAAA,QACL,CAAI;AAEDD,sBAAY,MAAA,MAAA,OAAA,oDAAA,SAAS,IAAI,IAAI;AAC7B,YAAI,IAAI,KAAK,UAAU,WAAW;AAEjC,cAAI,IAAI,KAAK,QAAQ,MAAM;AAC1B,oBAAQ,QAAQ;AAChB;AAAA,UACA;AACD,kBAAQ,QAAQ,IAAI,KAAK;AACzB;AAAA,QACJ,OAAU;AACN,kBAAQ,QAAQ;AAChB;AAAA,QACA;AAAA,MAED,SAAQ,OAAO;AACfA,sBAAA,MAAA,MAAA,SAAA,qDAAc,SAAS,KAAK;AAC5B,gBAAQ,QAAQ;AAChB;AAAA,MACA;AAAA,IACH;AAEC,UAAM,QAAQ,CAAC,SAAS,cAAc;AACrC,UAAI,MAAM,SAAS,QAAQ;AAE1BA,sBAAAA,MAAI,WAAW;AAAA,UACd,KAAK,+BAA+B,OAAO;AAAA,QAC/C,CAAI;AAAA,MACJ,WAAa,MAAM,SAAS,QAAQ;AAEjC,mBAAW,QAAQ;AACnB,gBAAQ,QAAQ;AAChB,aAAK,UAAU,SAAS,SAAS;AAAA,MACjC;AAAA,IACH;AAEC,aAAS,SAAS;AACjB,iBAAW,QAAQ;AACnB,cAAQ,QAAQ;IAChB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC1HF,GAAG,gBAAgB,SAAS;"}